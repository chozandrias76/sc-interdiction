---
phase: 02.1-game-data-extraction
plan: 01
subsystem: data-extraction
tags: [scdatatools, scunpacked, json, localization, game-data]

# Dependency graph
requires:
  - phase: 02-item-source-research
    provides: understanding of what data we need from game files
provides:
  - Python extraction script for game data
  - Extracted item/label JSON files from scunpacked-data
  - Documentation for extraction setup
affects: [02.1-02, 02.1-03, 03-wikelo-data-module]

# Tech tracking
tech-stack:
  added: [scunpacked-data (git submodule alternative)]
  patterns: [community-maintained game data over direct p4k extraction]

key-files:
  created: [scripts/extract_gamedata.py, scripts/README.md]
  modified: [.gitignore]

key-decisions:
  - "Use scunpacked-data repo instead of direct p4k extraction (scdatatools broken)"
  - "JSON files preferred over single monolithic Game2.json"

patterns-established:
  - "Game data via scunpacked-data git clone, not p4k extraction"

issues-created: []

# Metrics
duration: 21min
completed: 2026-01-16
---

# Phase 2.1 Plan 01: scdatatools Setup Summary

**Extraction foundation using scunpacked-data after scdatatools p4k parsing proved broken**

## Performance

- **Duration:** 21 min
- **Started:** 2026-01-16T17:15:43Z
- **Completed:** 2026-01-16T17:36:37Z
- **Tasks:** 3
- **Files modified:** 3

## Accomplishments

- Created Python extraction script with scunpacked-data fallback
- Extracted 7.4GB of game data (items, labels, ships, manufacturers)
- Documented extraction setup in scripts/README.md
- Added extracted/ to .gitignore to prevent committing large files

## Task Commits

Each task was committed atomically:

1. **Task 1: Install scdatatools and create extraction script** - `a0c9a1d` (feat)
2. **Task 2: Run extraction and verify output files** - `69df3a7` (feat)
3. **Task 3: Add extraction to .gitignore and document setup** - `494d114` (feat)

**Plan metadata:** (this commit)

## Files Created/Modified

- `scripts/extract_gamedata.py` - Python extraction script (339 lines)
- `scripts/README.md` - Setup documentation
- `.gitignore` - Added extracted/, *.dcb, *.p4k, .venv/, tools/

## Extracted Data (in .gitignore)

| File | Size | Content |
|------|------|---------|
| items.json | 46MB | All game items |
| labels.json | 9.9MB | 84,716 localization entries |
| fps-items.json | 19MB | FPS/player equipment |
| ship-items.json | 11MB | Ship components |
| ships.json | 1.4MB | Ship definitions |
| manufacturers.json | 113KB | Manufacturer data |

## Decisions Made

1. **scunpacked-data over direct p4k extraction**: scdatatools v1.0.4 cannot parse current game's p4k format (BadZipFile error). The community-maintained scunpacked-data repo provides validated JSON that updates with game patches.

2. **Multiple JSON files over monolithic Game2.json**: The extracted structure provides smaller, focused files (items.json, labels.json) which are easier to work with than a single 1-2GB JSON.

## Deviations from Plan

### Auto-fixed Issues

**1. [Rule 3 - Blocking] scdatatools p4k extraction broken**
- **Found during:** Task 1 (extraction script creation)
- **Issue:** scdatatools 1.0.4 throws BadZipFile on current p4k format
- **Fix:** Implemented fallback to scunpacked-data repository clone
- **Files modified:** scripts/extract_gamedata.py
- **Verification:** Extraction completes successfully with valid JSON
- **Committed in:** a0c9a1d

**2. [Rule 3 - Blocking] global.ini vs labels.json format difference**
- **Found during:** Task 2 (extraction verification)
- **Issue:** Plan expected global.ini but scunpacked provides labels.json
- **Fix:** Updated verification to use labels.json (same data, better format)
- **Verification:** 84,716 localization entries available
- **Committed in:** 69df3a7

---

**Total deviations:** 2 auto-fixed (blocking issues)
**Impact on plan:** Significant approach change but better outcome - community-maintained data is more reliable than fragile p4k parsing

## Issues Encountered

- scdatatools PyPI version incompatible with current game format
- GitLab dev branches have broken CLI imports
- 7z cannot handle ZSTD compression in p4k files
- All resolved by scunpacked-data fallback

## Next Phase Readiness

- Extracted JSON ready for exploration
- Ready for 02.1-02-PLAN.md: Build DataForge exploration CLI
- Note: May need to adjust 02.1-02 approach since we have pre-structured JSON rather than raw DataForge

---
*Phase: 02.1-game-data-extraction*
*Completed: 2026-01-16*
