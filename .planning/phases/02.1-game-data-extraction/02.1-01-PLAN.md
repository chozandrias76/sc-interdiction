---
phase: 02.1-game-data-extraction
plan: 01
type: execute
---

<objective>
Set up scdatatools and extract DataForge (Game2.dcb) and localization (global.ini) from Data.p4k.

Purpose: Establish the extraction foundation that all subsequent plans depend on. Get raw game data files accessible for exploration and pipeline development.
Output: Python wrapper script for extraction, extracted JSON from DataForge, extracted localization strings.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
./summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/02.1-game-data-extraction/02.1-RESEARCH.md

**Prior phase context:**
@.planning/phases/02-item-source-research/02-01-SUMMARY.md

**Key files:**
@crates/sc-data-extractor/src/lib.rs

**Game data location:**
`/mnt/c/Star Citizen/StarCitizen/LIVE/Data.p4k` (150GB archive)

**Tool installation:**
- scdatatools: `pip install scdatatools` (Python 3.8+)
- Verify: `scdt --help` should show available commands
</context>

<tasks>

<task type="auto">
  <name>Task 1: Install scdatatools and verify CLI/API capabilities</name>
  <files>scripts/extract_gamedata.py</files>
  <action>
1. Install scdatatools: `pip install scdatatools` (or pipx for isolation)
2. Test CLI capabilities:
   ```bash
   scdt --help
   scdt unp4k --help  # Check if extraction subcommand exists
   scdt unforge --help  # Check if DCB conversion exists
   ```

3. If CLI works, create a shell wrapper script. If CLI is incomplete, create Python script using the API directly:

**Python API approach (preferred for reliability):**
```python
from scdatatools.sc import StarCitizen
sc = StarCitizen('/path/to/LIVE')
# Use sc.p4k to extract files
# Use sc.datacore to access DataForge
```

The script should:
- Accept p4k path as argument (default: `/mnt/c/Star Citizen/StarCitizen/LIVE/Data.p4k`)
- Accept output directory as argument (default: `./extracted/`)
- Create output directory if not exists
- Extract `Data/Game2.dcb` and convert to JSON
- Extract `Data/Localization/english/global.ini`
- Report progress to stderr
- Handle errors gracefully with clear messages
  </action>
  <verify>
```bash
# Verify scdatatools installed
scdt --help
# Verify script exists and shows help
python scripts/extract_gamedata.py --help 2>/dev/null || bash scripts/extract_gamedata.sh --help
```
  </verify>
  <done>scdatatools installed, extraction script created, shows help output, no syntax errors</done>
</task>

<task type="auto">
  <name>Task 2: Run extraction and verify output files</name>
  <files>extracted/Game2.json, extracted/global.ini</files>
  <action>
Run the extraction script against the actual Data.p4k:

```bash
python scripts/extract_gamedata.py \
  --p4k "/mnt/c/Star Citizen/StarCitizen/LIVE/Data.p4k" \
  --output ./extracted/
```

This will take several minutes due to the 150GB archive size. The DataForge JSON will be large (1-2GB).

After extraction:
1. Verify Game2.json exists and is valid JSON (check first 1000 chars)
2. Verify global.ini exists and contains localization keys
3. Record file sizes for reference

Note: If extraction fails with import errors, install missing deps: `pip install scdatatools[all]`
If p4k path doesn't exist, update path to match user's SC installation.
  </action>
  <verify>
```bash
# Check files exist and have content
ls -lh extracted/Game2.json extracted/global.ini
# Verify JSON is valid (should not error)
head -c 1000 extracted/Game2.json | python -m json.tool > /dev/null && echo "Valid JSON"
# Check localization has content
wc -l extracted/global.ini
```
  </verify>
  <done>Game2.json exists (>100MB), global.ini exists (>50000 lines), JSON validates successfully</done>
</task>

<task type="auto">
  <name>Task 3: Add extraction to .gitignore and document setup</name>
  <files>.gitignore, README.md or scripts/README.md</files>
  <action>
1. Add to .gitignore:
   - `extracted/` directory (large generated files)
   - Any `.dcb` files
   - Any cache directories for later phases

2. Create scripts/README.md documenting:
   - Prerequisites (Python 3.8+, scdatatools)
   - Installation: `pip install scdatatools`
   - Usage: `python scripts/extract_gamedata.py --help`
   - Expected output files and sizes
   - Troubleshooting common errors

This ensures future developers understand the extraction setup without reading planning docs.
  </action>
  <verify>
```bash
# Verify gitignore
grep -q "extracted/" .gitignore && echo "extracted/ in gitignore"
# Verify docs exist
test -f scripts/README.md && echo "scripts/README.md exists"
```
  </verify>
  <done>.gitignore excludes extracted/, scripts/README.md documents setup and usage</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] scripts/extract_gamedata.py exists and runs without syntax errors
- [ ] extracted/Game2.json exists and is valid JSON
- [ ] extracted/global.ini exists with localization strings
- [ ] .gitignore excludes extracted/
- [ ] scripts/README.md documents the extraction process
</verification>

<success_criteria>
- Python extraction script working with scdatatools API
- DataForge JSON extracted and validated
- Localization strings extracted
- Setup documented for future developers
- No large generated files committed to git
</success_criteria>

<output>
After completion, create `.planning/phases/02.1-game-data-extraction/02.1-01-SUMMARY.md`:

# Phase 2.1 Plan 01: scdatatools Setup Summary

**[Substantive one-liner about what was accomplished]**

## Accomplishments

- [Key outcomes]

## Files Created/Modified

- `scripts/extract_gamedata.py` - Python wrapper for scdatatools extraction
- `extracted/Game2.json` - DataForge database as JSON (~X GB)
- `extracted/global.ini` - Localization strings (~X lines)
- `scripts/README.md` - Setup documentation

## Decisions Made

[Any decisions about API usage, file formats, etc.]

## Issues Encountered

[Problems and resolutions, or "None"]

## Next Step

Ready for 02.1-02-PLAN.md: Build DataForge exploration CLI
</output>
