[0m00:10:42.234855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27de786dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27dc466110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27dc466080>]}


============================== 00:10:42.248271 | a182aa06-9c8e-436d-875b-107134facaf6 ==============================
[0m00:10:42.248271 [info ] [MainThread]: Running with dbt=1.7.0
[0m00:10:42.249089 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'profiles_dir': '/usr/app', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt seed', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:10:42.599905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a182aa06-9c8e-436d-875b-107134facaf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27dc4b0760>]}
[0m00:10:42.769703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a182aa06-9c8e-436d-875b-107134facaf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27dabf0d90>]}
[0m00:10:42.770641 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m00:10:42.780007 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m00:10:42.780785 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m00:10:42.781224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a182aa06-9c8e-436d-875b-107134facaf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27dac19570>]}
[0m00:10:44.347600 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two models with the name "shop_items".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when looking for ref("shop_items").
  
  To fix this, change the name of one of these resources:
  - model.sc_interdiction.shop_items (models/silver/shop_items.sql)
  - model.sc_interdiction.shop_items (models/gold/shop_items.sql)
[0m00:10:44.357543 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_wall_clock_time": 2.2008781, "process_user_time": 5.785849, "process_kernel_time": 0.379727, "process_mem_max_rss": "104864", "process_out_blocks": "624", "command_success": false, "process_in_blocks": "0"}
[0m00:10:44.358598 [debug] [MainThread]: Command `dbt seed` failed at 00:10:44.358349 after 2.21 seconds
[0m00:10:44.359316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27de786dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27da8483a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27da849330>]}
[0m00:10:44.359997 [debug] [MainThread]: Flushing usage events
[0m00:19:24.073207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e3e59ed70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e3c2b60b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e3c2b6050>]}


============================== 00:19:24.080551 | c0f60e50-ff84-4173-8876-7de19788aa14 ==============================
[0m00:19:24.080551 [info ] [MainThread]: Running with dbt=1.7.0
[0m00:19:24.081257 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt seed', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:19:24.430967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c0f60e50-ff84-4173-8876-7de19788aa14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e3c2f8700>]}
[0m00:19:24.620994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c0f60e50-ff84-4173-8876-7de19788aa14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e3a8477c0>]}
[0m00:19:24.622220 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m00:19:24.643911 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m00:19:24.645666 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m00:19:24.646827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c0f60e50-ff84-4173-8876-7de19788aa14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e3a94e5f0>]}
[0m00:19:27.462764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c0f60e50-ff84-4173-8876-7de19788aa14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e3824a680>]}
[0m00:19:27.492384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c0f60e50-ff84-4173-8876-7de19788aa14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e3a94f130>]}
[0m00:19:27.493250 [info ] [MainThread]: Found 12 models, 2 seeds, 16 tests, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m00:19:27.494397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c0f60e50-ff84-4173-8876-7de19788aa14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e38467100>]}
[0m00:19:27.498764 [info ] [MainThread]: 
[0m00:19:27.500049 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:19:27.501993 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sc_interdiction'
[0m00:19:27.527081 [debug] [ThreadPool]: Using postgres connection "list_sc_interdiction"
[0m00:19:27.527568 [debug] [ThreadPool]: On list_sc_interdiction: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "connection_name": "list_sc_interdiction"} */

    select distinct nspname from pg_namespace
  
[0m00:19:27.527831 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:19:27.572291 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m00:19:27.574202 [debug] [ThreadPool]: On list_sc_interdiction: Close
[0m00:19:27.575995 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sc_interdiction, now create_sc_interdiction_raw_silver)
[0m00:19:27.577968 [debug] [ThreadPool]: Creating schema "database: "sc_interdiction"
schema: "raw_silver"
"
[0m00:19:27.585893 [debug] [ThreadPool]: Using postgres connection "create_sc_interdiction_raw_silver"
[0m00:19:27.586632 [debug] [ThreadPool]: On create_sc_interdiction_raw_silver: BEGIN
[0m00:19:27.587019 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:19:27.603844 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:19:27.604487 [debug] [ThreadPool]: Using postgres connection "create_sc_interdiction_raw_silver"
[0m00:19:27.604924 [debug] [ThreadPool]: On create_sc_interdiction_raw_silver: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "connection_name": "create_sc_interdiction_raw_silver"} */
create schema if not exists "raw_silver"
[0m00:19:27.622869 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m00:19:27.624181 [debug] [ThreadPool]: On create_sc_interdiction_raw_silver: COMMIT
[0m00:19:27.624710 [debug] [ThreadPool]: Using postgres connection "create_sc_interdiction_raw_silver"
[0m00:19:27.625064 [debug] [ThreadPool]: On create_sc_interdiction_raw_silver: COMMIT
[0m00:19:27.628639 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m00:19:27.629277 [debug] [ThreadPool]: On create_sc_interdiction_raw_silver: Close
[0m00:19:27.632433 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_sc_interdiction_raw_silver, now list_sc_interdiction_raw_gold)
[0m00:19:27.633455 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sc_interdiction_raw_staging'
[0m00:19:27.640152 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sc_interdiction_raw_silver'
[0m00:19:27.650902 [debug] [ThreadPool]: Using postgres connection "list_sc_interdiction_raw_gold"
[0m00:19:27.652769 [debug] [ThreadPool]: Using postgres connection "list_sc_interdiction_raw_staging"
[0m00:19:27.656168 [debug] [ThreadPool]: Using postgres connection "list_sc_interdiction_raw_silver"
[0m00:19:27.656826 [debug] [ThreadPool]: On list_sc_interdiction_raw_gold: BEGIN
[0m00:19:27.657254 [debug] [ThreadPool]: On list_sc_interdiction_raw_staging: BEGIN
[0m00:19:27.657682 [debug] [ThreadPool]: On list_sc_interdiction_raw_silver: BEGIN
[0m00:19:27.658179 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:19:27.658674 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:19:27.659093 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:19:27.665915 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:19:27.666473 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:19:27.667119 [debug] [ThreadPool]: Using postgres connection "list_sc_interdiction_raw_silver"
[0m00:19:27.667566 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:19:27.668073 [debug] [ThreadPool]: Using postgres connection "list_sc_interdiction_raw_gold"
[0m00:19:27.668572 [debug] [ThreadPool]: On list_sc_interdiction_raw_silver: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "connection_name": "list_sc_interdiction_raw_silver"} */
select
      'sc_interdiction' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw_silver'
    union all
    select
      'sc_interdiction' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw_silver'
    union all
    select
      'sc_interdiction' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw_silver'
  
[0m00:19:27.669099 [debug] [ThreadPool]: Using postgres connection "list_sc_interdiction_raw_staging"
[0m00:19:27.669550 [debug] [ThreadPool]: On list_sc_interdiction_raw_gold: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "connection_name": "list_sc_interdiction_raw_gold"} */
select
      'sc_interdiction' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw_gold'
    union all
    select
      'sc_interdiction' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw_gold'
    union all
    select
      'sc_interdiction' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw_gold'
  
[0m00:19:27.670186 [debug] [ThreadPool]: On list_sc_interdiction_raw_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "connection_name": "list_sc_interdiction_raw_staging"} */
select
      'sc_interdiction' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw_staging'
    union all
    select
      'sc_interdiction' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw_staging'
    union all
    select
      'sc_interdiction' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw_staging'
  
[0m00:19:27.718272 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m00:19:27.719023 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m00:19:27.719573 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m00:19:27.721141 [debug] [ThreadPool]: On list_sc_interdiction_raw_staging: ROLLBACK
[0m00:19:27.722834 [debug] [ThreadPool]: On list_sc_interdiction_raw_gold: ROLLBACK
[0m00:19:27.724382 [debug] [ThreadPool]: On list_sc_interdiction_raw_silver: ROLLBACK
[0m00:19:27.725329 [debug] [ThreadPool]: On list_sc_interdiction_raw_silver: Close
[0m00:19:27.725832 [debug] [ThreadPool]: On list_sc_interdiction_raw_staging: Close
[0m00:19:27.726183 [debug] [ThreadPool]: On list_sc_interdiction_raw_gold: Close
[0m00:19:27.736009 [debug] [MainThread]: Using postgres connection "master"
[0m00:19:27.736653 [debug] [MainThread]: On master: BEGIN
[0m00:19:27.737027 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:19:27.750245 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:19:27.750799 [debug] [MainThread]: Using postgres connection "master"
[0m00:19:27.751173 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:19:27.800959 [debug] [MainThread]: SQL status: SELECT 8 in 0.0 seconds
[0m00:19:27.803016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c0f60e50-ff84-4173-8876-7de19788aa14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e382ad5a0>]}
[0m00:19:27.803903 [debug] [MainThread]: On master: ROLLBACK
[0m00:19:27.804755 [debug] [MainThread]: Using postgres connection "master"
[0m00:19:27.805147 [debug] [MainThread]: On master: BEGIN
[0m00:19:27.806051 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:19:27.806446 [debug] [MainThread]: On master: COMMIT
[0m00:19:27.806905 [debug] [MainThread]: Using postgres connection "master"
[0m00:19:27.807331 [debug] [MainThread]: On master: COMMIT
[0m00:19:27.808170 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:19:27.808634 [debug] [MainThread]: On master: Close
[0m00:19:27.809611 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:19:27.816261 [info ] [MainThread]: 
[0m00:19:27.834074 [debug] [Thread-1 (]: Began running node seed.sc_interdiction.display_names
[0m00:19:27.834763 [debug] [Thread-2 (]: Began running node seed.sc_interdiction.lagrange_planets
[0m00:19:27.835544 [info ] [Thread-1 (]: 1 of 2 START seed file raw_silver.display_names ................................ [RUN]
[0m00:19:27.836329 [info ] [Thread-2 (]: 2 of 2 START seed file raw_silver.lagrange_planets ............................. [RUN]
[0m00:19:27.837255 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sc_interdiction_raw_gold, now seed.sc_interdiction.display_names)
[0m00:19:27.838043 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_sc_interdiction_raw_staging, now seed.sc_interdiction.lagrange_planets)
[0m00:19:27.838555 [debug] [Thread-1 (]: Began compiling node seed.sc_interdiction.display_names
[0m00:19:27.839057 [debug] [Thread-2 (]: Began compiling node seed.sc_interdiction.lagrange_planets
[0m00:19:27.839826 [debug] [Thread-1 (]: Timing info for seed.sc_interdiction.display_names (compile): 00:19:27.839418 => 00:19:27.839456
[0m00:19:27.840519 [debug] [Thread-2 (]: Timing info for seed.sc_interdiction.lagrange_planets (compile): 00:19:27.840227 => 00:19:27.840231
[0m00:19:27.841098 [debug] [Thread-1 (]: Began executing node seed.sc_interdiction.display_names
[0m00:19:27.841578 [debug] [Thread-2 (]: Began executing node seed.sc_interdiction.lagrange_planets
[0m00:19:27.982978 [debug] [Thread-1 (]: Using postgres connection "seed.sc_interdiction.display_names"
[0m00:19:27.988300 [debug] [Thread-2 (]: Using postgres connection "seed.sc_interdiction.lagrange_planets"
[0m00:19:27.989288 [debug] [Thread-1 (]: On seed.sc_interdiction.display_names: BEGIN
[0m00:19:27.995442 [debug] [Thread-2 (]: On seed.sc_interdiction.lagrange_planets: BEGIN
[0m00:19:27.996398 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:19:27.996971 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:19:28.006063 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m00:19:28.012513 [debug] [Thread-2 (]: Using postgres connection "seed.sc_interdiction.lagrange_planets"
[0m00:19:28.013390 [debug] [Thread-2 (]: On seed.sc_interdiction.lagrange_planets: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "node_id": "seed.sc_interdiction.lagrange_planets"} */

    create table "sc_interdiction"."raw_silver"."lagrange_planets" ("loc_name" text,"planet_loc_name" text,"system_name" text)
  
[0m00:19:28.013980 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:19:28.014657 [debug] [Thread-1 (]: Using postgres connection "seed.sc_interdiction.display_names"
[0m00:19:28.015105 [debug] [Thread-1 (]: On seed.sc_interdiction.display_names: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "node_id": "seed.sc_interdiction.display_names"} */

    create table "sc_interdiction"."raw_silver"."display_names" ("loc_name" text,"display_name" text)
  
[0m00:19:28.089940 [debug] [Thread-2 (]: SQL status: CREATE TABLE in 0.0 seconds
[0m00:19:28.104943 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.0 seconds
[0m00:19:28.247986 [debug] [Thread-1 (]: Using postgres connection "seed.sc_interdiction.display_names"
[0m00:19:28.269916 [debug] [Thread-1 (]: On seed.sc_interdiction.display_names: 
          insert into "sc_interdiction"."raw_silver"."display_names" ("loc_name", "display_name") values
          (%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,...
[0m00:19:28.274794 [debug] [Thread-2 (]: Using postgres connection "seed.sc_interdiction.lagrange_planets"
[0m00:19:28.275828 [debug] [Thread-2 (]: On seed.sc_interdiction.lagrange_planets: 
          insert into "sc_interdiction"."raw_silver"."lagrange_planets" ("loc_name", "planet_loc_name", "system_name") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(...
[0m00:19:28.281235 [debug] [Thread-2 (]: SQL status: INSERT 0 77 in 0.0 seconds
[0m00:19:28.288112 [debug] [Thread-1 (]: SQL status: INSERT 0 85 in 0.0 seconds
[0m00:19:28.302302 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.sc_interdiction.display_names"
[0m00:19:28.299434 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.sc_interdiction.lagrange_planets"
[0m00:19:28.358725 [debug] [Thread-1 (]: On seed.sc_interdiction.display_names: COMMIT
[0m00:19:28.359863 [debug] [Thread-2 (]: On seed.sc_interdiction.lagrange_planets: COMMIT
[0m00:19:28.362202 [debug] [Thread-1 (]: Using postgres connection "seed.sc_interdiction.display_names"
[0m00:19:28.362893 [debug] [Thread-2 (]: Using postgres connection "seed.sc_interdiction.lagrange_planets"
[0m00:19:28.363442 [debug] [Thread-1 (]: On seed.sc_interdiction.display_names: COMMIT
[0m00:19:28.363982 [debug] [Thread-2 (]: On seed.sc_interdiction.lagrange_planets: COMMIT
[0m00:19:28.373516 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m00:19:28.374281 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m00:19:28.375851 [debug] [Thread-2 (]: Timing info for seed.sc_interdiction.lagrange_planets (execute): 00:19:27.847268 => 00:19:28.375527
[0m00:19:28.377221 [debug] [Thread-1 (]: Timing info for seed.sc_interdiction.display_names (execute): 00:19:27.841848 => 00:19:28.376948
[0m00:19:28.377818 [debug] [Thread-2 (]: On seed.sc_interdiction.lagrange_planets: Close
[0m00:19:28.378410 [debug] [Thread-1 (]: On seed.sc_interdiction.display_names: Close
[0m00:19:28.379610 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c0f60e50-ff84-4173-8876-7de19788aa14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e3821a650>]}
[0m00:19:28.380574 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c0f60e50-ff84-4173-8876-7de19788aa14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e3821b3a0>]}
[0m00:19:28.381504 [info ] [Thread-2 (]: 2 of 2 OK loaded seed file raw_silver.lagrange_planets ......................... [[32mINSERT 77[0m in 0.54s]
[0m00:19:28.382345 [info ] [Thread-1 (]: 1 of 2 OK loaded seed file raw_silver.display_names ............................ [[32mINSERT 85[0m in 0.54s]
[0m00:19:28.383253 [debug] [Thread-2 (]: Finished running node seed.sc_interdiction.lagrange_planets
[0m00:19:28.384034 [debug] [Thread-1 (]: Finished running node seed.sc_interdiction.display_names
[0m00:19:28.387027 [debug] [MainThread]: Using postgres connection "master"
[0m00:19:28.387596 [debug] [MainThread]: On master: BEGIN
[0m00:19:28.388015 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:19:28.395565 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:19:28.396242 [debug] [MainThread]: On master: COMMIT
[0m00:19:28.396696 [debug] [MainThread]: Using postgres connection "master"
[0m00:19:28.397035 [debug] [MainThread]: On master: COMMIT
[0m00:19:28.397643 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:19:28.398029 [debug] [MainThread]: On master: Close
[0m00:19:28.398920 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:19:28.399299 [debug] [MainThread]: Connection 'seed.sc_interdiction.display_names' was properly closed.
[0m00:19:28.399597 [debug] [MainThread]: Connection 'seed.sc_interdiction.lagrange_planets' was properly closed.
[0m00:19:28.399872 [debug] [MainThread]: Connection 'list_sc_interdiction_raw_silver' was properly closed.
[0m00:19:28.400255 [info ] [MainThread]: 
[0m00:19:28.400690 [info ] [MainThread]: Finished running 2 seeds in 0 hours 0 minutes and 0.90 seconds (0.90s).
[0m00:19:28.401770 [debug] [MainThread]: Command end result
[0m00:19:28.413666 [info ] [MainThread]: 
[0m00:19:28.414180 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:19:28.414522 [info ] [MainThread]: 
[0m00:19:28.414883 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m00:19:28.416112 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 4.450963, "process_user_time": 8.261353, "process_kernel_time": 0.789688, "process_mem_max_rss": "117956", "process_out_blocks": "3464", "process_in_blocks": "0"}
[0m00:19:28.416767 [debug] [MainThread]: Command `dbt seed` succeeded at 00:19:28.416622 after 4.45 seconds
[0m00:19:28.417200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e3e59ed70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e3a7688e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e385f8f40>]}
[0m00:19:28.417648 [debug] [MainThread]: Flushing usage events
[0m00:19:49.408017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcbdf2edd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcbbc0a0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcbbc0a050>]}


============================== 00:19:49.418630 | 1f3ce18c-ca82-432c-9a90-2da7980b6c0e ==============================
[0m00:19:49.418630 [info ] [MainThread]: Running with dbt=1.7.0
[0m00:19:49.419768 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'profiles_dir': '/usr/app', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:19:49.829060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1f3ce18c-ca82-432c-9a90-2da7980b6c0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcbbc4c700>]}
[0m00:19:50.057459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1f3ce18c-ca82-432c-9a90-2da7980b6c0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcba3937c0>]}
[0m00:19:50.058663 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m00:19:50.086688 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m00:19:50.164456 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:19:50.165117 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:19:50.183250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1f3ce18c-ca82-432c-9a90-2da7980b6c0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcb9fba830>]}
[0m00:19:50.217779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1f3ce18c-ca82-432c-9a90-2da7980b6c0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcba17d450>]}
[0m00:19:50.218455 [info ] [MainThread]: Found 12 models, 2 seeds, 16 tests, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m00:19:50.218971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1f3ce18c-ca82-432c-9a90-2da7980b6c0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcba17d510>]}
[0m00:19:50.221997 [info ] [MainThread]: 
[0m00:19:50.223358 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:19:50.225765 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sc_interdiction'
[0m00:19:50.227097 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sc_interdiction'
[0m00:19:50.235395 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sc_interdiction'
[0m00:19:50.246458 [debug] [ThreadPool]: Using postgres connection "list_sc_interdiction"
[0m00:19:50.249818 [debug] [ThreadPool]: Using postgres connection "list_sc_interdiction"
[0m00:19:50.253940 [debug] [ThreadPool]: Using postgres connection "list_sc_interdiction"
[0m00:19:50.255161 [debug] [ThreadPool]: On list_sc_interdiction: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "connection_name": "list_sc_interdiction"} */

    select distinct nspname from pg_namespace
  
[0m00:19:50.255691 [debug] [ThreadPool]: On list_sc_interdiction: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "connection_name": "list_sc_interdiction"} */

    select distinct nspname from pg_namespace
  
[0m00:19:50.256131 [debug] [ThreadPool]: On list_sc_interdiction: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "connection_name": "list_sc_interdiction"} */

    select distinct nspname from pg_namespace
  
[0m00:19:50.256879 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:19:50.257740 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:19:50.258288 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:19:50.268140 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m00:19:50.269638 [debug] [ThreadPool]: On list_sc_interdiction: Close
[0m00:19:50.274205 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m00:19:50.276901 [debug] [ThreadPool]: On list_sc_interdiction: Close
[0m00:19:50.277533 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m00:19:50.279286 [debug] [ThreadPool]: On list_sc_interdiction: Close
[0m00:19:50.283879 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sc_interdiction, now create_sc_interdiction_raw_staging)
[0m00:19:50.285597 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sc_interdiction, now create_sc_interdiction_raw_gold)
[0m00:19:50.286740 [debug] [ThreadPool]: Creating schema "database: "sc_interdiction"
schema: "raw_staging"
"
[0m00:19:50.289323 [debug] [ThreadPool]: Creating schema "database: "sc_interdiction"
schema: "raw_gold"
"
[0m00:19:50.305089 [debug] [ThreadPool]: Using postgres connection "create_sc_interdiction_raw_staging"
[0m00:19:50.307059 [debug] [ThreadPool]: Using postgres connection "create_sc_interdiction_raw_gold"
[0m00:19:50.307660 [debug] [ThreadPool]: On create_sc_interdiction_raw_staging: BEGIN
[0m00:19:50.308107 [debug] [ThreadPool]: On create_sc_interdiction_raw_gold: BEGIN
[0m00:19:50.308564 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:19:50.308967 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:19:50.315939 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:19:50.316524 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:19:50.317060 [debug] [ThreadPool]: Using postgres connection "create_sc_interdiction_raw_gold"
[0m00:19:50.317463 [debug] [ThreadPool]: Using postgres connection "create_sc_interdiction_raw_staging"
[0m00:19:50.318083 [debug] [ThreadPool]: On create_sc_interdiction_raw_gold: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "connection_name": "create_sc_interdiction_raw_gold"} */
create schema if not exists "raw_gold"
[0m00:19:50.320120 [debug] [ThreadPool]: On create_sc_interdiction_raw_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "connection_name": "create_sc_interdiction_raw_staging"} */
create schema if not exists "raw_staging"
[0m00:19:50.324412 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m00:19:50.325061 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m00:19:50.326787 [debug] [ThreadPool]: On create_sc_interdiction_raw_staging: COMMIT
[0m00:19:50.328157 [debug] [ThreadPool]: On create_sc_interdiction_raw_gold: COMMIT
[0m00:19:50.328699 [debug] [ThreadPool]: Using postgres connection "create_sc_interdiction_raw_staging"
[0m00:19:50.329246 [debug] [ThreadPool]: Using postgres connection "create_sc_interdiction_raw_gold"
[0m00:19:50.329708 [debug] [ThreadPool]: On create_sc_interdiction_raw_staging: COMMIT
[0m00:19:50.330095 [debug] [ThreadPool]: On create_sc_interdiction_raw_gold: COMMIT
[0m00:19:50.332210 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m00:19:50.332808 [debug] [ThreadPool]: On create_sc_interdiction_raw_staging: Close
[0m00:19:50.334534 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m00:19:50.335089 [debug] [ThreadPool]: On create_sc_interdiction_raw_gold: Close
[0m00:19:50.338502 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_sc_interdiction_raw_gold, now list_sc_interdiction_raw_silver)
[0m00:19:50.345099 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_sc_interdiction_raw_staging, now list_sc_interdiction_raw_staging)
[0m00:19:50.352438 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sc_interdiction, now list_sc_interdiction_raw_gold)
[0m00:19:50.361254 [debug] [ThreadPool]: Using postgres connection "list_sc_interdiction_raw_silver"
[0m00:19:50.365076 [debug] [ThreadPool]: Using postgres connection "list_sc_interdiction_raw_gold"
[0m00:19:50.367684 [debug] [ThreadPool]: Using postgres connection "list_sc_interdiction_raw_staging"
[0m00:19:50.368340 [debug] [ThreadPool]: On list_sc_interdiction_raw_silver: BEGIN
[0m00:19:50.368783 [debug] [ThreadPool]: On list_sc_interdiction_raw_gold: BEGIN
[0m00:19:50.369223 [debug] [ThreadPool]: On list_sc_interdiction_raw_staging: BEGIN
[0m00:19:50.369602 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:19:50.369953 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:19:50.370409 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:19:50.377278 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:19:50.377925 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:19:50.378445 [debug] [ThreadPool]: Using postgres connection "list_sc_interdiction_raw_silver"
[0m00:19:50.378875 [debug] [ThreadPool]: Using postgres connection "list_sc_interdiction_raw_gold"
[0m00:19:50.379344 [debug] [ThreadPool]: On list_sc_interdiction_raw_silver: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "connection_name": "list_sc_interdiction_raw_silver"} */
select
      'sc_interdiction' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw_silver'
    union all
    select
      'sc_interdiction' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw_silver'
    union all
    select
      'sc_interdiction' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw_silver'
  
[0m00:19:50.379876 [debug] [ThreadPool]: On list_sc_interdiction_raw_gold: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "connection_name": "list_sc_interdiction_raw_gold"} */
select
      'sc_interdiction' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw_gold'
    union all
    select
      'sc_interdiction' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw_gold'
    union all
    select
      'sc_interdiction' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw_gold'
  
[0m00:19:50.380852 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:19:50.381197 [debug] [ThreadPool]: Using postgres connection "list_sc_interdiction_raw_staging"
[0m00:19:50.381563 [debug] [ThreadPool]: On list_sc_interdiction_raw_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "connection_name": "list_sc_interdiction_raw_staging"} */
select
      'sc_interdiction' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw_staging'
    union all
    select
      'sc_interdiction' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw_staging'
    union all
    select
      'sc_interdiction' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw_staging'
  
[0m00:19:50.385939 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m00:19:50.386655 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m00:19:50.387177 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m00:19:50.388689 [debug] [ThreadPool]: On list_sc_interdiction_raw_gold: ROLLBACK
[0m00:19:50.390222 [debug] [ThreadPool]: On list_sc_interdiction_raw_staging: ROLLBACK
[0m00:19:50.392070 [debug] [ThreadPool]: On list_sc_interdiction_raw_silver: ROLLBACK
[0m00:19:50.392976 [debug] [ThreadPool]: On list_sc_interdiction_raw_staging: Close
[0m00:19:50.393456 [debug] [ThreadPool]: On list_sc_interdiction_raw_silver: Close
[0m00:19:50.394075 [debug] [ThreadPool]: On list_sc_interdiction_raw_gold: Close
[0m00:19:50.403859 [debug] [MainThread]: Using postgres connection "master"
[0m00:19:50.404598 [debug] [MainThread]: On master: BEGIN
[0m00:19:50.410939 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:19:50.419983 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:19:50.420892 [debug] [MainThread]: Using postgres connection "master"
[0m00:19:50.421457 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:19:50.439458 [debug] [MainThread]: SQL status: SELECT 8 in 0.0 seconds
[0m00:19:50.441724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1f3ce18c-ca82-432c-9a90-2da7980b6c0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcba45d300>]}
[0m00:19:50.442617 [debug] [MainThread]: On master: ROLLBACK
[0m00:19:50.443475 [debug] [MainThread]: Using postgres connection "master"
[0m00:19:50.443930 [debug] [MainThread]: On master: BEGIN
[0m00:19:50.444595 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:19:50.444950 [debug] [MainThread]: On master: COMMIT
[0m00:19:50.445320 [debug] [MainThread]: Using postgres connection "master"
[0m00:19:50.445694 [debug] [MainThread]: On master: COMMIT
[0m00:19:50.446223 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:19:50.446759 [debug] [MainThread]: On master: Close
[0m00:19:50.447835 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:19:50.448243 [info ] [MainThread]: 
[0m00:19:50.466295 [debug] [Thread-1 (]: Began running node model.sc_interdiction.stg_locations
[0m00:19:50.467015 [debug] [Thread-2 (]: Began running node model.sc_interdiction.stg_quantum_routes
[0m00:19:50.467576 [debug] [Thread-3 (]: Began running node model.sc_interdiction.stg_shop_items
[0m00:19:50.468213 [debug] [Thread-4 (]: Began running node model.sc_interdiction.stg_shops
[0m00:19:50.468877 [info ] [Thread-1 (]: 1 of 12 START sql view model raw_staging.stg_locations ......................... [RUN]
[0m00:19:50.469580 [info ] [Thread-2 (]: 2 of 12 START sql view model raw_staging.stg_quantum_routes .................... [RUN]
[0m00:19:50.470238 [info ] [Thread-3 (]: 3 of 12 START sql view model raw_staging.stg_shop_items ........................ [RUN]
[0m00:19:50.470897 [info ] [Thread-4 (]: 4 of 12 START sql view model raw_staging.stg_shops ............................. [RUN]
[0m00:19:50.471889 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sc_interdiction_raw_gold, now model.sc_interdiction.stg_locations)
[0m00:19:50.472771 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_sc_interdiction_raw_silver, now model.sc_interdiction.stg_quantum_routes)
[0m00:19:50.477183 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_sc_interdiction_raw_staging, now model.sc_interdiction.stg_shop_items)
[0m00:19:50.479798 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.sc_interdiction.stg_shops'
[0m00:19:50.480706 [debug] [Thread-1 (]: Began compiling node model.sc_interdiction.stg_locations
[0m00:19:50.481291 [debug] [Thread-2 (]: Began compiling node model.sc_interdiction.stg_quantum_routes
[0m00:19:50.481869 [debug] [Thread-3 (]: Began compiling node model.sc_interdiction.stg_shop_items
[0m00:19:50.482391 [debug] [Thread-4 (]: Began compiling node model.sc_interdiction.stg_shops
[0m00:19:50.497061 [debug] [Thread-2 (]: Writing injected SQL for node "model.sc_interdiction.stg_quantum_routes"
[0m00:19:50.501832 [debug] [Thread-3 (]: Writing injected SQL for node "model.sc_interdiction.stg_shop_items"
[0m00:19:50.503092 [debug] [Thread-1 (]: Writing injected SQL for node "model.sc_interdiction.stg_locations"
[0m00:19:50.506165 [debug] [Thread-4 (]: Writing injected SQL for node "model.sc_interdiction.stg_shops"
[0m00:19:50.508930 [debug] [Thread-1 (]: Timing info for model.sc_interdiction.stg_locations (compile): 00:19:50.482767 => 00:19:50.508530
[0m00:19:50.509525 [debug] [Thread-2 (]: Timing info for model.sc_interdiction.stg_quantum_routes (compile): 00:19:50.494514 => 00:19:50.509251
[0m00:19:50.510198 [debug] [Thread-3 (]: Timing info for model.sc_interdiction.stg_shop_items (compile): 00:19:50.497763 => 00:19:50.509913
[0m00:19:50.510768 [debug] [Thread-1 (]: Began executing node model.sc_interdiction.stg_locations
[0m00:19:50.511860 [debug] [Thread-2 (]: Began executing node model.sc_interdiction.stg_quantum_routes
[0m00:19:50.512377 [debug] [Thread-3 (]: Began executing node model.sc_interdiction.stg_shop_items
[0m00:19:50.513334 [debug] [Thread-4 (]: Timing info for model.sc_interdiction.stg_shops (compile): 00:19:50.503616 => 00:19:50.512704
[0m00:19:50.748759 [debug] [Thread-1 (]: Writing runtime sql for node "model.sc_interdiction.stg_locations"
[0m00:19:50.750984 [debug] [Thread-2 (]: Writing runtime sql for node "model.sc_interdiction.stg_quantum_routes"
[0m00:19:50.755163 [debug] [Thread-3 (]: Writing runtime sql for node "model.sc_interdiction.stg_shop_items"
[0m00:19:50.756032 [debug] [Thread-4 (]: Began executing node model.sc_interdiction.stg_shops
[0m00:19:50.763932 [debug] [Thread-4 (]: Writing runtime sql for node "model.sc_interdiction.stg_shops"
[0m00:19:50.769896 [debug] [Thread-1 (]: Using postgres connection "model.sc_interdiction.stg_locations"
[0m00:19:50.773845 [debug] [Thread-4 (]: Using postgres connection "model.sc_interdiction.stg_shops"
[0m00:19:50.774712 [debug] [Thread-1 (]: On model.sc_interdiction.stg_locations: BEGIN
[0m00:19:50.775332 [debug] [Thread-3 (]: Using postgres connection "model.sc_interdiction.stg_shop_items"
[0m00:19:50.775846 [debug] [Thread-2 (]: Using postgres connection "model.sc_interdiction.stg_quantum_routes"
[0m00:19:50.776361 [debug] [Thread-4 (]: On model.sc_interdiction.stg_shops: BEGIN
[0m00:19:50.776847 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:19:50.777484 [debug] [Thread-3 (]: On model.sc_interdiction.stg_shop_items: BEGIN
[0m00:19:50.777980 [debug] [Thread-2 (]: On model.sc_interdiction.stg_quantum_routes: BEGIN
[0m00:19:50.778450 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m00:19:50.779150 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:19:50.779642 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:19:50.785610 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m00:19:50.786199 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:19:50.786815 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m00:19:50.787451 [debug] [Thread-4 (]: Using postgres connection "model.sc_interdiction.stg_shops"
[0m00:19:50.788018 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m00:19:50.788515 [debug] [Thread-1 (]: Using postgres connection "model.sc_interdiction.stg_locations"
[0m00:19:50.788993 [debug] [Thread-2 (]: Using postgres connection "model.sc_interdiction.stg_quantum_routes"
[0m00:19:50.789519 [debug] [Thread-4 (]: On model.sc_interdiction.stg_shops: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "node_id": "model.sc_interdiction.stg_shops"} */

  create view "sc_interdiction"."raw_staging"."stg_shops__dbt_tmp"
    
    
  as (
    -- Staging model for raw shops

select
    shop_id,
    location_id,
    shop_name,
    created_at,
    updated_at
from raw.shops
  );
[0m00:19:50.790036 [debug] [Thread-3 (]: Using postgres connection "model.sc_interdiction.stg_shop_items"
[0m00:19:50.790543 [debug] [Thread-1 (]: On model.sc_interdiction.stg_locations: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "node_id": "model.sc_interdiction.stg_locations"} */

  create view "sc_interdiction"."raw_staging"."stg_locations__dbt_tmp"
    
    
  as (
    -- Staging model for raw locations
-- Reads from Diesel-managed raw.locations table

select
    id,
    name,
    parent_id,
    location_type,
    nav_icon,
    affiliation,
    description,
    is_scannable,
    hide_in_starmap,
    obstruction_radius,
    arrival_radius,
    arrival_point_offset,
    adoption_radius,
    created_at,
    updated_at
from raw.locations
  );
[0m00:19:50.791276 [debug] [Thread-2 (]: On model.sc_interdiction.stg_quantum_routes: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "node_id": "model.sc_interdiction.stg_quantum_routes"} */

  create view "sc_interdiction"."raw_staging"."stg_quantum_routes__dbt_tmp"
    
    
  as (
    -- Staging model for raw quantum routes

select
    id,
    from_location,
    to_location,
    distance,
    created_at,
    updated_at
from raw.quantum_routes
  );
[0m00:19:50.791935 [debug] [Thread-3 (]: On model.sc_interdiction.stg_shop_items: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "node_id": "model.sc_interdiction.stg_shop_items"} */

  create view "sc_interdiction"."raw_staging"."stg_shop_items__dbt_tmp"
    
    
  as (
    -- Staging model for raw shop items

select
    id,
    shop_id,
    item_id,
    buy_price,
    sell_price,
    max_inventory,
    created_at,
    updated_at
from raw.shop_items
  );
[0m00:19:50.805088 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m00:19:50.805724 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m00:19:50.806217 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m00:19:50.806590 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m00:19:50.815942 [debug] [Thread-3 (]: Using postgres connection "model.sc_interdiction.stg_shop_items"
[0m00:19:50.821144 [debug] [Thread-2 (]: Using postgres connection "model.sc_interdiction.stg_quantum_routes"
[0m00:19:50.826247 [debug] [Thread-4 (]: Using postgres connection "model.sc_interdiction.stg_shops"
[0m00:19:50.831656 [debug] [Thread-1 (]: Using postgres connection "model.sc_interdiction.stg_locations"
[0m00:19:50.832781 [debug] [Thread-3 (]: On model.sc_interdiction.stg_shop_items: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "node_id": "model.sc_interdiction.stg_shop_items"} */
alter table "sc_interdiction"."raw_staging"."stg_shop_items__dbt_tmp" rename to "stg_shop_items"
[0m00:19:50.833518 [debug] [Thread-2 (]: On model.sc_interdiction.stg_quantum_routes: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "node_id": "model.sc_interdiction.stg_quantum_routes"} */
alter table "sc_interdiction"."raw_staging"."stg_quantum_routes__dbt_tmp" rename to "stg_quantum_routes"
[0m00:19:50.834083 [debug] [Thread-4 (]: On model.sc_interdiction.stg_shops: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "node_id": "model.sc_interdiction.stg_shops"} */
alter table "sc_interdiction"."raw_staging"."stg_shops__dbt_tmp" rename to "stg_shops"
[0m00:19:50.834550 [debug] [Thread-1 (]: On model.sc_interdiction.stg_locations: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "node_id": "model.sc_interdiction.stg_locations"} */
alter table "sc_interdiction"."raw_staging"."stg_locations__dbt_tmp" rename to "stg_locations"
[0m00:19:50.840984 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:19:50.841710 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:19:50.842236 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:19:50.842878 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:19:50.877374 [debug] [Thread-1 (]: On model.sc_interdiction.stg_locations: COMMIT
[0m00:19:50.881821 [debug] [Thread-4 (]: On model.sc_interdiction.stg_shops: COMMIT
[0m00:19:50.884532 [debug] [Thread-3 (]: On model.sc_interdiction.stg_shop_items: COMMIT
[0m00:19:50.887146 [debug] [Thread-2 (]: On model.sc_interdiction.stg_quantum_routes: COMMIT
[0m00:19:50.887975 [debug] [Thread-1 (]: Using postgres connection "model.sc_interdiction.stg_locations"
[0m00:19:50.888533 [debug] [Thread-4 (]: Using postgres connection "model.sc_interdiction.stg_shops"
[0m00:19:50.889081 [debug] [Thread-3 (]: Using postgres connection "model.sc_interdiction.stg_shop_items"
[0m00:19:50.889647 [debug] [Thread-2 (]: Using postgres connection "model.sc_interdiction.stg_quantum_routes"
[0m00:19:50.890172 [debug] [Thread-1 (]: On model.sc_interdiction.stg_locations: COMMIT
[0m00:19:50.890715 [debug] [Thread-4 (]: On model.sc_interdiction.stg_shops: COMMIT
[0m00:19:50.891218 [debug] [Thread-3 (]: On model.sc_interdiction.stg_shop_items: COMMIT
[0m00:19:50.891745 [debug] [Thread-2 (]: On model.sc_interdiction.stg_quantum_routes: COMMIT
[0m00:19:50.904513 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m00:19:50.924785 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m00:19:50.928310 [debug] [Thread-1 (]: Applying DROP to: "sc_interdiction"."raw_staging"."stg_locations__dbt_backup"
[0m00:19:50.928998 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m00:19:50.929766 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m00:19:50.934274 [debug] [Thread-2 (]: Applying DROP to: "sc_interdiction"."raw_staging"."stg_quantum_routes__dbt_backup"
[0m00:19:50.941239 [debug] [Thread-1 (]: Using postgres connection "model.sc_interdiction.stg_locations"
[0m00:19:50.945220 [debug] [Thread-4 (]: Applying DROP to: "sc_interdiction"."raw_staging"."stg_shops__dbt_backup"
[0m00:19:50.949291 [debug] [Thread-3 (]: Applying DROP to: "sc_interdiction"."raw_staging"."stg_shop_items__dbt_backup"
[0m00:19:50.950780 [debug] [Thread-2 (]: Using postgres connection "model.sc_interdiction.stg_quantum_routes"
[0m00:19:50.951492 [debug] [Thread-1 (]: On model.sc_interdiction.stg_locations: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "node_id": "model.sc_interdiction.stg_locations"} */
drop view if exists "sc_interdiction"."raw_staging"."stg_locations__dbt_backup" cascade
[0m00:19:50.952724 [debug] [Thread-4 (]: Using postgres connection "model.sc_interdiction.stg_shops"
[0m00:19:50.953805 [debug] [Thread-3 (]: Using postgres connection "model.sc_interdiction.stg_shop_items"
[0m00:19:50.954351 [debug] [Thread-2 (]: On model.sc_interdiction.stg_quantum_routes: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "node_id": "model.sc_interdiction.stg_quantum_routes"} */
drop view if exists "sc_interdiction"."raw_staging"."stg_quantum_routes__dbt_backup" cascade
[0m00:19:50.954967 [debug] [Thread-4 (]: On model.sc_interdiction.stg_shops: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "node_id": "model.sc_interdiction.stg_shops"} */
drop view if exists "sc_interdiction"."raw_staging"."stg_shops__dbt_backup" cascade
[0m00:19:50.955449 [debug] [Thread-3 (]: On model.sc_interdiction.stg_shop_items: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "node_id": "model.sc_interdiction.stg_shop_items"} */
drop view if exists "sc_interdiction"."raw_staging"."stg_shop_items__dbt_backup" cascade
[0m00:19:50.992134 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.0 seconds
[0m00:19:50.992825 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m00:19:50.993323 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m00:19:50.993852 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m00:19:50.996070 [debug] [Thread-4 (]: Timing info for model.sc_interdiction.stg_shops (execute): 00:19:50.757066 => 00:19:50.995769
[0m00:19:50.998832 [debug] [Thread-1 (]: Timing info for model.sc_interdiction.stg_locations (execute): 00:19:50.514654 => 00:19:50.998389
[0m00:19:51.001523 [debug] [Thread-3 (]: Timing info for model.sc_interdiction.stg_shop_items (execute): 00:19:50.569298 => 00:19:51.001213
[0m00:19:51.004150 [debug] [Thread-2 (]: Timing info for model.sc_interdiction.stg_quantum_routes (execute): 00:19:50.537633 => 00:19:51.003850
[0m00:19:51.004837 [debug] [Thread-4 (]: On model.sc_interdiction.stg_shops: Close
[0m00:19:51.008319 [debug] [Thread-1 (]: On model.sc_interdiction.stg_locations: Close
[0m00:19:51.009105 [debug] [Thread-3 (]: On model.sc_interdiction.stg_shop_items: Close
[0m00:19:51.009741 [debug] [Thread-2 (]: On model.sc_interdiction.stg_quantum_routes: Close
[0m00:19:51.011218 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f3ce18c-ca82-432c-9a90-2da7980b6c0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcba1abee0>]}
[0m00:19:51.012419 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f3ce18c-ca82-432c-9a90-2da7980b6c0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcba019000>]}
[0m00:19:51.013493 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f3ce18c-ca82-432c-9a90-2da7980b6c0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcba064070>]}
[0m00:19:51.015559 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f3ce18c-ca82-432c-9a90-2da7980b6c0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcb9ec8f10>]}
[0m00:19:51.014668 [info ] [Thread-4 (]: 4 of 12 OK created sql view model raw_staging.stg_shops ........................ [[32mCREATE VIEW[0m in 0.53s]
[0m00:19:51.016814 [info ] [Thread-1 (]: 1 of 12 OK created sql view model raw_staging.stg_locations .................... [[32mCREATE VIEW[0m in 0.54s]
[0m00:19:51.017681 [info ] [Thread-3 (]: 3 of 12 OK created sql view model raw_staging.stg_shop_items ................... [[32mCREATE VIEW[0m in 0.54s]
[0m00:19:51.018453 [info ] [Thread-2 (]: 2 of 12 OK created sql view model raw_staging.stg_quantum_routes ............... [[32mCREATE VIEW[0m in 0.54s]
[0m00:19:51.019201 [debug] [Thread-4 (]: Finished running node model.sc_interdiction.stg_shops
[0m00:19:51.019823 [debug] [Thread-1 (]: Finished running node model.sc_interdiction.stg_locations
[0m00:19:51.020524 [debug] [Thread-3 (]: Finished running node model.sc_interdiction.stg_shop_items
[0m00:19:51.021192 [debug] [Thread-2 (]: Finished running node model.sc_interdiction.stg_quantum_routes
[0m00:19:51.022856 [debug] [Thread-4 (]: Began running node model.sc_interdiction.silver_locations
[0m00:19:51.023703 [info ] [Thread-4 (]: 5 of 12 START sql table model raw_silver.silver_locations ...................... [RUN]
[0m00:19:51.024598 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.sc_interdiction.stg_shops, now model.sc_interdiction.silver_locations)
[0m00:19:51.025011 [debug] [Thread-4 (]: Began compiling node model.sc_interdiction.silver_locations
[0m00:19:51.034184 [debug] [Thread-4 (]: Writing injected SQL for node "model.sc_interdiction.silver_locations"
[0m00:19:51.035943 [debug] [Thread-4 (]: Timing info for model.sc_interdiction.silver_locations (compile): 00:19:51.025270 => 00:19:51.035601
[0m00:19:51.036461 [debug] [Thread-4 (]: Began executing node model.sc_interdiction.silver_locations
[0m00:19:51.082866 [debug] [Thread-4 (]: Writing runtime sql for node "model.sc_interdiction.silver_locations"
[0m00:19:51.086408 [debug] [Thread-4 (]: Using postgres connection "model.sc_interdiction.silver_locations"
[0m00:19:51.087520 [debug] [Thread-4 (]: On model.sc_interdiction.silver_locations: BEGIN
[0m00:19:51.087988 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:19:51.095647 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m00:19:51.096282 [debug] [Thread-4 (]: Using postgres connection "model.sc_interdiction.silver_locations"
[0m00:19:51.096732 [debug] [Thread-4 (]: On model.sc_interdiction.silver_locations: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "node_id": "model.sc_interdiction.silver_locations"} */

  
    

  create  table "sc_interdiction"."raw_silver"."silver_locations__dbt_tmp"
  
  
    as
  
  (
    -- Silver locations: validated with display names and corrected hierarchy
-- Uses recursive CTE to handle parent-child relationships
-- Lagrange points are re-parented to their associated planets (game data incorrectly parents to star)



with recursive location_tree as (
    -- Base case: root locations (no parent or parent doesn't exist in raw)
    select
        id,
        name,
        parent_id,
        location_type,
        nav_icon,
        affiliation,
        description,
        is_scannable,
        hide_in_starmap,
        obstruction_radius,
        arrival_radius,
        arrival_point_offset,
        adoption_radius,
        created_at,
        updated_at
    from "sc_interdiction"."raw_staging"."stg_locations"
    where parent_id is null
       or parent_id not in (select id from "sc_interdiction"."raw_staging"."stg_locations")

    union all

    -- Recursive case: children of already-processed locations
    select
        r.id,
        r.name,
        r.parent_id,
        r.location_type,
        r.nav_icon,
        r.affiliation,
        r.description,
        r.is_scannable,
        r.hide_in_starmap,
        r.obstruction_radius,
        r.arrival_radius,
        r.arrival_point_offset,
        r.adoption_radius,
        r.created_at,
        r.updated_at
    from "sc_interdiction"."raw_staging"."stg_locations" r
    inner join location_tree lt on r.parent_id = lt.id
),

-- Get planet IDs for Lagrange point re-parenting
lagrange_planet_ids as (
    select
        lp.loc_name,
        lp.planet_loc_name,
        lp.system_name,
        stg.id as planet_id
    from "sc_interdiction"."raw_silver"."lagrange_planets" lp
    inner join "sc_interdiction"."raw_staging"."stg_locations" stg on stg.name = lp.planet_loc_name
)

select
    lt.id,
    lt.name,
    -- Re-parent Lagrange points to their associated planet, otherwise use original parent
    coalesce(
        lpi.planet_id,
        case
            when lt.parent_id in (select id from location_tree) then lt.parent_id
            else null
        end
    ) as parent_id,
    lt.location_type,
    lt.nav_icon,
    lt.affiliation,
    lt.description,
    lt.is_scannable,
    lt.hide_in_starmap,
    lt.obstruction_radius,
    lt.arrival_radius,
    lt.arrival_point_offset,
    lt.adoption_radius,
    dn.display_name,
    lt.created_at,
    lt.updated_at
from location_tree lt
left join "sc_interdiction"."raw_silver"."display_names" dn on lt.name = dn.loc_name
left join lagrange_planet_ids lpi on lt.name = lpi.loc_name
  );
  
[0m00:19:53.405040 [debug] [Thread-4 (]: SQL status: SELECT 1915 in 2.0 seconds
[0m00:19:53.409954 [debug] [Thread-4 (]: Using postgres connection "model.sc_interdiction.silver_locations"
[0m00:19:53.410691 [debug] [Thread-4 (]: On model.sc_interdiction.silver_locations: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "node_id": "model.sc_interdiction.silver_locations"} */
alter table "sc_interdiction"."raw_silver"."silver_locations__dbt_tmp" rename to "silver_locations"
[0m00:19:53.411841 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:19:53.447192 [debug] [Thread-4 (]: Using postgres connection "model.sc_interdiction.silver_locations"
[0m00:19:53.447920 [debug] [Thread-4 (]: On model.sc_interdiction.silver_locations: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "node_id": "model.sc_interdiction.silver_locations"} */

    create  index if not exists
  "8fba101d131d55cf44641ff01a629e17"
  on "sc_interdiction"."raw_silver"."silver_locations" 
  (parent_id);
  
[0m00:19:53.471551 [debug] [Thread-4 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m00:19:53.474383 [debug] [Thread-4 (]: Using postgres connection "model.sc_interdiction.silver_locations"
[0m00:19:53.475257 [debug] [Thread-4 (]: On model.sc_interdiction.silver_locations: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "node_id": "model.sc_interdiction.silver_locations"} */

    create  index if not exists
  "bde099c79baa4b26dc1fdb64d06b6fbf"
  on "sc_interdiction"."raw_silver"."silver_locations" 
  (location_type);
  
[0m00:19:53.482325 [debug] [Thread-4 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m00:19:53.485077 [debug] [Thread-4 (]: Using postgres connection "model.sc_interdiction.silver_locations"
[0m00:19:53.485769 [debug] [Thread-4 (]: On model.sc_interdiction.silver_locations: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "node_id": "model.sc_interdiction.silver_locations"} */

    create  index if not exists
  "fbfb4c27f95e755154cb240b0861397a"
  on "sc_interdiction"."raw_silver"."silver_locations" 
  (affiliation);
  
[0m00:19:53.495479 [debug] [Thread-4 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m00:19:53.499025 [debug] [Thread-4 (]: Using postgres connection "model.sc_interdiction.silver_locations"
[0m00:19:53.499692 [debug] [Thread-4 (]: On model.sc_interdiction.silver_locations: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "node_id": "model.sc_interdiction.silver_locations"} */

    create  index if not exists
  "c69bb0f21f87381f9588dac1ec09c8e8"
  on "sc_interdiction"."raw_silver"."silver_locations" 
  (display_name);
  
[0m00:19:53.513166 [debug] [Thread-4 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m00:19:53.516608 [debug] [Thread-4 (]: On model.sc_interdiction.silver_locations: COMMIT
[0m00:19:53.517441 [debug] [Thread-4 (]: Using postgres connection "model.sc_interdiction.silver_locations"
[0m00:19:53.517916 [debug] [Thread-4 (]: On model.sc_interdiction.silver_locations: COMMIT
[0m00:19:53.525861 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m00:19:53.530693 [debug] [Thread-4 (]: Applying DROP to: "sc_interdiction"."raw_silver"."silver_locations__dbt_backup"
[0m00:19:53.536238 [debug] [Thread-4 (]: Using postgres connection "model.sc_interdiction.silver_locations"
[0m00:19:53.536996 [debug] [Thread-4 (]: On model.sc_interdiction.silver_locations: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "node_id": "model.sc_interdiction.silver_locations"} */
drop table if exists "sc_interdiction"."raw_silver"."silver_locations__dbt_backup" cascade
[0m00:19:53.538064 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m00:19:53.540513 [debug] [Thread-4 (]: Timing info for model.sc_interdiction.silver_locations (execute): 00:19:51.036753 => 00:19:53.540144
[0m00:19:53.541111 [debug] [Thread-4 (]: On model.sc_interdiction.silver_locations: Close
[0m00:19:53.542296 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f3ce18c-ca82-432c-9a90-2da7980b6c0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcba0388b0>]}
[0m00:19:53.543028 [info ] [Thread-4 (]: 5 of 12 OK created sql table model raw_silver.silver_locations ................. [[32mSELECT 1915[0m in 2.52s]
[0m00:19:53.543843 [debug] [Thread-4 (]: Finished running node model.sc_interdiction.silver_locations
[0m00:19:53.545316 [debug] [Thread-3 (]: Began running node model.sc_interdiction.gold_locations
[0m00:19:53.545846 [debug] [Thread-2 (]: Began running node model.sc_interdiction.silver_quantum_routes
[0m00:19:53.546502 [debug] [Thread-1 (]: Began running node model.sc_interdiction.silver_shops
[0m00:19:53.547132 [info ] [Thread-3 (]: 6 of 12 START sql view model raw_gold.gold_locations ........................... [RUN]
[0m00:19:53.547939 [info ] [Thread-2 (]: 7 of 12 START sql table model raw_silver.silver_quantum_routes ................. [RUN]
[0m00:19:53.548596 [info ] [Thread-1 (]: 8 of 12 START sql table model raw_silver.silver_shops .......................... [RUN]
[0m00:19:53.549770 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.sc_interdiction.stg_shop_items, now model.sc_interdiction.gold_locations)
[0m00:19:53.550645 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.sc_interdiction.stg_quantum_routes, now model.sc_interdiction.silver_quantum_routes)
[0m00:19:53.551396 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sc_interdiction.stg_locations, now model.sc_interdiction.silver_shops)
[0m00:19:53.551934 [debug] [Thread-3 (]: Began compiling node model.sc_interdiction.gold_locations
[0m00:19:53.552512 [debug] [Thread-2 (]: Began compiling node model.sc_interdiction.silver_quantum_routes
[0m00:19:53.553043 [debug] [Thread-1 (]: Began compiling node model.sc_interdiction.silver_shops
[0m00:19:53.558704 [debug] [Thread-3 (]: Writing injected SQL for node "model.sc_interdiction.gold_locations"
[0m00:19:53.565157 [debug] [Thread-2 (]: Writing injected SQL for node "model.sc_interdiction.silver_quantum_routes"
[0m00:19:53.570947 [debug] [Thread-1 (]: Writing injected SQL for node "model.sc_interdiction.silver_shops"
[0m00:19:53.572743 [debug] [Thread-2 (]: Timing info for model.sc_interdiction.silver_quantum_routes (compile): 00:19:53.559306 => 00:19:53.572301
[0m00:19:53.573217 [debug] [Thread-2 (]: Began executing node model.sc_interdiction.silver_quantum_routes
[0m00:19:53.579278 [debug] [Thread-1 (]: Timing info for model.sc_interdiction.silver_shops (compile): 00:19:53.565732 => 00:19:53.578714
[0m00:19:53.579933 [debug] [Thread-1 (]: Began executing node model.sc_interdiction.silver_shops
[0m00:19:53.587160 [debug] [Thread-2 (]: Writing runtime sql for node "model.sc_interdiction.silver_quantum_routes"
[0m00:19:53.590903 [debug] [Thread-1 (]: Writing runtime sql for node "model.sc_interdiction.silver_shops"
[0m00:19:53.592043 [debug] [Thread-3 (]: Timing info for model.sc_interdiction.gold_locations (compile): 00:19:53.553398 => 00:19:53.591725
[0m00:19:53.593479 [debug] [Thread-3 (]: Began executing node model.sc_interdiction.gold_locations
[0m00:19:53.599703 [debug] [Thread-2 (]: Using postgres connection "model.sc_interdiction.silver_quantum_routes"
[0m00:19:53.605362 [debug] [Thread-2 (]: On model.sc_interdiction.silver_quantum_routes: BEGIN
[0m00:19:53.604198 [debug] [Thread-3 (]: Writing runtime sql for node "model.sc_interdiction.gold_locations"
[0m00:19:53.606034 [debug] [Thread-1 (]: Using postgres connection "model.sc_interdiction.silver_shops"
[0m00:19:53.606667 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:19:53.607970 [debug] [Thread-1 (]: On model.sc_interdiction.silver_shops: BEGIN
[0m00:19:53.608641 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:19:53.613118 [debug] [Thread-3 (]: Using postgres connection "model.sc_interdiction.gold_locations"
[0m00:19:53.613684 [debug] [Thread-3 (]: On model.sc_interdiction.gold_locations: BEGIN
[0m00:19:53.614025 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:19:53.614921 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m00:19:53.615367 [debug] [Thread-2 (]: Using postgres connection "model.sc_interdiction.silver_quantum_routes"
[0m00:19:53.615953 [debug] [Thread-2 (]: On model.sc_interdiction.silver_quantum_routes: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "node_id": "model.sc_interdiction.silver_quantum_routes"} */

  
    

  create  table "sc_interdiction"."raw_silver"."silver_quantum_routes__dbt_tmp"
  
  
    as
  
  (
    -- Silver quantum routes: validated with foreign keys to locations



select
    r.id,
    r.from_location,
    r.to_location,
    r.distance,
    r.created_at,
    r.updated_at
from "sc_interdiction"."raw_staging"."stg_quantum_routes" r
where r.from_location in (select id from "sc_interdiction"."raw_silver"."silver_locations")
  and r.to_location in (select id from "sc_interdiction"."raw_silver"."silver_locations")
  );
  
[0m00:19:53.616481 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:19:53.617036 [debug] [Thread-1 (]: Using postgres connection "model.sc_interdiction.silver_shops"
[0m00:19:53.617460 [debug] [Thread-1 (]: On model.sc_interdiction.silver_shops: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "node_id": "model.sc_interdiction.silver_shops"} */

  
    

  create  table "sc_interdiction"."raw_silver"."silver_shops__dbt_tmp"
  
  
    as
  
  (
    -- Silver shops: validated with foreign key integrity



select
    s.shop_id,
    case
        when s.location_id in (select id from "sc_interdiction"."raw_silver"."silver_locations")
        then s.location_id
        else null
    end as location_id,
    s.shop_name,
    s.created_at,
    s.updated_at
from "sc_interdiction"."raw_staging"."stg_shops" s
  );
  
[0m00:19:53.629310 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m00:19:53.630023 [debug] [Thread-3 (]: Using postgres connection "model.sc_interdiction.gold_locations"
[0m00:19:53.630648 [debug] [Thread-3 (]: On model.sc_interdiction.gold_locations: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "node_id": "model.sc_interdiction.gold_locations"} */

  create view "sc_interdiction"."raw_gold"."gold_locations__dbt_tmp"
    
    
  as (
    -- Gold locations: denormalized view with parent names

select
    l.id,
    l.name,
    l.display_name,
    l.parent_id,
    p.name as parent_name,
    p.display_name as parent_display_name,
    l.location_type,
    l.nav_icon,
    l.affiliation,
    l.description,
    l.is_scannable,
    l.hide_in_starmap,
    l.obstruction_radius,
    l.arrival_radius,
    l.arrival_point_offset,
    l.adoption_radius
from "sc_interdiction"."raw_silver"."silver_locations" l
left join "sc_interdiction"."raw_silver"."silver_locations" p on l.parent_id = p.id
  );
[0m00:19:53.635853 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.0 seconds
[0m00:19:53.641081 [debug] [Thread-2 (]: Using postgres connection "model.sc_interdiction.silver_quantum_routes"
[0m00:19:53.641763 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m00:19:53.642321 [debug] [Thread-2 (]: On model.sc_interdiction.silver_quantum_routes: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "node_id": "model.sc_interdiction.silver_quantum_routes"} */
alter table "sc_interdiction"."raw_silver"."silver_quantum_routes__dbt_tmp" rename to "silver_quantum_routes"
[0m00:19:53.649086 [debug] [Thread-3 (]: Using postgres connection "model.sc_interdiction.gold_locations"
[0m00:19:53.650057 [debug] [Thread-3 (]: On model.sc_interdiction.gold_locations: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "node_id": "model.sc_interdiction.gold_locations"} */
alter table "sc_interdiction"."raw_gold"."gold_locations__dbt_tmp" rename to "gold_locations"
[0m00:19:53.650683 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:19:53.653493 [debug] [Thread-2 (]: Using postgres connection "model.sc_interdiction.silver_quantum_routes"
[0m00:19:53.654250 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:19:53.654784 [debug] [Thread-2 (]: On model.sc_interdiction.silver_quantum_routes: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "node_id": "model.sc_interdiction.silver_quantum_routes"} */

    create  index if not exists
  "31b78cfcade5554ef454004055566296"
  on "sc_interdiction"."raw_silver"."silver_quantum_routes" 
  (from_location);
  
[0m00:19:53.657256 [debug] [Thread-3 (]: On model.sc_interdiction.gold_locations: COMMIT
[0m00:19:53.658132 [debug] [Thread-3 (]: Using postgres connection "model.sc_interdiction.gold_locations"
[0m00:19:53.658640 [debug] [Thread-3 (]: On model.sc_interdiction.gold_locations: COMMIT
[0m00:19:53.672254 [debug] [Thread-1 (]: SQL status: SELECT 108 in 0.0 seconds
[0m00:19:53.672898 [debug] [Thread-2 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m00:19:53.681323 [debug] [Thread-2 (]: Using postgres connection "model.sc_interdiction.silver_quantum_routes"
[0m00:19:53.682679 [debug] [Thread-1 (]: Using postgres connection "model.sc_interdiction.silver_shops"
[0m00:19:53.683596 [debug] [Thread-2 (]: On model.sc_interdiction.silver_quantum_routes: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "node_id": "model.sc_interdiction.silver_quantum_routes"} */

    create  index if not exists
  "eda5dddcbbc7aa6827e5ba5eb3ee7352"
  on "sc_interdiction"."raw_silver"."silver_quantum_routes" 
  (to_location);
  
[0m00:19:53.684289 [debug] [Thread-1 (]: On model.sc_interdiction.silver_shops: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "node_id": "model.sc_interdiction.silver_shops"} */
alter table "sc_interdiction"."raw_silver"."silver_shops__dbt_tmp" rename to "silver_shops"
[0m00:19:53.690521 [debug] [Thread-2 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m00:19:53.694119 [debug] [Thread-2 (]: On model.sc_interdiction.silver_quantum_routes: COMMIT
[0m00:19:53.694909 [debug] [Thread-2 (]: Using postgres connection "model.sc_interdiction.silver_quantum_routes"
[0m00:19:53.695435 [debug] [Thread-2 (]: On model.sc_interdiction.silver_quantum_routes: COMMIT
[0m00:19:53.698965 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:19:53.701963 [debug] [Thread-1 (]: Using postgres connection "model.sc_interdiction.silver_shops"
[0m00:19:53.702626 [debug] [Thread-1 (]: On model.sc_interdiction.silver_shops: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "node_id": "model.sc_interdiction.silver_shops"} */

    create  index if not exists
  "8dc202ce4231fcf5ec14a18aede8ac6a"
  on "sc_interdiction"."raw_silver"."silver_shops" 
  (location_id);
  
[0m00:19:53.706515 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m00:19:53.710981 [debug] [Thread-3 (]: Applying DROP to: "sc_interdiction"."raw_gold"."gold_locations__dbt_backup"
[0m00:19:53.711581 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m00:19:53.712962 [debug] [Thread-3 (]: Using postgres connection "model.sc_interdiction.gold_locations"
[0m00:19:53.716904 [debug] [Thread-2 (]: Applying DROP to: "sc_interdiction"."raw_silver"."silver_quantum_routes__dbt_backup"
[0m00:19:53.721259 [debug] [Thread-2 (]: Using postgres connection "model.sc_interdiction.silver_quantum_routes"
[0m00:19:53.721743 [debug] [Thread-2 (]: On model.sc_interdiction.silver_quantum_routes: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "node_id": "model.sc_interdiction.silver_quantum_routes"} */
drop table if exists "sc_interdiction"."raw_silver"."silver_quantum_routes__dbt_backup" cascade
[0m00:19:53.719246 [debug] [Thread-3 (]: On model.sc_interdiction.gold_locations: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "node_id": "model.sc_interdiction.gold_locations"} */
drop view if exists "sc_interdiction"."raw_gold"."gold_locations__dbt_backup" cascade
[0m00:19:53.722767 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m00:19:53.730967 [debug] [Thread-2 (]: Timing info for model.sc_interdiction.silver_quantum_routes (execute): 00:19:53.573493 => 00:19:53.730624
[0m00:19:53.731483 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m00:19:53.732167 [debug] [Thread-2 (]: On model.sc_interdiction.silver_quantum_routes: Close
[0m00:19:53.734947 [debug] [Thread-3 (]: Timing info for model.sc_interdiction.gold_locations (execute): 00:19:53.594082 => 00:19:53.734526
[0m00:19:53.735825 [debug] [Thread-3 (]: On model.sc_interdiction.gold_locations: Close
[0m00:19:53.737092 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f3ce18c-ca82-432c-9a90-2da7980b6c0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcb9fb38b0>]}
[0m00:19:53.738210 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f3ce18c-ca82-432c-9a90-2da7980b6c0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcba17ce50>]}
[0m00:19:53.739178 [info ] [Thread-2 (]: 7 of 12 OK created sql table model raw_silver.silver_quantum_routes ............ [[32mSELECT 0[0m in 0.19s]
[0m00:19:53.740095 [info ] [Thread-3 (]: 6 of 12 OK created sql view model raw_gold.gold_locations ...................... [[32mCREATE VIEW[0m in 0.19s]
[0m00:19:53.740918 [debug] [Thread-2 (]: Finished running node model.sc_interdiction.silver_quantum_routes
[0m00:19:53.741505 [debug] [Thread-3 (]: Finished running node model.sc_interdiction.gold_locations
[0m00:19:53.742501 [debug] [Thread-4 (]: Began running node model.sc_interdiction.gold_quantum_routes
[0m00:19:53.743314 [info ] [Thread-4 (]: 9 of 12 START sql view model raw_gold.gold_quantum_routes ...................... [RUN]
[0m00:19:53.744191 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.sc_interdiction.silver_locations, now model.sc_interdiction.gold_quantum_routes)
[0m00:19:53.744553 [debug] [Thread-4 (]: Began compiling node model.sc_interdiction.gold_quantum_routes
[0m00:19:53.749563 [debug] [Thread-4 (]: Writing injected SQL for node "model.sc_interdiction.gold_quantum_routes"
[0m00:19:53.751022 [debug] [Thread-4 (]: Timing info for model.sc_interdiction.gold_quantum_routes (compile): 00:19:53.744800 => 00:19:53.750625
[0m00:19:53.758455 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m00:19:53.760764 [debug] [Thread-4 (]: Began executing node model.sc_interdiction.gold_quantum_routes
[0m00:19:53.763468 [debug] [Thread-1 (]: On model.sc_interdiction.silver_shops: COMMIT
[0m00:19:53.772445 [debug] [Thread-4 (]: Writing runtime sql for node "model.sc_interdiction.gold_quantum_routes"
[0m00:19:53.773367 [debug] [Thread-1 (]: Using postgres connection "model.sc_interdiction.silver_shops"
[0m00:19:53.774074 [debug] [Thread-1 (]: On model.sc_interdiction.silver_shops: COMMIT
[0m00:19:53.774782 [debug] [Thread-4 (]: Using postgres connection "model.sc_interdiction.gold_quantum_routes"
[0m00:19:53.775222 [debug] [Thread-4 (]: On model.sc_interdiction.gold_quantum_routes: BEGIN
[0m00:19:53.775729 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:19:53.779060 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m00:19:53.783911 [debug] [Thread-1 (]: Applying DROP to: "sc_interdiction"."raw_silver"."silver_shops__dbt_backup"
[0m00:19:53.785536 [debug] [Thread-1 (]: Using postgres connection "model.sc_interdiction.silver_shops"
[0m00:19:53.786231 [debug] [Thread-1 (]: On model.sc_interdiction.silver_shops: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "node_id": "model.sc_interdiction.silver_shops"} */
drop table if exists "sc_interdiction"."raw_silver"."silver_shops__dbt_backup" cascade
[0m00:19:53.787184 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m00:19:53.789414 [debug] [Thread-1 (]: Timing info for model.sc_interdiction.silver_shops (execute): 00:19:53.580839 => 00:19:53.789201
[0m00:19:53.789824 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m00:19:53.791988 [debug] [Thread-1 (]: On model.sc_interdiction.silver_shops: Close
[0m00:19:53.792700 [debug] [Thread-4 (]: Using postgres connection "model.sc_interdiction.gold_quantum_routes"
[0m00:19:53.793379 [debug] [Thread-4 (]: On model.sc_interdiction.gold_quantum_routes: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "node_id": "model.sc_interdiction.gold_quantum_routes"} */

  create view "sc_interdiction"."raw_gold"."gold_quantum_routes__dbt_tmp"
    
    
  as (
    -- Gold quantum routes: denormalized view with location names

select
    r.id,
    r.from_location,
    f.name as from_name,
    f.display_name as from_display_name,
    f.location_type as from_type,
    r.to_location,
    t.name as to_name,
    t.display_name as to_display_name,
    t.location_type as to_type,
    r.distance
from "sc_interdiction"."raw_silver"."silver_quantum_routes" r
left join "sc_interdiction"."raw_silver"."silver_locations" f on r.from_location = f.id
left join "sc_interdiction"."raw_silver"."silver_locations" t on r.to_location = t.id
  );
[0m00:19:53.797643 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f3ce18c-ca82-432c-9a90-2da7980b6c0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcb9f9f850>]}
[0m00:19:53.798652 [info ] [Thread-1 (]: 8 of 12 OK created sql table model raw_silver.silver_shops ..................... [[32mSELECT 108[0m in 0.25s]
[0m00:19:53.799582 [debug] [Thread-1 (]: Finished running node model.sc_interdiction.silver_shops
[0m00:19:53.801454 [debug] [Thread-3 (]: Began running node model.sc_interdiction.gold_shops
[0m00:19:53.802133 [debug] [Thread-2 (]: Began running node model.sc_interdiction.silver_shop_items
[0m00:19:53.802814 [info ] [Thread-3 (]: 10 of 12 START sql view model raw_gold.gold_shops .............................. [RUN]
[0m00:19:53.803544 [info ] [Thread-2 (]: 11 of 12 START sql table model raw_silver.silver_shop_items .................... [RUN]
[0m00:19:53.804580 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.sc_interdiction.gold_locations, now model.sc_interdiction.gold_shops)
[0m00:19:53.805459 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.sc_interdiction.silver_quantum_routes, now model.sc_interdiction.silver_shop_items)
[0m00:19:53.806006 [debug] [Thread-3 (]: Began compiling node model.sc_interdiction.gold_shops
[0m00:19:53.806538 [debug] [Thread-2 (]: Began compiling node model.sc_interdiction.silver_shop_items
[0m00:19:53.811385 [debug] [Thread-3 (]: Writing injected SQL for node "model.sc_interdiction.gold_shops"
[0m00:19:53.812113 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m00:19:53.817796 [debug] [Thread-2 (]: Writing injected SQL for node "model.sc_interdiction.silver_shop_items"
[0m00:19:53.823333 [debug] [Thread-4 (]: Using postgres connection "model.sc_interdiction.gold_quantum_routes"
[0m00:19:53.824531 [debug] [Thread-3 (]: Timing info for model.sc_interdiction.gold_shops (compile): 00:19:53.806849 => 00:19:53.824177
[0m00:19:53.825107 [debug] [Thread-4 (]: On model.sc_interdiction.gold_quantum_routes: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "node_id": "model.sc_interdiction.gold_quantum_routes"} */
alter table "sc_interdiction"."raw_gold"."gold_quantum_routes__dbt_tmp" rename to "gold_quantum_routes"
[0m00:19:53.825735 [debug] [Thread-2 (]: Timing info for model.sc_interdiction.silver_shop_items (compile): 00:19:53.812386 => 00:19:53.825441
[0m00:19:53.826344 [debug] [Thread-3 (]: Began executing node model.sc_interdiction.gold_shops
[0m00:19:53.828324 [debug] [Thread-2 (]: Began executing node model.sc_interdiction.silver_shop_items
[0m00:19:53.828988 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:19:53.836094 [debug] [Thread-3 (]: Writing runtime sql for node "model.sc_interdiction.gold_shops"
[0m00:19:53.843942 [debug] [Thread-2 (]: Writing runtime sql for node "model.sc_interdiction.silver_shop_items"
[0m00:19:53.846873 [debug] [Thread-4 (]: On model.sc_interdiction.gold_quantum_routes: COMMIT
[0m00:19:53.848246 [debug] [Thread-3 (]: Using postgres connection "model.sc_interdiction.gold_shops"
[0m00:19:53.848755 [debug] [Thread-4 (]: Using postgres connection "model.sc_interdiction.gold_quantum_routes"
[0m00:19:53.849239 [debug] [Thread-2 (]: Using postgres connection "model.sc_interdiction.silver_shop_items"
[0m00:19:53.849726 [debug] [Thread-3 (]: On model.sc_interdiction.gold_shops: BEGIN
[0m00:19:53.850216 [debug] [Thread-4 (]: On model.sc_interdiction.gold_quantum_routes: COMMIT
[0m00:19:53.850757 [debug] [Thread-2 (]: On model.sc_interdiction.silver_shop_items: BEGIN
[0m00:19:53.851264 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:19:53.851988 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:19:53.858539 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m00:19:53.859272 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m00:19:53.859936 [debug] [Thread-2 (]: Using postgres connection "model.sc_interdiction.silver_shop_items"
[0m00:19:53.860528 [debug] [Thread-3 (]: Using postgres connection "model.sc_interdiction.gold_shops"
[0m00:19:53.861072 [debug] [Thread-2 (]: On model.sc_interdiction.silver_shop_items: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "node_id": "model.sc_interdiction.silver_shop_items"} */

  
    

  create  table "sc_interdiction"."raw_silver"."silver_shop_items__dbt_tmp"
  
  
    as
  
  (
    -- Silver shop items: validated with foreign key to shops



select
    si.id,
    si.shop_id,
    si.item_id,
    si.buy_price,
    si.sell_price,
    si.max_inventory,
    si.created_at,
    si.updated_at
from "sc_interdiction"."raw_staging"."stg_shop_items" si
where si.shop_id in (select shop_id from "sc_interdiction"."raw_silver"."silver_shops")
  );
  
[0m00:19:53.861602 [debug] [Thread-3 (]: On model.sc_interdiction.gold_shops: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "node_id": "model.sc_interdiction.gold_shops"} */

  create view "sc_interdiction"."raw_gold"."gold_shops__dbt_tmp"
    
    
  as (
    -- Gold shops: denormalized view with location info

select
    s.shop_id,
    s.location_id,
    l.name as location_name,
    l.display_name as location_display_name,
    l.location_type,
    s.shop_name
from "sc_interdiction"."raw_silver"."silver_shops" s
left join "sc_interdiction"."raw_silver"."silver_locations" l on s.location_id = l.id
  );
[0m00:19:53.865511 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m00:19:53.866311 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m00:19:53.878484 [debug] [Thread-3 (]: Using postgres connection "model.sc_interdiction.gold_shops"
[0m00:19:53.882717 [debug] [Thread-4 (]: Applying DROP to: "sc_interdiction"."raw_gold"."gold_quantum_routes__dbt_backup"
[0m00:19:53.883764 [debug] [Thread-3 (]: On model.sc_interdiction.gold_shops: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "node_id": "model.sc_interdiction.gold_shops"} */
alter table "sc_interdiction"."raw_gold"."gold_shops__dbt_tmp" rename to "gold_shops"
[0m00:19:53.886081 [debug] [Thread-4 (]: Using postgres connection "model.sc_interdiction.gold_quantum_routes"
[0m00:19:53.887124 [debug] [Thread-4 (]: On model.sc_interdiction.gold_quantum_routes: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "node_id": "model.sc_interdiction.gold_quantum_routes"} */
drop view if exists "sc_interdiction"."raw_gold"."gold_quantum_routes__dbt_backup" cascade
[0m00:19:53.888183 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.0 seconds
[0m00:19:53.888742 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:19:53.891359 [debug] [Thread-4 (]: Timing info for model.sc_interdiction.gold_quantum_routes (execute): 00:19:53.763985 => 00:19:53.891005
[0m00:19:53.894263 [debug] [Thread-3 (]: On model.sc_interdiction.gold_shops: COMMIT
[0m00:19:53.895161 [debug] [Thread-4 (]: On model.sc_interdiction.gold_quantum_routes: Close
[0m00:19:53.895875 [debug] [Thread-3 (]: Using postgres connection "model.sc_interdiction.gold_shops"
[0m00:19:53.897912 [debug] [Thread-3 (]: On model.sc_interdiction.gold_shops: COMMIT
[0m00:19:53.902080 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f3ce18c-ca82-432c-9a90-2da7980b6c0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcba17ce50>]}
[0m00:19:53.903495 [info ] [Thread-4 (]: 9 of 12 OK created sql view model raw_gold.gold_quantum_routes ................. [[32mCREATE VIEW[0m in 0.16s]
[0m00:19:53.904449 [debug] [Thread-4 (]: Finished running node model.sc_interdiction.gold_quantum_routes
[0m00:19:53.905037 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m00:19:53.909312 [debug] [Thread-3 (]: Applying DROP to: "sc_interdiction"."raw_gold"."gold_shops__dbt_backup"
[0m00:19:53.910617 [debug] [Thread-3 (]: Using postgres connection "model.sc_interdiction.gold_shops"
[0m00:19:53.911177 [debug] [Thread-3 (]: On model.sc_interdiction.gold_shops: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "node_id": "model.sc_interdiction.gold_shops"} */
drop view if exists "sc_interdiction"."raw_gold"."gold_shops__dbt_backup" cascade
[0m00:19:53.912143 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m00:19:53.921549 [debug] [Thread-3 (]: Timing info for model.sc_interdiction.gold_shops (execute): 00:19:53.829388 => 00:19:53.921208
[0m00:19:53.922203 [debug] [Thread-3 (]: On model.sc_interdiction.gold_shops: Close
[0m00:19:53.923492 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f3ce18c-ca82-432c-9a90-2da7980b6c0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcb9f7a050>]}
[0m00:19:53.924349 [info ] [Thread-3 (]: 10 of 12 OK created sql view model raw_gold.gold_shops ......................... [[32mCREATE VIEW[0m in 0.12s]
[0m00:19:53.925212 [debug] [Thread-3 (]: Finished running node model.sc_interdiction.gold_shops
[0m00:19:53.995515 [debug] [Thread-2 (]: SQL status: SELECT 12148 in 0.0 seconds
[0m00:19:54.000684 [debug] [Thread-2 (]: Using postgres connection "model.sc_interdiction.silver_shop_items"
[0m00:19:54.001735 [debug] [Thread-2 (]: On model.sc_interdiction.silver_shop_items: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "node_id": "model.sc_interdiction.silver_shop_items"} */
alter table "sc_interdiction"."raw_silver"."silver_shop_items__dbt_tmp" rename to "silver_shop_items"
[0m00:19:54.007478 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:19:54.012226 [debug] [Thread-2 (]: Using postgres connection "model.sc_interdiction.silver_shop_items"
[0m00:19:54.012990 [debug] [Thread-2 (]: On model.sc_interdiction.silver_shop_items: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "node_id": "model.sc_interdiction.silver_shop_items"} */

    create  index if not exists
  "fe2ddf5caebadf367428a5f5e1c3cef0"
  on "sc_interdiction"."raw_silver"."silver_shop_items" 
  (shop_id);
  
[0m00:19:54.033146 [debug] [Thread-2 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m00:19:54.036392 [debug] [Thread-2 (]: Using postgres connection "model.sc_interdiction.silver_shop_items"
[0m00:19:54.037193 [debug] [Thread-2 (]: On model.sc_interdiction.silver_shop_items: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "node_id": "model.sc_interdiction.silver_shop_items"} */

    create  index if not exists
  "46fb5d6678725be50c7c51889e633f77"
  on "sc_interdiction"."raw_silver"."silver_shop_items" 
  (item_id);
  
[0m00:19:54.124183 [debug] [Thread-2 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m00:19:54.127564 [debug] [Thread-2 (]: On model.sc_interdiction.silver_shop_items: COMMIT
[0m00:19:54.128356 [debug] [Thread-2 (]: Using postgres connection "model.sc_interdiction.silver_shop_items"
[0m00:19:54.128784 [debug] [Thread-2 (]: On model.sc_interdiction.silver_shop_items: COMMIT
[0m00:19:54.161584 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m00:19:54.166001 [debug] [Thread-2 (]: Applying DROP to: "sc_interdiction"."raw_silver"."silver_shop_items__dbt_backup"
[0m00:19:54.167260 [debug] [Thread-2 (]: Using postgres connection "model.sc_interdiction.silver_shop_items"
[0m00:19:54.167743 [debug] [Thread-2 (]: On model.sc_interdiction.silver_shop_items: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "node_id": "model.sc_interdiction.silver_shop_items"} */
drop table if exists "sc_interdiction"."raw_silver"."silver_shop_items__dbt_backup" cascade
[0m00:19:54.168858 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m00:19:54.177905 [debug] [Thread-2 (]: Timing info for model.sc_interdiction.silver_shop_items (execute): 00:19:53.836626 => 00:19:54.176606
[0m00:19:54.180401 [debug] [Thread-2 (]: On model.sc_interdiction.silver_shop_items: Close
[0m00:19:54.182457 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f3ce18c-ca82-432c-9a90-2da7980b6c0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcb9eb89a0>]}
[0m00:19:54.184229 [info ] [Thread-2 (]: 11 of 12 OK created sql table model raw_silver.silver_shop_items ............... [[32mSELECT 12148[0m in 0.38s]
[0m00:19:54.185441 [debug] [Thread-2 (]: Finished running node model.sc_interdiction.silver_shop_items
[0m00:19:54.187125 [debug] [Thread-1 (]: Began running node model.sc_interdiction.gold_shop_items
[0m00:19:54.188104 [info ] [Thread-1 (]: 12 of 12 START sql view model raw_gold.gold_shop_items ......................... [RUN]
[0m00:19:54.189563 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sc_interdiction.silver_shops, now model.sc_interdiction.gold_shop_items)
[0m00:19:54.190174 [debug] [Thread-1 (]: Began compiling node model.sc_interdiction.gold_shop_items
[0m00:19:54.205394 [debug] [Thread-1 (]: Writing injected SQL for node "model.sc_interdiction.gold_shop_items"
[0m00:19:54.206732 [debug] [Thread-1 (]: Timing info for model.sc_interdiction.gold_shop_items (compile): 00:19:54.190532 => 00:19:54.206359
[0m00:19:54.207216 [debug] [Thread-1 (]: Began executing node model.sc_interdiction.gold_shop_items
[0m00:19:54.226572 [debug] [Thread-1 (]: Writing runtime sql for node "model.sc_interdiction.gold_shop_items"
[0m00:19:54.235594 [debug] [Thread-1 (]: Using postgres connection "model.sc_interdiction.gold_shop_items"
[0m00:19:54.236599 [debug] [Thread-1 (]: On model.sc_interdiction.gold_shop_items: BEGIN
[0m00:19:54.237013 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:19:54.244987 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:19:54.250908 [debug] [Thread-1 (]: Using postgres connection "model.sc_interdiction.gold_shop_items"
[0m00:19:54.251662 [debug] [Thread-1 (]: On model.sc_interdiction.gold_shop_items: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "node_id": "model.sc_interdiction.gold_shop_items"} */

  create view "sc_interdiction"."raw_gold"."gold_shop_items__dbt_tmp"
    
    
  as (
    -- Gold shop items: denormalized view with shop and location info

select
    si.id,
    si.shop_id,
    s.shop_name,
    s.location_id,
    l.name as location_name,
    l.display_name as location_display_name,
    si.item_id,
    si.buy_price,
    si.sell_price,
    si.max_inventory,
    case
        when si.buy_price > 0 and si.sell_price > 0
        then round(((si.sell_price - si.buy_price) / si.buy_price * 100)::numeric, 2)
        else 0
    end as profit_margin_pct
from "sc_interdiction"."raw_silver"."silver_shop_items" si
join "sc_interdiction"."raw_silver"."silver_shops" s on si.shop_id = s.shop_id
left join "sc_interdiction"."raw_silver"."silver_locations" l on s.location_id = l.id
  );
[0m00:19:54.364547 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m00:19:54.370093 [debug] [Thread-1 (]: Using postgres connection "model.sc_interdiction.gold_shop_items"
[0m00:19:54.370935 [debug] [Thread-1 (]: On model.sc_interdiction.gold_shop_items: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "node_id": "model.sc_interdiction.gold_shop_items"} */
alter table "sc_interdiction"."raw_gold"."gold_shop_items__dbt_tmp" rename to "gold_shop_items"
[0m00:19:54.372444 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m00:19:54.375012 [debug] [Thread-1 (]: On model.sc_interdiction.gold_shop_items: COMMIT
[0m00:19:54.375709 [debug] [Thread-1 (]: Using postgres connection "model.sc_interdiction.gold_shop_items"
[0m00:19:54.376497 [debug] [Thread-1 (]: On model.sc_interdiction.gold_shop_items: COMMIT
[0m00:19:54.383228 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m00:19:54.390425 [debug] [Thread-1 (]: Applying DROP to: "sc_interdiction"."raw_gold"."gold_shop_items__dbt_backup"
[0m00:19:54.392022 [debug] [Thread-1 (]: Using postgres connection "model.sc_interdiction.gold_shop_items"
[0m00:19:54.392684 [debug] [Thread-1 (]: On model.sc_interdiction.gold_shop_items: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "node_id": "model.sc_interdiction.gold_shop_items"} */
drop view if exists "sc_interdiction"."raw_gold"."gold_shop_items__dbt_backup" cascade
[0m00:19:54.393880 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m00:19:54.404406 [debug] [Thread-1 (]: Timing info for model.sc_interdiction.gold_shop_items (execute): 00:19:54.207494 => 00:19:54.398320
[0m00:19:54.405222 [debug] [Thread-1 (]: On model.sc_interdiction.gold_shop_items: Close
[0m00:19:54.406796 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f3ce18c-ca82-432c-9a90-2da7980b6c0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcb85efd30>]}
[0m00:19:54.407849 [info ] [Thread-1 (]: 12 of 12 OK created sql view model raw_gold.gold_shop_items .................... [[32mCREATE VIEW[0m in 0.22s]
[0m00:19:54.408734 [debug] [Thread-1 (]: Finished running node model.sc_interdiction.gold_shop_items
[0m00:19:54.411380 [debug] [MainThread]: Using postgres connection "master"
[0m00:19:54.412041 [debug] [MainThread]: On master: BEGIN
[0m00:19:54.412569 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:19:54.419787 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:19:54.420432 [debug] [MainThread]: On master: COMMIT
[0m00:19:54.420784 [debug] [MainThread]: Using postgres connection "master"
[0m00:19:54.421077 [debug] [MainThread]: On master: COMMIT
[0m00:19:54.421800 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:19:54.422199 [debug] [MainThread]: On master: Close
[0m00:19:54.423152 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:19:54.423549 [debug] [MainThread]: Connection 'model.sc_interdiction.gold_shops' was properly closed.
[0m00:19:54.423810 [debug] [MainThread]: Connection 'model.sc_interdiction.silver_shop_items' was properly closed.
[0m00:19:54.424049 [debug] [MainThread]: Connection 'model.sc_interdiction.gold_shop_items' was properly closed.
[0m00:19:54.424380 [debug] [MainThread]: Connection 'model.sc_interdiction.gold_quantum_routes' was properly closed.
[0m00:19:54.424845 [info ] [MainThread]: 
[0m00:19:54.425245 [info ] [MainThread]: Finished running 8 view models, 4 table models in 0 hours 0 minutes and 4.20 seconds (4.20s).
[0m00:19:54.428169 [debug] [MainThread]: Command end result
[0m00:19:54.458714 [info ] [MainThread]: 
[0m00:19:54.459431 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:19:54.459913 [info ] [MainThread]: 
[0m00:19:54.460415 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 TOTAL=12
[0m00:19:54.461685 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.135266, "process_user_time": 6.434592, "process_kernel_time": 0.862572, "process_mem_max_rss": "114080", "process_out_blocks": "2936", "process_in_blocks": "0"}
[0m00:19:54.462295 [debug] [MainThread]: Command `dbt run` succeeded at 00:19:54.462158 after 5.14 seconds
[0m00:19:54.462722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcbdf2edd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcba45d5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcb85dbe50>]}
[0m00:19:54.463138 [debug] [MainThread]: Flushing usage events
[0m00:54:25.082973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaade3add0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaabb5e110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaabb5e0b0>]}


============================== 00:54:25.093054 | 616380ac-e5aa-48b8-adc0-8bb3758986db ==============================
[0m00:54:25.093054 [info ] [MainThread]: Running with dbt=1.7.0
[0m00:54:25.093641 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt test', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:54:25.468720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '616380ac-e5aa-48b8-adc0-8bb3758986db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaabba4760>]}
[0m00:54:25.665287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '616380ac-e5aa-48b8-adc0-8bb3758986db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaaa0f0d90>]}
[0m00:54:25.666562 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m00:54:25.686928 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m00:54:25.769217 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:54:25.778006 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:54:25.803270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '616380ac-e5aa-48b8-adc0-8bb3758986db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaa9f22890>]}
[0m00:54:25.849183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '616380ac-e5aa-48b8-adc0-8bb3758986db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaa9ee5450>]}
[0m00:54:25.860060 [info ] [MainThread]: Found 12 models, 2 seeds, 16 tests, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m00:54:25.861093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '616380ac-e5aa-48b8-adc0-8bb3758986db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaa9ee5660>]}
[0m00:54:25.865678 [info ] [MainThread]: 
[0m00:54:25.867085 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:54:25.870756 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sc_interdiction_raw_gold'
[0m00:54:25.872316 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sc_interdiction_raw_staging'
[0m00:54:25.879827 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sc_interdiction_raw_silver'
[0m00:54:25.902795 [debug] [ThreadPool]: Using postgres connection "list_sc_interdiction_raw_staging"
[0m00:54:25.903785 [debug] [ThreadPool]: Using postgres connection "list_sc_interdiction_raw_gold"
[0m00:54:25.909528 [debug] [ThreadPool]: Using postgres connection "list_sc_interdiction_raw_silver"
[0m00:54:25.910372 [debug] [ThreadPool]: On list_sc_interdiction_raw_staging: BEGIN
[0m00:54:25.910984 [debug] [ThreadPool]: On list_sc_interdiction_raw_gold: BEGIN
[0m00:54:25.911413 [debug] [ThreadPool]: On list_sc_interdiction_raw_silver: BEGIN
[0m00:54:25.911850 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:54:25.912242 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:54:25.912606 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:54:25.928409 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:54:25.929286 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:54:25.930188 [debug] [ThreadPool]: Using postgres connection "list_sc_interdiction_raw_gold"
[0m00:54:25.930658 [debug] [ThreadPool]: Using postgres connection "list_sc_interdiction_raw_silver"
[0m00:54:25.931127 [debug] [ThreadPool]: On list_sc_interdiction_raw_gold: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "connection_name": "list_sc_interdiction_raw_gold"} */
select
      'sc_interdiction' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw_gold'
    union all
    select
      'sc_interdiction' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw_gold'
    union all
    select
      'sc_interdiction' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw_gold'
  
[0m00:54:25.931629 [debug] [ThreadPool]: On list_sc_interdiction_raw_silver: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "connection_name": "list_sc_interdiction_raw_silver"} */
select
      'sc_interdiction' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw_silver'
    union all
    select
      'sc_interdiction' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw_silver'
    union all
    select
      'sc_interdiction' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw_silver'
  
[0m00:54:25.943823 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m00:54:25.944553 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m00:54:25.945082 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m00:54:25.945555 [debug] [ThreadPool]: Using postgres connection "list_sc_interdiction_raw_staging"
[0m00:54:25.947755 [debug] [ThreadPool]: On list_sc_interdiction_raw_gold: ROLLBACK
[0m00:54:25.949935 [debug] [ThreadPool]: On list_sc_interdiction_raw_silver: ROLLBACK
[0m00:54:25.950633 [debug] [ThreadPool]: On list_sc_interdiction_raw_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "connection_name": "list_sc_interdiction_raw_staging"} */
select
      'sc_interdiction' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw_staging'
    union all
    select
      'sc_interdiction' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw_staging'
    union all
    select
      'sc_interdiction' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw_staging'
  
[0m00:54:25.951554 [debug] [ThreadPool]: On list_sc_interdiction_raw_silver: Close
[0m00:54:25.952049 [debug] [ThreadPool]: On list_sc_interdiction_raw_gold: Close
[0m00:54:25.959533 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m00:54:25.961994 [debug] [ThreadPool]: On list_sc_interdiction_raw_staging: ROLLBACK
[0m00:54:25.962762 [debug] [ThreadPool]: On list_sc_interdiction_raw_staging: Close
[0m00:54:25.971334 [debug] [MainThread]: Using postgres connection "master"
[0m00:54:25.973345 [debug] [MainThread]: On master: BEGIN
[0m00:54:25.973663 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:54:25.979533 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:54:25.980080 [debug] [MainThread]: Using postgres connection "master"
[0m00:54:25.980614 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:54:26.005365 [debug] [MainThread]: SQL status: SELECT 20 in 0.0 seconds
[0m00:54:26.010277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '616380ac-e5aa-48b8-adc0-8bb3758986db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaa9ee55d0>]}
[0m00:54:26.011008 [debug] [MainThread]: On master: ROLLBACK
[0m00:54:26.011861 [debug] [MainThread]: Using postgres connection "master"
[0m00:54:26.012371 [debug] [MainThread]: On master: BEGIN
[0m00:54:26.013098 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:54:26.019745 [debug] [MainThread]: On master: COMMIT
[0m00:54:26.023581 [debug] [MainThread]: Using postgres connection "master"
[0m00:54:26.024221 [debug] [MainThread]: On master: COMMIT
[0m00:54:26.025201 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:54:26.025662 [debug] [MainThread]: On master: Close
[0m00:54:26.026940 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:54:26.027475 [info ] [MainThread]: 
[0m00:54:26.043194 [debug] [Thread-1 (]: Began running node test.sc_interdiction.not_null_silver_locations_id.dd487de48e
[0m00:54:26.044707 [debug] [Thread-2 (]: Began running node test.sc_interdiction.not_null_silver_quantum_routes_id.3de9291118
[0m00:54:26.046059 [debug] [Thread-3 (]: Began running node test.sc_interdiction.not_null_silver_shop_items_id.dfac39c7ec
[0m00:54:26.045373 [info ] [Thread-1 (]: 1 of 16 START test not_null_silver_locations_id ................................ [RUN]
[0m00:54:26.046864 [debug] [Thread-4 (]: Began running node test.sc_interdiction.not_null_silver_shops_shop_id.dce4685c37
[0m00:54:26.050487 [info ] [Thread-4 (]: 4 of 16 START test not_null_silver_shops_shop_id ............................... [RUN]
[0m00:54:26.048706 [info ] [Thread-3 (]: 3 of 16 START test not_null_silver_shop_items_id ............................... [RUN]
[0m00:54:26.049865 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sc_interdiction_raw_gold, now test.sc_interdiction.not_null_silver_locations_id.dd487de48e)
[0m00:54:26.052972 [debug] [Thread-1 (]: Began compiling node test.sc_interdiction.not_null_silver_locations_id.dd487de48e
[0m00:54:26.051622 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.sc_interdiction.not_null_silver_shops_shop_id.dce4685c37'
[0m00:54:26.052448 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_sc_interdiction_raw_staging, now test.sc_interdiction.not_null_silver_shop_items_id.dfac39c7ec)
[0m00:54:26.047997 [info ] [Thread-2 (]: 2 of 16 START test not_null_silver_quantum_routes_id ........................... [RUN]
[0m00:54:26.075257 [debug] [Thread-4 (]: Began compiling node test.sc_interdiction.not_null_silver_shops_shop_id.dce4685c37
[0m00:54:26.084180 [debug] [Thread-1 (]: Writing injected SQL for node "test.sc_interdiction.not_null_silver_locations_id.dd487de48e"
[0m00:54:26.085047 [debug] [Thread-3 (]: Began compiling node test.sc_interdiction.not_null_silver_shop_items_id.dfac39c7ec
[0m00:54:26.086135 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_sc_interdiction_raw_silver, now test.sc_interdiction.not_null_silver_quantum_routes_id.3de9291118)
[0m00:54:26.092920 [debug] [Thread-4 (]: Writing injected SQL for node "test.sc_interdiction.not_null_silver_shops_shop_id.dce4685c37"
[0m00:54:26.107716 [debug] [Thread-2 (]: Began compiling node test.sc_interdiction.not_null_silver_quantum_routes_id.3de9291118
[0m00:54:26.108655 [debug] [Thread-1 (]: Timing info for test.sc_interdiction.not_null_silver_locations_id.dd487de48e (compile): 00:54:26.053290 => 00:54:26.108346
[0m00:54:26.104641 [debug] [Thread-3 (]: Writing injected SQL for node "test.sc_interdiction.not_null_silver_shop_items_id.dfac39c7ec"
[0m00:54:26.115782 [debug] [Thread-2 (]: Writing injected SQL for node "test.sc_interdiction.not_null_silver_quantum_routes_id.3de9291118"
[0m00:54:26.116688 [debug] [Thread-4 (]: Timing info for test.sc_interdiction.not_null_silver_shops_shop_id.dce4685c37 (compile): 00:54:26.086595 => 00:54:26.116317
[0m00:54:26.117449 [debug] [Thread-1 (]: Began executing node test.sc_interdiction.not_null_silver_locations_id.dd487de48e
[0m00:54:26.118777 [debug] [Thread-4 (]: Began executing node test.sc_interdiction.not_null_silver_shops_shop_id.dce4685c37
[0m00:54:26.119569 [debug] [Thread-3 (]: Timing info for test.sc_interdiction.not_null_silver_shop_items_id.dfac39c7ec (compile): 00:54:26.093659 => 00:54:26.119221
[0m00:54:26.125953 [debug] [Thread-2 (]: Timing info for test.sc_interdiction.not_null_silver_quantum_routes_id.3de9291118 (compile): 00:54:26.109134 => 00:54:26.125336
[0m00:54:26.159750 [debug] [Thread-1 (]: Writing runtime sql for node "test.sc_interdiction.not_null_silver_locations_id.dd487de48e"
[0m00:54:26.171087 [debug] [Thread-4 (]: Writing runtime sql for node "test.sc_interdiction.not_null_silver_shops_shop_id.dce4685c37"
[0m00:54:26.171763 [debug] [Thread-3 (]: Began executing node test.sc_interdiction.not_null_silver_shop_items_id.dfac39c7ec
[0m00:54:26.172248 [debug] [Thread-2 (]: Began executing node test.sc_interdiction.not_null_silver_quantum_routes_id.3de9291118
[0m00:54:26.175663 [debug] [Thread-3 (]: Writing runtime sql for node "test.sc_interdiction.not_null_silver_shop_items_id.dfac39c7ec"
[0m00:54:26.179875 [debug] [Thread-2 (]: Writing runtime sql for node "test.sc_interdiction.not_null_silver_quantum_routes_id.3de9291118"
[0m00:54:26.181162 [debug] [Thread-1 (]: Using postgres connection "test.sc_interdiction.not_null_silver_locations_id.dd487de48e"
[0m00:54:26.181737 [debug] [Thread-4 (]: Using postgres connection "test.sc_interdiction.not_null_silver_shops_shop_id.dce4685c37"
[0m00:54:26.194492 [debug] [Thread-4 (]: On test.sc_interdiction.not_null_silver_shops_shop_id.dce4685c37: BEGIN
[0m00:54:26.189672 [debug] [Thread-2 (]: Using postgres connection "test.sc_interdiction.not_null_silver_quantum_routes_id.3de9291118"
[0m00:54:26.193913 [debug] [Thread-1 (]: On test.sc_interdiction.not_null_silver_locations_id.dd487de48e: BEGIN
[0m00:54:26.194942 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m00:54:26.195437 [debug] [Thread-2 (]: On test.sc_interdiction.not_null_silver_quantum_routes_id.3de9291118: BEGIN
[0m00:54:26.182677 [debug] [Thread-3 (]: Using postgres connection "test.sc_interdiction.not_null_silver_shop_items_id.dfac39c7ec"
[0m00:54:26.195929 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:54:26.196683 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:54:26.197289 [debug] [Thread-3 (]: On test.sc_interdiction.not_null_silver_shop_items_id.dfac39c7ec: BEGIN
[0m00:54:26.198691 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:54:26.205202 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m00:54:26.205894 [debug] [Thread-3 (]: Using postgres connection "test.sc_interdiction.not_null_silver_shop_items_id.dfac39c7ec"
[0m00:54:26.206429 [debug] [Thread-3 (]: On test.sc_interdiction.not_null_silver_shop_items_id.dfac39c7ec: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "node_id": "test.sc_interdiction.not_null_silver_shop_items_id.dfac39c7ec"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "sc_interdiction"."raw_silver"."silver_shop_items"
where id is null



      
    ) dbt_internal_test
[0m00:54:26.209471 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:54:26.210099 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m00:54:26.210580 [debug] [Thread-1 (]: Using postgres connection "test.sc_interdiction.not_null_silver_locations_id.dd487de48e"
[0m00:54:26.211068 [debug] [Thread-4 (]: Using postgres connection "test.sc_interdiction.not_null_silver_shops_shop_id.dce4685c37"
[0m00:54:26.211694 [debug] [Thread-1 (]: On test.sc_interdiction.not_null_silver_locations_id.dd487de48e: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "node_id": "test.sc_interdiction.not_null_silver_locations_id.dd487de48e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "sc_interdiction"."raw_silver"."silver_locations"
where id is null



      
    ) dbt_internal_test
[0m00:54:26.212436 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:54:26.212850 [debug] [Thread-4 (]: On test.sc_interdiction.not_null_silver_shops_shop_id.dce4685c37: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "node_id": "test.sc_interdiction.not_null_silver_shops_shop_id.dce4685c37"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select shop_id
from "sc_interdiction"."raw_silver"."silver_shops"
where shop_id is null



      
    ) dbt_internal_test
[0m00:54:26.213228 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m00:54:26.217189 [debug] [Thread-3 (]: Timing info for test.sc_interdiction.not_null_silver_shop_items_id.dfac39c7ec (execute): 00:54:26.172874 => 00:54:26.216663
[0m00:54:26.217802 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:54:26.218513 [debug] [Thread-2 (]: Using postgres connection "test.sc_interdiction.not_null_silver_quantum_routes_id.3de9291118"
[0m00:54:26.219138 [debug] [Thread-3 (]: On test.sc_interdiction.not_null_silver_shop_items_id.dfac39c7ec: ROLLBACK
[0m00:54:26.221486 [debug] [Thread-1 (]: Timing info for test.sc_interdiction.not_null_silver_locations_id.dd487de48e (execute): 00:54:26.120073 => 00:54:26.221088
[0m00:54:26.222120 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:54:26.222654 [debug] [Thread-2 (]: On test.sc_interdiction.not_null_silver_quantum_routes_id.3de9291118: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "node_id": "test.sc_interdiction.not_null_silver_quantum_routes_id.3de9291118"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "sc_interdiction"."raw_silver"."silver_quantum_routes"
where id is null



      
    ) dbt_internal_test
[0m00:54:26.223227 [debug] [Thread-1 (]: On test.sc_interdiction.not_null_silver_locations_id.dd487de48e: ROLLBACK
[0m00:54:26.224849 [debug] [Thread-4 (]: Timing info for test.sc_interdiction.not_null_silver_shops_shop_id.dce4685c37 (execute): 00:54:26.143295 => 00:54:26.224625
[0m00:54:26.225194 [debug] [Thread-3 (]: On test.sc_interdiction.not_null_silver_shop_items_id.dfac39c7ec: Close
[0m00:54:26.225974 [debug] [Thread-4 (]: On test.sc_interdiction.not_null_silver_shops_shop_id.dce4685c37: ROLLBACK
[0m00:54:26.226420 [debug] [Thread-1 (]: On test.sc_interdiction.not_null_silver_locations_id.dd487de48e: Close
[0m00:54:26.227736 [info ] [Thread-3 (]: 3 of 16 PASS not_null_silver_shop_items_id ..................................... [[32mPASS[0m in 0.18s]
[0m00:54:26.228313 [debug] [Thread-4 (]: On test.sc_interdiction.not_null_silver_shops_shop_id.dce4685c37: Close
[0m00:54:26.228894 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:54:26.229782 [debug] [Thread-3 (]: Finished running node test.sc_interdiction.not_null_silver_shop_items_id.dfac39c7ec
[0m00:54:26.230761 [info ] [Thread-1 (]: 1 of 16 PASS not_null_silver_locations_id ...................................... [[32mPASS[0m in 0.18s]
[0m00:54:26.233232 [debug] [Thread-2 (]: Timing info for test.sc_interdiction.not_null_silver_quantum_routes_id.3de9291118 (execute): 00:54:26.176488 => 00:54:26.232780
[0m00:54:26.234410 [info ] [Thread-4 (]: 4 of 16 PASS not_null_silver_shops_shop_id ..................................... [[32mPASS[0m in 0.18s]
[0m00:54:26.235216 [debug] [Thread-3 (]: Began running node test.sc_interdiction.not_null_stg_locations_id.2a96656a12
[0m00:54:26.236504 [debug] [Thread-1 (]: Finished running node test.sc_interdiction.not_null_silver_locations_id.dd487de48e
[0m00:54:26.237262 [debug] [Thread-2 (]: On test.sc_interdiction.not_null_silver_quantum_routes_id.3de9291118: ROLLBACK
[0m00:54:26.238025 [debug] [Thread-4 (]: Finished running node test.sc_interdiction.not_null_silver_shops_shop_id.dce4685c37
[0m00:54:26.239134 [debug] [Thread-1 (]: Began running node test.sc_interdiction.not_null_stg_quantum_routes_id.2bf46db599
[0m00:54:26.238572 [info ] [Thread-3 (]: 5 of 16 START test not_null_stg_locations_id ................................... [RUN]
[0m00:54:26.240073 [debug] [Thread-4 (]: Began running node test.sc_interdiction.not_null_stg_shop_items_id.6a355133eb
[0m00:54:26.240608 [debug] [Thread-2 (]: On test.sc_interdiction.not_null_silver_quantum_routes_id.3de9291118: Close
[0m00:54:26.241146 [info ] [Thread-1 (]: 6 of 16 START test not_null_stg_quantum_routes_id .............................. [RUN]
[0m00:54:26.242212 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.sc_interdiction.not_null_silver_shop_items_id.dfac39c7ec, now test.sc_interdiction.not_null_stg_locations_id.2a96656a12)
[0m00:54:26.242873 [info ] [Thread-4 (]: 7 of 16 START test not_null_stg_shop_items_id .................................. [RUN]
[0m00:54:26.243822 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sc_interdiction.not_null_silver_locations_id.dd487de48e, now test.sc_interdiction.not_null_stg_quantum_routes_id.2bf46db599)
[0m00:54:26.244845 [info ] [Thread-2 (]: 2 of 16 PASS not_null_silver_quantum_routes_id ................................. [[32mPASS[0m in 0.16s]
[0m00:54:26.245565 [debug] [Thread-3 (]: Began compiling node test.sc_interdiction.not_null_stg_locations_id.2a96656a12
[0m00:54:26.246544 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.sc_interdiction.not_null_silver_shops_shop_id.dce4685c37, now test.sc_interdiction.not_null_stg_shop_items_id.6a355133eb)
[0m00:54:26.247170 [debug] [Thread-1 (]: Began compiling node test.sc_interdiction.not_null_stg_quantum_routes_id.2bf46db599
[0m00:54:26.248054 [debug] [Thread-2 (]: Finished running node test.sc_interdiction.not_null_silver_quantum_routes_id.3de9291118
[0m00:54:26.256579 [debug] [Thread-3 (]: Writing injected SQL for node "test.sc_interdiction.not_null_stg_locations_id.2a96656a12"
[0m00:54:26.257374 [debug] [Thread-4 (]: Began compiling node test.sc_interdiction.not_null_stg_shop_items_id.6a355133eb
[0m00:54:26.262222 [debug] [Thread-1 (]: Writing injected SQL for node "test.sc_interdiction.not_null_stg_quantum_routes_id.2bf46db599"
[0m00:54:26.262908 [debug] [Thread-2 (]: Began running node test.sc_interdiction.not_null_stg_shops_shop_id.57fba4b2db
[0m00:54:26.269803 [debug] [Thread-4 (]: Writing injected SQL for node "test.sc_interdiction.not_null_stg_shop_items_id.6a355133eb"
[0m00:54:26.271074 [debug] [Thread-3 (]: Timing info for test.sc_interdiction.not_null_stg_locations_id.2a96656a12 (compile): 00:54:26.248414 => 00:54:26.270701
[0m00:54:26.271798 [info ] [Thread-2 (]: 8 of 16 START test not_null_stg_shops_shop_id .................................. [RUN]
[0m00:54:26.273013 [debug] [Thread-1 (]: Timing info for test.sc_interdiction.not_null_stg_quantum_routes_id.2bf46db599 (compile): 00:54:26.257826 => 00:54:26.272709
[0m00:54:26.273550 [debug] [Thread-3 (]: Began executing node test.sc_interdiction.not_null_stg_locations_id.2a96656a12
[0m00:54:26.274054 [debug] [Thread-4 (]: Timing info for test.sc_interdiction.not_null_stg_shop_items_id.6a355133eb (compile): 00:54:26.263560 => 00:54:26.273797
[0m00:54:26.274857 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.sc_interdiction.not_null_silver_quantum_routes_id.3de9291118, now test.sc_interdiction.not_null_stg_shops_shop_id.57fba4b2db)
[0m00:54:26.275359 [debug] [Thread-1 (]: Began executing node test.sc_interdiction.not_null_stg_quantum_routes_id.2bf46db599
[0m00:54:26.280906 [debug] [Thread-3 (]: Writing runtime sql for node "test.sc_interdiction.not_null_stg_locations_id.2a96656a12"
[0m00:54:26.281791 [debug] [Thread-4 (]: Began executing node test.sc_interdiction.not_null_stg_shop_items_id.6a355133eb
[0m00:54:26.282329 [debug] [Thread-2 (]: Began compiling node test.sc_interdiction.not_null_stg_shops_shop_id.57fba4b2db
[0m00:54:26.391347 [debug] [Thread-1 (]: Writing runtime sql for node "test.sc_interdiction.not_null_stg_quantum_routes_id.2bf46db599"
[0m00:54:26.394526 [debug] [Thread-4 (]: Writing runtime sql for node "test.sc_interdiction.not_null_stg_shop_items_id.6a355133eb"
[0m00:54:26.400756 [debug] [Thread-2 (]: Writing injected SQL for node "test.sc_interdiction.not_null_stg_shops_shop_id.57fba4b2db"
[0m00:54:26.401575 [debug] [Thread-3 (]: Using postgres connection "test.sc_interdiction.not_null_stg_locations_id.2a96656a12"
[0m00:54:26.402845 [debug] [Thread-1 (]: Using postgres connection "test.sc_interdiction.not_null_stg_quantum_routes_id.2bf46db599"
[0m00:54:26.403435 [debug] [Thread-4 (]: Using postgres connection "test.sc_interdiction.not_null_stg_shop_items_id.6a355133eb"
[0m00:54:26.404109 [debug] [Thread-3 (]: On test.sc_interdiction.not_null_stg_locations_id.2a96656a12: BEGIN
[0m00:54:26.404764 [debug] [Thread-1 (]: On test.sc_interdiction.not_null_stg_quantum_routes_id.2bf46db599: BEGIN
[0m00:54:26.405332 [debug] [Thread-2 (]: Timing info for test.sc_interdiction.not_null_stg_shops_shop_id.57fba4b2db (compile): 00:54:26.395020 => 00:54:26.405085
[0m00:54:26.405766 [debug] [Thread-4 (]: On test.sc_interdiction.not_null_stg_shop_items_id.6a355133eb: BEGIN
[0m00:54:26.406425 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:54:26.406936 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:54:26.407532 [debug] [Thread-2 (]: Began executing node test.sc_interdiction.not_null_stg_shops_shop_id.57fba4b2db
[0m00:54:26.408075 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:54:26.412467 [debug] [Thread-2 (]: Writing runtime sql for node "test.sc_interdiction.not_null_stg_shops_shop_id.57fba4b2db"
[0m00:54:26.413733 [debug] [Thread-2 (]: Using postgres connection "test.sc_interdiction.not_null_stg_shops_shop_id.57fba4b2db"
[0m00:54:26.414211 [debug] [Thread-2 (]: On test.sc_interdiction.not_null_stg_shops_shop_id.57fba4b2db: BEGIN
[0m00:54:26.414609 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:54:26.415996 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:54:26.416591 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m00:54:26.417071 [debug] [Thread-1 (]: Using postgres connection "test.sc_interdiction.not_null_stg_quantum_routes_id.2bf46db599"
[0m00:54:26.417535 [debug] [Thread-3 (]: Using postgres connection "test.sc_interdiction.not_null_stg_locations_id.2a96656a12"
[0m00:54:26.418348 [debug] [Thread-1 (]: On test.sc_interdiction.not_null_stg_quantum_routes_id.2bf46db599: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "node_id": "test.sc_interdiction.not_null_stg_quantum_routes_id.2bf46db599"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "sc_interdiction"."raw_staging"."stg_quantum_routes"
where id is null



      
    ) dbt_internal_test
[0m00:54:26.419020 [debug] [Thread-3 (]: On test.sc_interdiction.not_null_stg_locations_id.2a96656a12: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "node_id": "test.sc_interdiction.not_null_stg_locations_id.2a96656a12"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "sc_interdiction"."raw_staging"."stg_locations"
where id is null



      
    ) dbt_internal_test
[0m00:54:26.420022 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m00:54:26.420491 [debug] [Thread-4 (]: Using postgres connection "test.sc_interdiction.not_null_stg_shop_items_id.6a355133eb"
[0m00:54:26.420951 [debug] [Thread-4 (]: On test.sc_interdiction.not_null_stg_shop_items_id.6a355133eb: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "node_id": "test.sc_interdiction.not_null_stg_shop_items_id.6a355133eb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "sc_interdiction"."raw_staging"."stg_shop_items"
where id is null



      
    ) dbt_internal_test
[0m00:54:26.423455 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:54:26.424324 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:54:26.426513 [debug] [Thread-3 (]: Timing info for test.sc_interdiction.not_null_stg_locations_id.2a96656a12 (execute): 00:54:26.275682 => 00:54:26.426115
[0m00:54:26.427126 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m00:54:26.429224 [debug] [Thread-1 (]: Timing info for test.sc_interdiction.not_null_stg_quantum_routes_id.2bf46db599 (execute): 00:54:26.282707 => 00:54:26.428895
[0m00:54:26.429783 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:54:26.430402 [debug] [Thread-3 (]: On test.sc_interdiction.not_null_stg_locations_id.2a96656a12: ROLLBACK
[0m00:54:26.430978 [debug] [Thread-2 (]: Using postgres connection "test.sc_interdiction.not_null_stg_shops_shop_id.57fba4b2db"
[0m00:54:26.431553 [debug] [Thread-1 (]: On test.sc_interdiction.not_null_stg_quantum_routes_id.2bf46db599: ROLLBACK
[0m00:54:26.435333 [debug] [Thread-4 (]: Timing info for test.sc_interdiction.not_null_stg_shop_items_id.6a355133eb (execute): 00:54:26.392106 => 00:54:26.434841
[0m00:54:26.436195 [debug] [Thread-2 (]: On test.sc_interdiction.not_null_stg_shops_shop_id.57fba4b2db: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "node_id": "test.sc_interdiction.not_null_stg_shops_shop_id.57fba4b2db"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select shop_id
from "sc_interdiction"."raw_staging"."stg_shops"
where shop_id is null



      
    ) dbt_internal_test
[0m00:54:26.436915 [debug] [Thread-3 (]: On test.sc_interdiction.not_null_stg_locations_id.2a96656a12: Close
[0m00:54:26.437514 [debug] [Thread-4 (]: On test.sc_interdiction.not_null_stg_shop_items_id.6a355133eb: ROLLBACK
[0m00:54:26.437905 [debug] [Thread-1 (]: On test.sc_interdiction.not_null_stg_quantum_routes_id.2bf46db599: Close
[0m00:54:26.440002 [debug] [Thread-4 (]: On test.sc_interdiction.not_null_stg_shop_items_id.6a355133eb: Close
[0m00:54:26.439524 [info ] [Thread-3 (]: 5 of 16 PASS not_null_stg_locations_id ......................................... [[32mPASS[0m in 0.20s]
[0m00:54:26.441228 [info ] [Thread-1 (]: 6 of 16 PASS not_null_stg_quantum_routes_id .................................... [[32mPASS[0m in 0.20s]
[0m00:54:26.441968 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:54:26.442723 [debug] [Thread-3 (]: Finished running node test.sc_interdiction.not_null_stg_locations_id.2a96656a12
[0m00:54:26.443760 [info ] [Thread-4 (]: 7 of 16 PASS not_null_stg_shop_items_id ........................................ [[32mPASS[0m in 0.20s]
[0m00:54:26.444680 [debug] [Thread-1 (]: Finished running node test.sc_interdiction.not_null_stg_quantum_routes_id.2bf46db599
[0m00:54:26.446844 [debug] [Thread-2 (]: Timing info for test.sc_interdiction.not_null_stg_shops_shop_id.57fba4b2db (execute): 00:54:26.408788 => 00:54:26.446431
[0m00:54:26.447669 [debug] [Thread-3 (]: Began running node test.sc_interdiction.unique_silver_locations_id.0592204245
[0m00:54:26.448658 [debug] [Thread-4 (]: Finished running node test.sc_interdiction.not_null_stg_shop_items_id.6a355133eb
[0m00:54:26.449356 [debug] [Thread-1 (]: Began running node test.sc_interdiction.unique_silver_quantum_routes_id.0c7a40ff16
[0m00:54:26.450072 [debug] [Thread-2 (]: On test.sc_interdiction.not_null_stg_shops_shop_id.57fba4b2db: ROLLBACK
[0m00:54:26.450585 [info ] [Thread-3 (]: 9 of 16 START test unique_silver_locations_id .................................. [RUN]
[0m00:54:26.451311 [debug] [Thread-4 (]: Began running node test.sc_interdiction.unique_silver_shop_items_id.b5452d9546
[0m00:54:26.451883 [info ] [Thread-1 (]: 10 of 16 START test unique_silver_quantum_routes_id ............................ [RUN]
[0m00:54:26.453058 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.sc_interdiction.not_null_stg_locations_id.2a96656a12, now test.sc_interdiction.unique_silver_locations_id.0592204245)
[0m00:54:26.453505 [debug] [Thread-2 (]: On test.sc_interdiction.not_null_stg_shops_shop_id.57fba4b2db: Close
[0m00:54:26.453990 [info ] [Thread-4 (]: 11 of 16 START test unique_silver_shop_items_id ................................ [RUN]
[0m00:54:26.455012 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sc_interdiction.not_null_stg_quantum_routes_id.2bf46db599, now test.sc_interdiction.unique_silver_quantum_routes_id.0c7a40ff16)
[0m00:54:26.455539 [debug] [Thread-3 (]: Began compiling node test.sc_interdiction.unique_silver_locations_id.0592204245
[0m00:54:26.456444 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.sc_interdiction.not_null_stg_shop_items_id.6a355133eb, now test.sc_interdiction.unique_silver_shop_items_id.b5452d9546)
[0m00:54:26.457974 [debug] [Thread-1 (]: Began compiling node test.sc_interdiction.unique_silver_quantum_routes_id.0c7a40ff16
[0m00:54:26.457570 [info ] [Thread-2 (]: 8 of 16 PASS not_null_stg_shops_shop_id ........................................ [[32mPASS[0m in 0.18s]
[0m00:54:26.469714 [debug] [Thread-3 (]: Writing injected SQL for node "test.sc_interdiction.unique_silver_locations_id.0592204245"
[0m00:54:26.470504 [debug] [Thread-4 (]: Began compiling node test.sc_interdiction.unique_silver_shop_items_id.b5452d9546
[0m00:54:26.476885 [debug] [Thread-2 (]: Finished running node test.sc_interdiction.not_null_stg_shops_shop_id.57fba4b2db
[0m00:54:26.484988 [debug] [Thread-4 (]: Writing injected SQL for node "test.sc_interdiction.unique_silver_shop_items_id.b5452d9546"
[0m00:54:26.485810 [debug] [Thread-2 (]: Began running node test.sc_interdiction.unique_silver_shops_shop_id.0b274c977f
[0m00:54:26.487394 [debug] [Thread-1 (]: Writing injected SQL for node "test.sc_interdiction.unique_silver_quantum_routes_id.0c7a40ff16"
[0m00:54:26.487973 [debug] [Thread-3 (]: Timing info for test.sc_interdiction.unique_silver_locations_id.0592204245 (compile): 00:54:26.458430 => 00:54:26.487707
[0m00:54:26.488633 [info ] [Thread-2 (]: 12 of 16 START test unique_silver_shops_shop_id ................................ [RUN]
[0m00:54:26.489618 [debug] [Thread-3 (]: Began executing node test.sc_interdiction.unique_silver_locations_id.0592204245
[0m00:54:26.490139 [debug] [Thread-4 (]: Timing info for test.sc_interdiction.unique_silver_shop_items_id.b5452d9546 (compile): 00:54:26.477558 => 00:54:26.489918
[0m00:54:26.490959 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.sc_interdiction.not_null_stg_shops_shop_id.57fba4b2db, now test.sc_interdiction.unique_silver_shops_shop_id.0b274c977f)
[0m00:54:26.498964 [debug] [Thread-2 (]: Began compiling node test.sc_interdiction.unique_silver_shops_shop_id.0b274c977f
[0m00:54:26.497443 [debug] [Thread-3 (]: Writing runtime sql for node "test.sc_interdiction.unique_silver_locations_id.0592204245"
[0m00:54:26.498331 [debug] [Thread-4 (]: Began executing node test.sc_interdiction.unique_silver_shop_items_id.b5452d9546
[0m00:54:26.491512 [debug] [Thread-1 (]: Timing info for test.sc_interdiction.unique_silver_quantum_routes_id.0c7a40ff16 (compile): 00:54:26.470894 => 00:54:26.491239
[0m00:54:26.505575 [debug] [Thread-2 (]: Writing injected SQL for node "test.sc_interdiction.unique_silver_shops_shop_id.0b274c977f"
[0m00:54:26.509971 [debug] [Thread-4 (]: Writing runtime sql for node "test.sc_interdiction.unique_silver_shop_items_id.b5452d9546"
[0m00:54:26.510885 [debug] [Thread-1 (]: Began executing node test.sc_interdiction.unique_silver_quantum_routes_id.0c7a40ff16
[0m00:54:26.511342 [debug] [Thread-3 (]: Using postgres connection "test.sc_interdiction.unique_silver_locations_id.0592204245"
[0m00:54:26.512496 [debug] [Thread-2 (]: Timing info for test.sc_interdiction.unique_silver_shops_shop_id.0b274c977f (compile): 00:54:26.499408 => 00:54:26.512211
[0m00:54:26.512962 [debug] [Thread-4 (]: Using postgres connection "test.sc_interdiction.unique_silver_shop_items_id.b5452d9546"
[0m00:54:26.516989 [debug] [Thread-1 (]: Writing runtime sql for node "test.sc_interdiction.unique_silver_quantum_routes_id.0c7a40ff16"
[0m00:54:26.517875 [debug] [Thread-3 (]: On test.sc_interdiction.unique_silver_locations_id.0592204245: BEGIN
[0m00:54:26.518505 [debug] [Thread-2 (]: Began executing node test.sc_interdiction.unique_silver_shops_shop_id.0b274c977f
[0m00:54:26.519036 [debug] [Thread-4 (]: On test.sc_interdiction.unique_silver_shop_items_id.b5452d9546: BEGIN
[0m00:54:26.519797 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:54:26.523722 [debug] [Thread-2 (]: Writing runtime sql for node "test.sc_interdiction.unique_silver_shops_shop_id.0b274c977f"
[0m00:54:26.524314 [debug] [Thread-1 (]: Using postgres connection "test.sc_interdiction.unique_silver_quantum_routes_id.0c7a40ff16"
[0m00:54:26.524836 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:54:26.525831 [debug] [Thread-1 (]: On test.sc_interdiction.unique_silver_quantum_routes_id.0c7a40ff16: BEGIN
[0m00:54:26.526494 [debug] [Thread-2 (]: Using postgres connection "test.sc_interdiction.unique_silver_shops_shop_id.0b274c977f"
[0m00:54:26.527119 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:54:26.527583 [debug] [Thread-2 (]: On test.sc_interdiction.unique_silver_shops_shop_id.0b274c977f: BEGIN
[0m00:54:26.528275 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:54:26.532202 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m00:54:26.533041 [debug] [Thread-3 (]: Using postgres connection "test.sc_interdiction.unique_silver_locations_id.0592204245"
[0m00:54:26.533891 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m00:54:26.534548 [debug] [Thread-3 (]: On test.sc_interdiction.unique_silver_locations_id.0592204245: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "node_id": "test.sc_interdiction.unique_silver_locations_id.0592204245"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "sc_interdiction"."raw_silver"."silver_locations"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m00:54:26.535024 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:54:26.535507 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m00:54:26.536086 [debug] [Thread-4 (]: Using postgres connection "test.sc_interdiction.unique_silver_shop_items_id.b5452d9546"
[0m00:54:26.536737 [debug] [Thread-1 (]: Using postgres connection "test.sc_interdiction.unique_silver_quantum_routes_id.0c7a40ff16"
[0m00:54:26.537325 [debug] [Thread-2 (]: Using postgres connection "test.sc_interdiction.unique_silver_shops_shop_id.0b274c977f"
[0m00:54:26.538279 [debug] [Thread-4 (]: On test.sc_interdiction.unique_silver_shop_items_id.b5452d9546: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "node_id": "test.sc_interdiction.unique_silver_shop_items_id.b5452d9546"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "sc_interdiction"."raw_silver"."silver_shop_items"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m00:54:26.538787 [debug] [Thread-1 (]: On test.sc_interdiction.unique_silver_quantum_routes_id.0c7a40ff16: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "node_id": "test.sc_interdiction.unique_silver_quantum_routes_id.0c7a40ff16"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "sc_interdiction"."raw_silver"."silver_quantum_routes"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m00:54:26.539329 [debug] [Thread-2 (]: On test.sc_interdiction.unique_silver_shops_shop_id.0b274c977f: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "node_id": "test.sc_interdiction.unique_silver_shops_shop_id.0b274c977f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    shop_id as unique_field,
    count(*) as n_records

from "sc_interdiction"."raw_silver"."silver_shops"
where shop_id is not null
group by shop_id
having count(*) > 1



      
    ) dbt_internal_test
[0m00:54:26.542615 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:54:26.543306 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:54:26.545472 [debug] [Thread-2 (]: Timing info for test.sc_interdiction.unique_silver_shops_shop_id.0b274c977f (execute): 00:54:26.520203 => 00:54:26.545094
[0m00:54:26.546011 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:54:26.548247 [debug] [Thread-3 (]: Timing info for test.sc_interdiction.unique_silver_locations_id.0592204245 (execute): 00:54:26.491864 => 00:54:26.547867
[0m00:54:26.548995 [debug] [Thread-2 (]: On test.sc_interdiction.unique_silver_shops_shop_id.0b274c977f: ROLLBACK
[0m00:54:26.550680 [debug] [Thread-1 (]: Timing info for test.sc_interdiction.unique_silver_quantum_routes_id.0c7a40ff16 (execute): 00:54:26.513266 => 00:54:26.550444
[0m00:54:26.551313 [debug] [Thread-3 (]: On test.sc_interdiction.unique_silver_locations_id.0592204245: ROLLBACK
[0m00:54:26.551889 [debug] [Thread-1 (]: On test.sc_interdiction.unique_silver_quantum_routes_id.0c7a40ff16: ROLLBACK
[0m00:54:26.552407 [debug] [Thread-2 (]: On test.sc_interdiction.unique_silver_shops_shop_id.0b274c977f: Close
[0m00:54:26.553098 [debug] [Thread-3 (]: On test.sc_interdiction.unique_silver_locations_id.0592204245: Close
[0m00:54:26.554587 [debug] [Thread-1 (]: On test.sc_interdiction.unique_silver_quantum_routes_id.0c7a40ff16: Close
[0m00:54:26.554196 [info ] [Thread-2 (]: 12 of 16 PASS unique_silver_shops_shop_id ...................................... [[32mPASS[0m in 0.06s]
[0m00:54:26.557890 [debug] [Thread-2 (]: Finished running node test.sc_interdiction.unique_silver_shops_shop_id.0b274c977f
[0m00:54:26.559064 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:54:26.556042 [info ] [Thread-3 (]: 9 of 16 PASS unique_silver_locations_id ........................................ [[32mPASS[0m in 0.10s]
[0m00:54:26.560941 [debug] [Thread-2 (]: Began running node test.sc_interdiction.unique_stg_locations_id.c38397f3d7
[0m00:54:26.560068 [info ] [Thread-1 (]: 10 of 16 PASS unique_silver_quantum_routes_id .................................. [[32mPASS[0m in 0.11s]
[0m00:54:26.562909 [debug] [Thread-4 (]: Timing info for test.sc_interdiction.unique_silver_shop_items_id.b5452d9546 (execute): 00:54:26.506414 => 00:54:26.562662
[0m00:54:26.563672 [debug] [Thread-3 (]: Finished running node test.sc_interdiction.unique_silver_locations_id.0592204245
[0m00:54:26.564248 [info ] [Thread-2 (]: 13 of 16 START test unique_stg_locations_id .................................... [RUN]
[0m00:54:26.565066 [debug] [Thread-1 (]: Finished running node test.sc_interdiction.unique_silver_quantum_routes_id.0c7a40ff16
[0m00:54:26.565568 [debug] [Thread-4 (]: On test.sc_interdiction.unique_silver_shop_items_id.b5452d9546: ROLLBACK
[0m00:54:26.566525 [debug] [Thread-3 (]: Began running node test.sc_interdiction.unique_stg_quantum_routes_id.6b2da7aba0
[0m00:54:26.567729 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.sc_interdiction.unique_silver_shops_shop_id.0b274c977f, now test.sc_interdiction.unique_stg_locations_id.c38397f3d7)
[0m00:54:26.568580 [debug] [Thread-1 (]: Began running node test.sc_interdiction.unique_stg_shop_items_id.e431d7bee2
[0m00:54:26.569931 [debug] [Thread-4 (]: On test.sc_interdiction.unique_silver_shop_items_id.b5452d9546: Close
[0m00:54:26.569530 [info ] [Thread-3 (]: 14 of 16 START test unique_stg_quantum_routes_id ............................... [RUN]
[0m00:54:26.570592 [debug] [Thread-2 (]: Began compiling node test.sc_interdiction.unique_stg_locations_id.c38397f3d7
[0m00:54:26.571067 [info ] [Thread-1 (]: 15 of 16 START test unique_stg_shop_items_id ................................... [RUN]
[0m00:54:26.572017 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.sc_interdiction.unique_silver_locations_id.0592204245, now test.sc_interdiction.unique_stg_quantum_routes_id.6b2da7aba0)
[0m00:54:26.579337 [debug] [Thread-2 (]: Writing injected SQL for node "test.sc_interdiction.unique_stg_locations_id.c38397f3d7"
[0m00:54:26.578117 [info ] [Thread-4 (]: 11 of 16 PASS unique_silver_shop_items_id ...................................... [[32mPASS[0m in 0.12s]
[0m00:54:26.580491 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sc_interdiction.unique_silver_quantum_routes_id.0c7a40ff16, now test.sc_interdiction.unique_stg_shop_items_id.e431d7bee2)
[0m00:54:26.581045 [debug] [Thread-3 (]: Began compiling node test.sc_interdiction.unique_stg_quantum_routes_id.6b2da7aba0
[0m00:54:26.582018 [debug] [Thread-4 (]: Finished running node test.sc_interdiction.unique_silver_shop_items_id.b5452d9546
[0m00:54:26.582634 [debug] [Thread-1 (]: Began compiling node test.sc_interdiction.unique_stg_shop_items_id.e431d7bee2
[0m00:54:26.583229 [debug] [Thread-2 (]: Timing info for test.sc_interdiction.unique_stg_locations_id.c38397f3d7 (compile): 00:54:26.572353 => 00:54:26.582928
[0m00:54:26.589695 [debug] [Thread-3 (]: Writing injected SQL for node "test.sc_interdiction.unique_stg_quantum_routes_id.6b2da7aba0"
[0m00:54:26.590480 [debug] [Thread-4 (]: Began running node test.sc_interdiction.unique_stg_shops_shop_id.76719fa9d3
[0m00:54:26.596827 [debug] [Thread-1 (]: Writing injected SQL for node "test.sc_interdiction.unique_stg_shop_items_id.e431d7bee2"
[0m00:54:26.597794 [debug] [Thread-2 (]: Began executing node test.sc_interdiction.unique_stg_locations_id.c38397f3d7
[0m00:54:26.598568 [info ] [Thread-4 (]: 16 of 16 START test unique_stg_shops_shop_id ................................... [RUN]
[0m00:54:26.605065 [debug] [Thread-3 (]: Timing info for test.sc_interdiction.unique_stg_quantum_routes_id.6b2da7aba0 (compile): 00:54:26.583600 => 00:54:26.604593
[0m00:54:26.607744 [debug] [Thread-2 (]: Writing runtime sql for node "test.sc_interdiction.unique_stg_locations_id.c38397f3d7"
[0m00:54:26.611294 [debug] [Thread-1 (]: Timing info for test.sc_interdiction.unique_stg_shop_items_id.e431d7bee2 (compile): 00:54:26.591244 => 00:54:26.610957
[0m00:54:26.612255 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.sc_interdiction.unique_silver_shop_items_id.b5452d9546, now test.sc_interdiction.unique_stg_shops_shop_id.76719fa9d3)
[0m00:54:26.612938 [debug] [Thread-3 (]: Began executing node test.sc_interdiction.unique_stg_quantum_routes_id.6b2da7aba0
[0m00:54:26.615117 [debug] [Thread-1 (]: Began executing node test.sc_interdiction.unique_stg_shop_items_id.e431d7bee2
[0m00:54:26.616019 [debug] [Thread-2 (]: Using postgres connection "test.sc_interdiction.unique_stg_locations_id.c38397f3d7"
[0m00:54:26.616558 [debug] [Thread-4 (]: Began compiling node test.sc_interdiction.unique_stg_shops_shop_id.76719fa9d3
[0m00:54:26.620541 [debug] [Thread-3 (]: Writing runtime sql for node "test.sc_interdiction.unique_stg_quantum_routes_id.6b2da7aba0"
[0m00:54:26.624146 [debug] [Thread-1 (]: Writing runtime sql for node "test.sc_interdiction.unique_stg_shop_items_id.e431d7bee2"
[0m00:54:26.624730 [debug] [Thread-2 (]: On test.sc_interdiction.unique_stg_locations_id.c38397f3d7: BEGIN
[0m00:54:26.630428 [debug] [Thread-4 (]: Writing injected SQL for node "test.sc_interdiction.unique_stg_shops_shop_id.76719fa9d3"
[0m00:54:26.631482 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m00:54:26.632770 [debug] [Thread-3 (]: Using postgres connection "test.sc_interdiction.unique_stg_quantum_routes_id.6b2da7aba0"
[0m00:54:26.633323 [debug] [Thread-3 (]: On test.sc_interdiction.unique_stg_quantum_routes_id.6b2da7aba0: BEGIN
[0m00:54:26.633904 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m00:54:26.637647 [debug] [Thread-1 (]: Using postgres connection "test.sc_interdiction.unique_stg_shop_items_id.e431d7bee2"
[0m00:54:26.638615 [debug] [Thread-1 (]: On test.sc_interdiction.unique_stg_shop_items_id.e431d7bee2: BEGIN
[0m00:54:26.639525 [debug] [Thread-4 (]: Timing info for test.sc_interdiction.unique_stg_shops_shop_id.76719fa9d3 (compile): 00:54:26.625086 => 00:54:26.639202
[0m00:54:26.640407 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m00:54:26.646962 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:54:26.650598 [debug] [Thread-4 (]: Began executing node test.sc_interdiction.unique_stg_shops_shop_id.76719fa9d3
[0m00:54:26.651340 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m00:54:26.651963 [debug] [Thread-2 (]: Using postgres connection "test.sc_interdiction.unique_stg_locations_id.c38397f3d7"
[0m00:54:26.656200 [debug] [Thread-4 (]: Writing runtime sql for node "test.sc_interdiction.unique_stg_shops_shop_id.76719fa9d3"
[0m00:54:26.657010 [debug] [Thread-3 (]: Using postgres connection "test.sc_interdiction.unique_stg_quantum_routes_id.6b2da7aba0"
[0m00:54:26.657583 [debug] [Thread-2 (]: On test.sc_interdiction.unique_stg_locations_id.c38397f3d7: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "node_id": "test.sc_interdiction.unique_stg_locations_id.c38397f3d7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "sc_interdiction"."raw_staging"."stg_locations"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m00:54:26.658372 [debug] [Thread-3 (]: On test.sc_interdiction.unique_stg_quantum_routes_id.6b2da7aba0: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "node_id": "test.sc_interdiction.unique_stg_quantum_routes_id.6b2da7aba0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "sc_interdiction"."raw_staging"."stg_quantum_routes"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m00:54:26.660276 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m00:54:26.660668 [debug] [Thread-1 (]: Using postgres connection "test.sc_interdiction.unique_stg_shop_items_id.e431d7bee2"
[0m00:54:26.661010 [debug] [Thread-1 (]: On test.sc_interdiction.unique_stg_shop_items_id.e431d7bee2: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "node_id": "test.sc_interdiction.unique_stg_shop_items_id.e431d7bee2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "sc_interdiction"."raw_staging"."stg_shop_items"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m00:54:26.661962 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:54:26.664946 [debug] [Thread-3 (]: Timing info for test.sc_interdiction.unique_stg_quantum_routes_id.6b2da7aba0 (execute): 00:54:26.616943 => 00:54:26.664551
[0m00:54:26.665581 [debug] [Thread-3 (]: On test.sc_interdiction.unique_stg_quantum_routes_id.6b2da7aba0: ROLLBACK
[0m00:54:26.666503 [debug] [Thread-3 (]: On test.sc_interdiction.unique_stg_quantum_routes_id.6b2da7aba0: Close
[0m00:54:26.667900 [info ] [Thread-3 (]: 14 of 16 PASS unique_stg_quantum_routes_id ..................................... [[32mPASS[0m in 0.10s]
[0m00:54:26.668981 [debug] [Thread-3 (]: Finished running node test.sc_interdiction.unique_stg_quantum_routes_id.6b2da7aba0
[0m00:54:26.669840 [debug] [Thread-4 (]: Using postgres connection "test.sc_interdiction.unique_stg_shops_shop_id.76719fa9d3"
[0m00:54:26.670348 [debug] [Thread-4 (]: On test.sc_interdiction.unique_stg_shops_shop_id.76719fa9d3: BEGIN
[0m00:54:26.670820 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m00:54:26.674226 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:54:26.676477 [debug] [Thread-2 (]: Timing info for test.sc_interdiction.unique_stg_locations_id.c38397f3d7 (execute): 00:54:26.599379 => 00:54:26.676128
[0m00:54:26.676937 [debug] [Thread-2 (]: On test.sc_interdiction.unique_stg_locations_id.c38397f3d7: ROLLBACK
[0m00:54:26.677709 [debug] [Thread-2 (]: On test.sc_interdiction.unique_stg_locations_id.c38397f3d7: Close
[0m00:54:26.678233 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m00:54:26.678823 [debug] [Thread-4 (]: Using postgres connection "test.sc_interdiction.unique_stg_shops_shop_id.76719fa9d3"
[0m00:54:26.679795 [info ] [Thread-2 (]: 13 of 16 PASS unique_stg_locations_id .......................................... [[32mPASS[0m in 0.11s]
[0m00:54:26.680442 [debug] [Thread-4 (]: On test.sc_interdiction.unique_stg_shops_shop_id.76719fa9d3: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "node_id": "test.sc_interdiction.unique_stg_shops_shop_id.76719fa9d3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    shop_id as unique_field,
    count(*) as n_records

from "sc_interdiction"."raw_staging"."stg_shops"
where shop_id is not null
group by shop_id
having count(*) > 1



      
    ) dbt_internal_test
[0m00:54:26.681259 [debug] [Thread-2 (]: Finished running node test.sc_interdiction.unique_stg_locations_id.c38397f3d7
[0m00:54:26.685439 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:54:26.688605 [debug] [Thread-4 (]: Timing info for test.sc_interdiction.unique_stg_shops_shop_id.76719fa9d3 (execute): 00:54:26.652586 => 00:54:26.688007
[0m00:54:26.689406 [debug] [Thread-4 (]: On test.sc_interdiction.unique_stg_shops_shop_id.76719fa9d3: ROLLBACK
[0m00:54:26.689958 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m00:54:26.691974 [debug] [Thread-1 (]: Timing info for test.sc_interdiction.unique_stg_shop_items_id.e431d7bee2 (execute): 00:54:26.621110 => 00:54:26.691583
[0m00:54:26.692525 [debug] [Thread-4 (]: On test.sc_interdiction.unique_stg_shops_shop_id.76719fa9d3: Close
[0m00:54:26.693023 [debug] [Thread-1 (]: On test.sc_interdiction.unique_stg_shop_items_id.e431d7bee2: ROLLBACK
[0m00:54:26.694666 [debug] [Thread-1 (]: On test.sc_interdiction.unique_stg_shop_items_id.e431d7bee2: Close
[0m00:54:26.694253 [info ] [Thread-4 (]: 16 of 16 PASS unique_stg_shops_shop_id ......................................... [[32mPASS[0m in 0.08s]
[0m00:54:26.695534 [debug] [Thread-4 (]: Finished running node test.sc_interdiction.unique_stg_shops_shop_id.76719fa9d3
[0m00:54:26.696408 [info ] [Thread-1 (]: 15 of 16 PASS unique_stg_shop_items_id ......................................... [[32mPASS[0m in 0.12s]
[0m00:54:26.697517 [debug] [Thread-1 (]: Finished running node test.sc_interdiction.unique_stg_shop_items_id.e431d7bee2
[0m00:54:26.700885 [debug] [MainThread]: Using postgres connection "master"
[0m00:54:26.701555 [debug] [MainThread]: On master: BEGIN
[0m00:54:26.703467 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:54:26.710451 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m00:54:26.711109 [debug] [MainThread]: On master: COMMIT
[0m00:54:26.711509 [debug] [MainThread]: Using postgres connection "master"
[0m00:54:26.711855 [debug] [MainThread]: On master: COMMIT
[0m00:54:26.712390 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m00:54:26.712788 [debug] [MainThread]: On master: Close
[0m00:54:26.713689 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:54:26.714148 [debug] [MainThread]: Connection 'test.sc_interdiction.unique_stg_shop_items_id.e431d7bee2' was properly closed.
[0m00:54:26.714531 [debug] [MainThread]: Connection 'test.sc_interdiction.unique_stg_quantum_routes_id.6b2da7aba0' was properly closed.
[0m00:54:26.714851 [debug] [MainThread]: Connection 'test.sc_interdiction.unique_stg_locations_id.c38397f3d7' was properly closed.
[0m00:54:26.715194 [debug] [MainThread]: Connection 'test.sc_interdiction.unique_stg_shops_shop_id.76719fa9d3' was properly closed.
[0m00:54:26.715694 [info ] [MainThread]: 
[0m00:54:26.716105 [info ] [MainThread]: Finished running 16 tests in 0 hours 0 minutes and 0.85 seconds (0.85s).
[0m00:54:26.719113 [debug] [MainThread]: Command end result
[0m00:54:26.741707 [info ] [MainThread]: 
[0m00:54:26.742632 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:54:26.743153 [info ] [MainThread]: 
[0m00:54:26.743622 [info ] [MainThread]: Done. PASS=16 WARN=0 ERROR=0 SKIP=0 TOTAL=16
[0m00:54:26.744945 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.7520424, "process_user_time": 5.580943, "process_kernel_time": 0.931845, "process_mem_max_rss": "111772", "process_out_blocks": "2960", "process_in_blocks": "0"}
[0m00:54:26.746796 [debug] [MainThread]: Command `dbt test` succeeded at 00:54:26.745720 after 1.75 seconds
[0m00:54:26.747407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaade3add0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaaa379180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaa9e15180>]}
[0m00:54:26.748758 [debug] [MainThread]: Flushing usage events
[0m02:39:41.850142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9f033eda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9ee04a0e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9ee04a080>]}


============================== 02:39:41.867101 | 8fb8d3b6-23da-4330-8820-52fefe1d0fe7 ==============================
[0m02:39:41.867101 [info ] [MainThread]: Running with dbt=1.7.0
[0m02:39:41.868045 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt seed', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m02:39:42.483720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8fb8d3b6-23da-4330-8820-52fefe1d0fe7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9ee08c730>]}
[0m02:39:42.759724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8fb8d3b6-23da-4330-8820-52fefe1d0fe7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9ec5df9a0>]}
[0m02:39:42.761161 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m02:39:42.783246 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m02:39:42.903058 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 2 files changed.
[0m02:39:42.910953 [debug] [MainThread]: Partial parsing: added file: sc_interdiction://models/gold/gold_location_distances.sql
[0m02:39:42.913360 [debug] [MainThread]: Partial parsing: added file: sc_interdiction://seeds/location_coordinates.csv
[0m02:39:42.913969 [debug] [MainThread]: Partial parsing: updated file: sc_interdiction://seeds/schema.yml
[0m02:39:42.914585 [debug] [MainThread]: Partial parsing: updated file: sc_interdiction://models/gold/schema.yml
[0m02:39:43.904851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8fb8d3b6-23da-4330-8820-52fefe1d0fe7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9ec401900>]}
[0m02:39:43.978234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8fb8d3b6-23da-4330-8820-52fefe1d0fe7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9ec5b3160>]}
[0m02:39:43.981852 [info ] [MainThread]: Found 13 models, 3 seeds, 16 tests, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m02:39:43.982656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8fb8d3b6-23da-4330-8820-52fefe1d0fe7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9ec5b32e0>]}
[0m02:39:43.986077 [info ] [MainThread]: 
[0m02:39:43.987366 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:39:43.989608 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sc_interdiction'
[0m02:39:44.016802 [debug] [ThreadPool]: Using postgres connection "list_sc_interdiction"
[0m02:39:44.017553 [debug] [ThreadPool]: On list_sc_interdiction: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "connection_name": "list_sc_interdiction"} */

    select distinct nspname from pg_namespace
  
[0m02:39:44.017983 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:39:44.082235 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m02:39:44.084818 [debug] [ThreadPool]: On list_sc_interdiction: Close
[0m02:39:44.088726 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sc_interdiction, now list_sc_interdiction_raw_gold)
[0m02:39:44.090108 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sc_interdiction_raw_silver'
[0m02:39:44.091926 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sc_interdiction_raw_staging'
[0m02:39:44.111883 [debug] [ThreadPool]: Using postgres connection "list_sc_interdiction_raw_silver"
[0m02:39:44.112617 [debug] [ThreadPool]: Using postgres connection "list_sc_interdiction_raw_gold"
[0m02:39:44.116072 [debug] [ThreadPool]: Using postgres connection "list_sc_interdiction_raw_staging"
[0m02:39:44.116887 [debug] [ThreadPool]: On list_sc_interdiction_raw_silver: BEGIN
[0m02:39:44.117352 [debug] [ThreadPool]: On list_sc_interdiction_raw_gold: BEGIN
[0m02:39:44.117775 [debug] [ThreadPool]: On list_sc_interdiction_raw_staging: BEGIN
[0m02:39:44.118240 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:39:44.118711 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:39:44.119136 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:39:44.126815 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m02:39:44.127875 [debug] [ThreadPool]: Using postgres connection "list_sc_interdiction_raw_silver"
[0m02:39:44.128342 [debug] [ThreadPool]: On list_sc_interdiction_raw_silver: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "connection_name": "list_sc_interdiction_raw_silver"} */
select
      'sc_interdiction' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw_silver'
    union all
    select
      'sc_interdiction' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw_silver'
    union all
    select
      'sc_interdiction' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw_silver'
  
[0m02:39:44.134671 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m02:39:44.135324 [debug] [ThreadPool]: Using postgres connection "list_sc_interdiction_raw_staging"
[0m02:39:44.135919 [debug] [ThreadPool]: On list_sc_interdiction_raw_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "connection_name": "list_sc_interdiction_raw_staging"} */
select
      'sc_interdiction' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw_staging'
    union all
    select
      'sc_interdiction' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw_staging'
    union all
    select
      'sc_interdiction' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw_staging'
  
[0m02:39:44.136944 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m02:39:44.137358 [debug] [ThreadPool]: Using postgres connection "list_sc_interdiction_raw_gold"
[0m02:39:44.137810 [debug] [ThreadPool]: On list_sc_interdiction_raw_gold: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "connection_name": "list_sc_interdiction_raw_gold"} */
select
      'sc_interdiction' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw_gold'
    union all
    select
      'sc_interdiction' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw_gold'
    union all
    select
      'sc_interdiction' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw_gold'
  
[0m02:39:44.155481 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m02:39:44.156174 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m02:39:44.156634 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m02:39:44.158525 [debug] [ThreadPool]: On list_sc_interdiction_raw_silver: ROLLBACK
[0m02:39:44.160197 [debug] [ThreadPool]: On list_sc_interdiction_raw_gold: ROLLBACK
[0m02:39:44.161848 [debug] [ThreadPool]: On list_sc_interdiction_raw_staging: ROLLBACK
[0m02:39:44.162895 [debug] [ThreadPool]: On list_sc_interdiction_raw_gold: Close
[0m02:39:44.163310 [debug] [ThreadPool]: On list_sc_interdiction_raw_silver: Close
[0m02:39:44.163738 [debug] [ThreadPool]: On list_sc_interdiction_raw_staging: Close
[0m02:39:44.183711 [debug] [MainThread]: Using postgres connection "master"
[0m02:39:44.184377 [debug] [MainThread]: On master: BEGIN
[0m02:39:44.185029 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:39:44.194310 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:39:44.195217 [debug] [MainThread]: Using postgres connection "master"
[0m02:39:44.195687 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:39:44.234301 [debug] [MainThread]: SQL status: SELECT 20 in 0.0 seconds
[0m02:39:44.238933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8fb8d3b6-23da-4330-8820-52fefe1d0fe7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9ec5b32e0>]}
[0m02:39:44.239756 [debug] [MainThread]: On master: ROLLBACK
[0m02:39:44.240531 [debug] [MainThread]: Using postgres connection "master"
[0m02:39:44.240911 [debug] [MainThread]: On master: BEGIN
[0m02:39:44.241633 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:39:44.242035 [debug] [MainThread]: On master: COMMIT
[0m02:39:44.242418 [debug] [MainThread]: Using postgres connection "master"
[0m02:39:44.242791 [debug] [MainThread]: On master: COMMIT
[0m02:39:44.243331 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:39:44.243730 [debug] [MainThread]: On master: Close
[0m02:39:44.252614 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:39:44.253552 [info ] [MainThread]: 
[0m02:39:44.266086 [debug] [Thread-1 (]: Began running node seed.sc_interdiction.display_names
[0m02:39:44.266788 [debug] [Thread-2 (]: Began running node seed.sc_interdiction.lagrange_planets
[0m02:39:44.267425 [debug] [Thread-3 (]: Began running node seed.sc_interdiction.location_coordinates
[0m02:39:44.268175 [info ] [Thread-1 (]: 1 of 3 START seed file raw_silver.display_names ................................ [RUN]
[0m02:39:44.268947 [info ] [Thread-2 (]: 2 of 3 START seed file raw_silver.lagrange_planets ............................. [RUN]
[0m02:39:44.269651 [info ] [Thread-3 (]: 3 of 3 START seed file raw_silver.location_coordinates ......................... [RUN]
[0m02:39:44.275968 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sc_interdiction_raw_staging, now seed.sc_interdiction.display_names)
[0m02:39:44.277118 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_sc_interdiction_raw_silver, now seed.sc_interdiction.lagrange_planets)
[0m02:39:44.278118 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_sc_interdiction_raw_gold, now seed.sc_interdiction.location_coordinates)
[0m02:39:44.278768 [debug] [Thread-1 (]: Began compiling node seed.sc_interdiction.display_names
[0m02:39:44.279343 [debug] [Thread-2 (]: Began compiling node seed.sc_interdiction.lagrange_planets
[0m02:39:44.279871 [debug] [Thread-3 (]: Began compiling node seed.sc_interdiction.location_coordinates
[0m02:39:44.280522 [debug] [Thread-1 (]: Timing info for seed.sc_interdiction.display_names (compile): 02:39:44.280230 => 02:39:44.280236
[0m02:39:44.283620 [debug] [Thread-2 (]: Timing info for seed.sc_interdiction.lagrange_planets (compile): 02:39:44.283226 => 02:39:44.283231
[0m02:39:44.284308 [debug] [Thread-3 (]: Timing info for seed.sc_interdiction.location_coordinates (compile): 02:39:44.284010 => 02:39:44.284014
[0m02:39:44.284930 [debug] [Thread-1 (]: Began executing node seed.sc_interdiction.display_names
[0m02:39:44.285441 [debug] [Thread-2 (]: Began executing node seed.sc_interdiction.lagrange_planets
[0m02:39:44.285941 [debug] [Thread-3 (]: Began executing node seed.sc_interdiction.location_coordinates
[0m02:39:44.387798 [debug] [Thread-3 (]: Using postgres connection "seed.sc_interdiction.location_coordinates"
[0m02:39:44.400081 [debug] [Thread-3 (]: On seed.sc_interdiction.location_coordinates: BEGIN
[0m02:39:44.416794 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m02:39:44.418113 [debug] [Thread-1 (]: Using postgres connection "seed.sc_interdiction.display_names"
[0m02:39:44.420618 [debug] [Thread-2 (]: Using postgres connection "seed.sc_interdiction.lagrange_planets"
[0m02:39:44.423061 [debug] [Thread-1 (]: On seed.sc_interdiction.display_names: BEGIN
[0m02:39:44.423631 [debug] [Thread-2 (]: On seed.sc_interdiction.lagrange_planets: BEGIN
[0m02:39:44.424155 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:39:44.424685 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:39:44.429695 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m02:39:44.430434 [debug] [Thread-3 (]: Using postgres connection "seed.sc_interdiction.location_coordinates"
[0m02:39:44.431243 [debug] [Thread-3 (]: On seed.sc_interdiction.location_coordinates: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "node_id": "seed.sc_interdiction.location_coordinates"} */

    create table "sc_interdiction"."raw_silver"."location_coordinates" ("display_name" text,"system_name" text,"x_mkm" float8,"y_mkm" float8)
  
[0m02:39:44.431912 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m02:39:44.432509 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m02:39:44.433092 [debug] [Thread-2 (]: Using postgres connection "seed.sc_interdiction.lagrange_planets"
[0m02:39:44.433588 [debug] [Thread-1 (]: Using postgres connection "seed.sc_interdiction.display_names"
[0m02:39:44.434116 [debug] [Thread-2 (]: On seed.sc_interdiction.lagrange_planets: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "node_id": "seed.sc_interdiction.lagrange_planets"} */
truncate table "sc_interdiction"."raw_silver"."lagrange_planets"
[0m02:39:44.434656 [debug] [Thread-1 (]: On seed.sc_interdiction.display_names: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "node_id": "seed.sc_interdiction.display_names"} */
truncate table "sc_interdiction"."raw_silver"."display_names"
[0m02:39:44.447775 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.0 seconds
[0m02:39:44.459530 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.0 seconds
[0m02:39:44.465636 [debug] [Thread-3 (]: SQL status: CREATE TABLE in 0.0 seconds
[0m02:39:44.690448 [debug] [Thread-3 (]: Using postgres connection "seed.sc_interdiction.location_coordinates"
[0m02:39:44.685596 [debug] [Thread-1 (]: Using postgres connection "seed.sc_interdiction.display_names"
[0m02:39:44.708636 [debug] [Thread-3 (]: On seed.sc_interdiction.location_coordinates: 
          insert into "sc_interdiction"."raw_silver"."location_coordinates" ("display_name", "system_name", "x_mkm", "y_mkm") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,...
[0m02:39:44.715278 [debug] [Thread-2 (]: Using postgres connection "seed.sc_interdiction.lagrange_planets"
[0m02:39:44.716158 [debug] [Thread-1 (]: On seed.sc_interdiction.display_names: 
          insert into "sc_interdiction"."raw_silver"."display_names" ("loc_name", "display_name") values
          (%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,...
[0m02:39:44.717432 [debug] [Thread-2 (]: On seed.sc_interdiction.lagrange_planets: 
          insert into "sc_interdiction"."raw_silver"."lagrange_planets" ("loc_name", "planet_loc_name", "system_name") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(...
[0m02:39:44.722229 [debug] [Thread-2 (]: SQL status: INSERT 0 77 in 0.0 seconds
[0m02:39:44.723148 [debug] [Thread-1 (]: SQL status: INSERT 0 85 in 0.0 seconds
[0m02:39:44.729446 [debug] [Thread-3 (]: SQL status: INSERT 0 46 in 0.0 seconds
[0m02:39:44.736397 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.sc_interdiction.lagrange_planets"
[0m02:39:44.737906 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.sc_interdiction.display_names"
[0m02:39:44.739020 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.sc_interdiction.location_coordinates"
[0m02:39:44.781117 [debug] [Thread-2 (]: On seed.sc_interdiction.lagrange_planets: COMMIT
[0m02:39:44.787310 [debug] [Thread-2 (]: Using postgres connection "seed.sc_interdiction.lagrange_planets"
[0m02:39:44.790145 [debug] [Thread-1 (]: On seed.sc_interdiction.display_names: COMMIT
[0m02:39:44.791835 [debug] [Thread-3 (]: On seed.sc_interdiction.location_coordinates: COMMIT
[0m02:39:44.792738 [debug] [Thread-2 (]: On seed.sc_interdiction.lagrange_planets: COMMIT
[0m02:39:44.793444 [debug] [Thread-1 (]: Using postgres connection "seed.sc_interdiction.display_names"
[0m02:39:44.794080 [debug] [Thread-3 (]: Using postgres connection "seed.sc_interdiction.location_coordinates"
[0m02:39:44.794810 [debug] [Thread-1 (]: On seed.sc_interdiction.display_names: COMMIT
[0m02:39:44.795328 [debug] [Thread-3 (]: On seed.sc_interdiction.location_coordinates: COMMIT
[0m02:39:44.822185 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m02:39:44.824111 [debug] [Thread-3 (]: Timing info for seed.sc_interdiction.location_coordinates (execute): 02:39:44.346604 => 02:39:44.823763
[0m02:39:44.824748 [debug] [Thread-3 (]: On seed.sc_interdiction.location_coordinates: Close
[0m02:39:44.825955 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8fb8d3b6-23da-4330-8820-52fefe1d0fe7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9ea12bca0>]}
[0m02:39:44.826650 [info ] [Thread-3 (]: 3 of 3 OK loaded seed file raw_silver.location_coordinates ..................... [[32mINSERT 46[0m in 0.55s]
[0m02:39:44.827553 [debug] [Thread-3 (]: Finished running node seed.sc_interdiction.location_coordinates
[0m02:39:44.831695 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:39:44.832383 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m02:39:44.833945 [debug] [Thread-1 (]: Timing info for seed.sc_interdiction.display_names (execute): 02:39:44.286293 => 02:39:44.833634
[0m02:39:44.835544 [debug] [Thread-2 (]: Timing info for seed.sc_interdiction.lagrange_planets (execute): 02:39:44.302216 => 02:39:44.835263
[0m02:39:44.836148 [debug] [Thread-1 (]: On seed.sc_interdiction.display_names: Close
[0m02:39:44.836680 [debug] [Thread-2 (]: On seed.sc_interdiction.lagrange_planets: Close
[0m02:39:44.837904 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8fb8d3b6-23da-4330-8820-52fefe1d0fe7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9ea130b80>]}
[0m02:39:44.838927 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8fb8d3b6-23da-4330-8820-52fefe1d0fe7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9ec760be0>]}
[0m02:39:44.839798 [info ] [Thread-1 (]: 1 of 3 OK loaded seed file raw_silver.display_names ............................ [[32mINSERT 85[0m in 0.56s]
[0m02:39:44.840654 [info ] [Thread-2 (]: 2 of 3 OK loaded seed file raw_silver.lagrange_planets ......................... [[32mINSERT 77[0m in 0.56s]
[0m02:39:44.841609 [debug] [Thread-1 (]: Finished running node seed.sc_interdiction.display_names
[0m02:39:44.842376 [debug] [Thread-2 (]: Finished running node seed.sc_interdiction.lagrange_planets
[0m02:39:44.845607 [debug] [MainThread]: Using postgres connection "master"
[0m02:39:44.846226 [debug] [MainThread]: On master: BEGIN
[0m02:39:44.846568 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:39:44.854233 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:39:44.855034 [debug] [MainThread]: On master: COMMIT
[0m02:39:44.855491 [debug] [MainThread]: Using postgres connection "master"
[0m02:39:44.855850 [debug] [MainThread]: On master: COMMIT
[0m02:39:44.856501 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:39:44.856881 [debug] [MainThread]: On master: Close
[0m02:39:44.857801 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:39:44.858142 [debug] [MainThread]: Connection 'seed.sc_interdiction.location_coordinates' was properly closed.
[0m02:39:44.858436 [debug] [MainThread]: Connection 'seed.sc_interdiction.lagrange_planets' was properly closed.
[0m02:39:44.858708 [debug] [MainThread]: Connection 'seed.sc_interdiction.display_names' was properly closed.
[0m02:39:44.859778 [info ] [MainThread]: 
[0m02:39:44.863940 [info ] [MainThread]: Finished running 3 seeds in 0 hours 0 minutes and 0.87 seconds (0.87s).
[0m02:39:44.867320 [debug] [MainThread]: Command end result
[0m02:39:44.890192 [info ] [MainThread]: 
[0m02:39:44.890879 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:39:44.891615 [info ] [MainThread]: 
[0m02:39:44.892181 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m02:39:44.897568 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 3.1707182, "process_user_time": 7.623058, "process_kernel_time": 1.483955, "process_mem_max_rss": "117328", "process_out_blocks": "3528", "process_in_blocks": "0"}
[0m02:39:44.898637 [debug] [MainThread]: Command `dbt seed` succeeded at 02:39:44.898447 after 3.17 seconds
[0m02:39:44.899174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9f033eda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9ec81e9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9ec6e22f0>]}
[0m02:39:44.899731 [debug] [MainThread]: Flushing usage events
[0m02:39:53.185697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0db6af6e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0db480e170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0db480e110>]}


============================== 02:39:53.192509 | 2345fa89-fcf3-4b27-a6b6-e0bb9e5312dc ==============================
[0m02:39:53.192509 [info ] [MainThread]: Running with dbt=1.7.0
[0m02:39:53.193045 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/app', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m02:39:53.411418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2345fa89-fcf3-4b27-a6b6-e0bb9e5312dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0db48507c0>]}
[0m02:39:53.637576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2345fa89-fcf3-4b27-a6b6-e0bb9e5312dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0db477b070>]}
[0m02:39:53.638930 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m02:39:53.661229 [debug] [MainThread]: checksum: 8434eacd4ffdf0ca3ab22bf0e2d55b45306c9599613e842b959405abc489e606, vars: {}, profile: , target: , version: 1.7.0
[0m02:39:53.741626 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:39:53.742338 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:39:53.759373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2345fa89-fcf3-4b27-a6b6-e0bb9e5312dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0db2bd80d0>]}
[0m02:39:53.786301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2345fa89-fcf3-4b27-a6b6-e0bb9e5312dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0db2b9a0b0>]}
[0m02:39:53.788424 [info ] [MainThread]: Found 13 models, 3 seeds, 16 tests, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m02:39:53.790009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2345fa89-fcf3-4b27-a6b6-e0bb9e5312dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0db2b9a2c0>]}
[0m02:39:53.799755 [info ] [MainThread]: 
[0m02:39:53.801110 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:39:53.803658 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sc_interdiction'
[0m02:39:53.804996 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sc_interdiction'
[0m02:39:53.811844 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sc_interdiction'
[0m02:39:53.832062 [debug] [ThreadPool]: Using postgres connection "list_sc_interdiction"
[0m02:39:53.832609 [debug] [ThreadPool]: Using postgres connection "list_sc_interdiction"
[0m02:39:53.836288 [debug] [ThreadPool]: Using postgres connection "list_sc_interdiction"
[0m02:39:53.836987 [debug] [ThreadPool]: On list_sc_interdiction: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "connection_name": "list_sc_interdiction"} */

    select distinct nspname from pg_namespace
  
[0m02:39:53.837489 [debug] [ThreadPool]: On list_sc_interdiction: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "connection_name": "list_sc_interdiction"} */

    select distinct nspname from pg_namespace
  
[0m02:39:53.838015 [debug] [ThreadPool]: On list_sc_interdiction: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "connection_name": "list_sc_interdiction"} */

    select distinct nspname from pg_namespace
  
[0m02:39:53.838482 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:39:53.838917 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:39:53.839372 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:39:53.849942 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m02:39:53.852470 [debug] [ThreadPool]: On list_sc_interdiction: Close
[0m02:39:53.853304 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m02:39:53.855168 [debug] [ThreadPool]: On list_sc_interdiction: Close
[0m02:39:53.855717 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m02:39:53.859937 [debug] [ThreadPool]: On list_sc_interdiction: Close
[0m02:39:53.864025 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sc_interdiction, now list_sc_interdiction_raw_silver)
[0m02:39:53.865518 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sc_interdiction, now list_sc_interdiction_raw_staging)
[0m02:39:53.881897 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sc_interdiction, now list_sc_interdiction_raw_gold)
[0m02:39:53.896309 [debug] [ThreadPool]: Using postgres connection "list_sc_interdiction_raw_silver"
[0m02:39:53.899839 [debug] [ThreadPool]: Using postgres connection "list_sc_interdiction_raw_staging"
[0m02:39:53.903441 [debug] [ThreadPool]: Using postgres connection "list_sc_interdiction_raw_gold"
[0m02:39:53.904380 [debug] [ThreadPool]: On list_sc_interdiction_raw_silver: BEGIN
[0m02:39:53.904955 [debug] [ThreadPool]: On list_sc_interdiction_raw_staging: BEGIN
[0m02:39:53.905381 [debug] [ThreadPool]: On list_sc_interdiction_raw_gold: BEGIN
[0m02:39:53.905789 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:39:53.906231 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:39:53.906625 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:39:53.914116 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m02:39:53.914709 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m02:39:53.915256 [debug] [ThreadPool]: Using postgres connection "list_sc_interdiction_raw_gold"
[0m02:39:53.915643 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m02:39:53.916119 [debug] [ThreadPool]: Using postgres connection "list_sc_interdiction_raw_silver"
[0m02:39:53.916627 [debug] [ThreadPool]: On list_sc_interdiction_raw_gold: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "connection_name": "list_sc_interdiction_raw_gold"} */
select
      'sc_interdiction' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw_gold'
    union all
    select
      'sc_interdiction' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw_gold'
    union all
    select
      'sc_interdiction' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw_gold'
  
[0m02:39:53.917078 [debug] [ThreadPool]: Using postgres connection "list_sc_interdiction_raw_staging"
[0m02:39:53.917588 [debug] [ThreadPool]: On list_sc_interdiction_raw_silver: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "connection_name": "list_sc_interdiction_raw_silver"} */
select
      'sc_interdiction' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw_silver'
    union all
    select
      'sc_interdiction' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw_silver'
    union all
    select
      'sc_interdiction' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw_silver'
  
[0m02:39:53.918218 [debug] [ThreadPool]: On list_sc_interdiction_raw_staging: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "connection_name": "list_sc_interdiction_raw_staging"} */
select
      'sc_interdiction' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'raw_staging'
    union all
    select
      'sc_interdiction' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'raw_staging'
    union all
    select
      'sc_interdiction' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'raw_staging'
  
[0m02:39:53.924630 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m02:39:53.925471 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m02:39:53.926090 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m02:39:53.928027 [debug] [ThreadPool]: On list_sc_interdiction_raw_staging: ROLLBACK
[0m02:39:53.929640 [debug] [ThreadPool]: On list_sc_interdiction_raw_gold: ROLLBACK
[0m02:39:53.931459 [debug] [ThreadPool]: On list_sc_interdiction_raw_silver: ROLLBACK
[0m02:39:53.932379 [debug] [ThreadPool]: On list_sc_interdiction_raw_staging: Close
[0m02:39:53.932918 [debug] [ThreadPool]: On list_sc_interdiction_raw_gold: Close
[0m02:39:53.933453 [debug] [ThreadPool]: On list_sc_interdiction_raw_silver: Close
[0m02:39:53.950933 [debug] [MainThread]: Using postgres connection "master"
[0m02:39:53.951633 [debug] [MainThread]: On master: BEGIN
[0m02:39:53.952201 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:39:53.959823 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:39:53.960471 [debug] [MainThread]: Using postgres connection "master"
[0m02:39:53.961175 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:39:53.984772 [debug] [MainThread]: SQL status: SELECT 20 in 0.0 seconds
[0m02:39:53.989693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2345fa89-fcf3-4b27-a6b6-e0bb9e5312dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0db2c1e320>]}
[0m02:39:53.990421 [debug] [MainThread]: On master: ROLLBACK
[0m02:39:53.991114 [debug] [MainThread]: Using postgres connection "master"
[0m02:39:53.991406 [debug] [MainThread]: On master: BEGIN
[0m02:39:53.992007 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:39:53.992324 [debug] [MainThread]: On master: COMMIT
[0m02:39:53.992578 [debug] [MainThread]: Using postgres connection "master"
[0m02:39:53.992865 [debug] [MainThread]: On master: COMMIT
[0m02:39:53.993307 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:39:53.993606 [debug] [MainThread]: On master: Close
[0m02:39:53.994346 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:39:53.994688 [info ] [MainThread]: 
[0m02:39:54.019870 [debug] [Thread-1 (]: Began running node model.sc_interdiction.gold_location_distances
[0m02:39:54.020877 [debug] [Thread-2 (]: Began running node model.sc_interdiction.stg_locations
[0m02:39:54.021631 [debug] [Thread-3 (]: Began running node model.sc_interdiction.stg_quantum_routes
[0m02:39:54.022130 [debug] [Thread-4 (]: Began running node model.sc_interdiction.stg_shop_items
[0m02:39:54.022861 [info ] [Thread-1 (]: 1 of 13 START sql view model raw_gold.gold_location_distances .................. [RUN]
[0m02:39:54.023760 [info ] [Thread-2 (]: 2 of 13 START sql view model raw_staging.stg_locations ......................... [RUN]
[0m02:39:54.024449 [info ] [Thread-3 (]: 3 of 13 START sql view model raw_staging.stg_quantum_routes .................... [RUN]
[0m02:39:54.025093 [info ] [Thread-4 (]: 4 of 13 START sql view model raw_staging.stg_shop_items ........................ [RUN]
[0m02:39:54.026177 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sc_interdiction_raw_silver, now model.sc_interdiction.gold_location_distances)
[0m02:39:54.027169 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_sc_interdiction_raw_gold, now model.sc_interdiction.stg_locations)
[0m02:39:54.041647 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_sc_interdiction_raw_staging, now model.sc_interdiction.stg_quantum_routes)
[0m02:39:54.043093 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.sc_interdiction.stg_shop_items'
[0m02:39:54.043721 [debug] [Thread-1 (]: Began compiling node model.sc_interdiction.gold_location_distances
[0m02:39:54.044229 [debug] [Thread-2 (]: Began compiling node model.sc_interdiction.stg_locations
[0m02:39:54.044730 [debug] [Thread-3 (]: Began compiling node model.sc_interdiction.stg_quantum_routes
[0m02:39:54.045213 [debug] [Thread-4 (]: Began compiling node model.sc_interdiction.stg_shop_items
[0m02:39:54.062848 [debug] [Thread-2 (]: Writing injected SQL for node "model.sc_interdiction.stg_locations"
[0m02:39:54.075000 [debug] [Thread-3 (]: Writing injected SQL for node "model.sc_interdiction.stg_quantum_routes"
[0m02:39:54.078115 [debug] [Thread-1 (]: Writing injected SQL for node "model.sc_interdiction.gold_location_distances"
[0m02:39:54.082041 [debug] [Thread-4 (]: Writing injected SQL for node "model.sc_interdiction.stg_shop_items"
[0m02:39:54.084070 [debug] [Thread-1 (]: Timing info for model.sc_interdiction.gold_location_distances (compile): 02:39:54.045586 => 02:39:54.083693
[0m02:39:54.084758 [debug] [Thread-3 (]: Timing info for model.sc_interdiction.stg_quantum_routes (compile): 02:39:54.072399 => 02:39:54.084418
[0m02:39:54.085341 [debug] [Thread-2 (]: Timing info for model.sc_interdiction.stg_locations (compile): 02:39:54.059945 => 02:39:54.085008
[0m02:39:54.086094 [debug] [Thread-1 (]: Began executing node model.sc_interdiction.gold_location_distances
[0m02:39:54.086644 [debug] [Thread-4 (]: Timing info for model.sc_interdiction.stg_shop_items (compile): 02:39:54.079165 => 02:39:54.086381
[0m02:39:54.087410 [debug] [Thread-3 (]: Began executing node model.sc_interdiction.stg_quantum_routes
[0m02:39:54.087947 [debug] [Thread-2 (]: Began executing node model.sc_interdiction.stg_locations
[0m02:39:54.102787 [debug] [Thread-4 (]: Began executing node model.sc_interdiction.stg_shop_items
[0m02:39:54.377345 [debug] [Thread-4 (]: Writing runtime sql for node "model.sc_interdiction.stg_shop_items"
[0m02:39:54.376075 [debug] [Thread-3 (]: Writing runtime sql for node "model.sc_interdiction.stg_quantum_routes"
[0m02:39:54.380142 [debug] [Thread-2 (]: Writing runtime sql for node "model.sc_interdiction.stg_locations"
[0m02:39:54.382007 [debug] [Thread-1 (]: Writing runtime sql for node "model.sc_interdiction.gold_location_distances"
[0m02:39:54.384034 [debug] [Thread-1 (]: Using postgres connection "model.sc_interdiction.gold_location_distances"
[0m02:39:54.384719 [debug] [Thread-3 (]: Using postgres connection "model.sc_interdiction.stg_quantum_routes"
[0m02:39:54.385384 [debug] [Thread-2 (]: Using postgres connection "model.sc_interdiction.stg_locations"
[0m02:39:54.385936 [debug] [Thread-1 (]: On model.sc_interdiction.gold_location_distances: BEGIN
[0m02:39:54.386567 [debug] [Thread-4 (]: Using postgres connection "model.sc_interdiction.stg_shop_items"
[0m02:39:54.387093 [debug] [Thread-3 (]: On model.sc_interdiction.stg_quantum_routes: BEGIN
[0m02:39:54.387634 [debug] [Thread-2 (]: On model.sc_interdiction.stg_locations: BEGIN
[0m02:39:54.388136 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:39:54.388670 [debug] [Thread-4 (]: On model.sc_interdiction.stg_shop_items: BEGIN
[0m02:39:54.389165 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m02:39:54.389633 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:39:54.390381 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m02:39:54.396701 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m02:39:54.397365 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m02:39:54.398023 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m02:39:54.398554 [debug] [Thread-1 (]: Using postgres connection "model.sc_interdiction.gold_location_distances"
[0m02:39:54.399209 [debug] [Thread-3 (]: Using postgres connection "model.sc_interdiction.stg_quantum_routes"
[0m02:39:54.399809 [debug] [Thread-2 (]: Using postgres connection "model.sc_interdiction.stg_locations"
[0m02:39:54.400419 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m02:39:54.400966 [debug] [Thread-1 (]: On model.sc_interdiction.gold_location_distances: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "node_id": "model.sc_interdiction.gold_location_distances"} */

  create view "sc_interdiction"."raw_gold"."gold_location_distances__dbt_tmp"
    
    
  as (
    -- Gold location distances: calculated distances between all location pairs
-- Uses Euclidean distance formula: sqrt((x2-x1)^2 + (y2-y1)^2)
-- Distances are in millions of km (Mkm)

select
    c1.display_name as from_location,
    c1.system_name as from_system,
    c2.display_name as to_location,
    c2.system_name as to_system,
    c1.x_mkm as from_x,
    c1.y_mkm as from_y,
    c2.x_mkm as to_x,
    c2.y_mkm as to_y,
    sqrt(power(c2.x_mkm - c1.x_mkm, 2) + power(c2.y_mkm - c1.y_mkm, 2)) as distance_mkm,
    sqrt(power(c2.x_mkm - c1.x_mkm, 2) + power(c2.y_mkm - c1.y_mkm, 2)) / 149.6 as distance_au
from "sc_interdiction"."raw_silver"."location_coordinates" c1
cross join "sc_interdiction"."raw_silver"."location_coordinates" c2
where c1.display_name != c2.display_name
  and c1.system_name = c2.system_name  -- Only same-system distances (cross-system needs jump points)
  );
[0m02:39:54.401536 [debug] [Thread-3 (]: On model.sc_interdiction.stg_quantum_routes: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "node_id": "model.sc_interdiction.stg_quantum_routes"} */

  create view "sc_interdiction"."raw_staging"."stg_quantum_routes__dbt_tmp"
    
    
  as (
    -- Staging model for raw quantum routes

select
    id,
    from_location,
    to_location,
    distance,
    created_at,
    updated_at
from raw.quantum_routes
  );
[0m02:39:54.402099 [debug] [Thread-2 (]: On model.sc_interdiction.stg_locations: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "node_id": "model.sc_interdiction.stg_locations"} */

  create view "sc_interdiction"."raw_staging"."stg_locations__dbt_tmp"
    
    
  as (
    -- Staging model for raw locations
-- Reads from Diesel-managed raw.locations table

select
    id,
    name,
    parent_id,
    location_type,
    nav_icon,
    affiliation,
    description,
    is_scannable,
    hide_in_starmap,
    obstruction_radius,
    arrival_radius,
    arrival_point_offset,
    adoption_radius,
    created_at,
    updated_at
from raw.locations
  );
[0m02:39:54.402669 [debug] [Thread-4 (]: Using postgres connection "model.sc_interdiction.stg_shop_items"
[0m02:39:54.403575 [debug] [Thread-4 (]: On model.sc_interdiction.stg_shop_items: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "node_id": "model.sc_interdiction.stg_shop_items"} */

  create view "sc_interdiction"."raw_staging"."stg_shop_items__dbt_tmp"
    
    
  as (
    -- Staging model for raw shop items

select
    id,
    shop_id,
    item_id,
    buy_price,
    sell_price,
    max_inventory,
    created_at,
    updated_at
from raw.shop_items
  );
[0m02:39:54.409489 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m02:39:54.410131 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m02:39:54.410608 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m02:39:54.416841 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m02:39:54.429474 [debug] [Thread-4 (]: Using postgres connection "model.sc_interdiction.stg_shop_items"
[0m02:39:54.430537 [debug] [Thread-3 (]: Using postgres connection "model.sc_interdiction.stg_quantum_routes"
[0m02:39:54.435721 [debug] [Thread-2 (]: Using postgres connection "model.sc_interdiction.stg_locations"
[0m02:39:54.440551 [debug] [Thread-1 (]: Using postgres connection "model.sc_interdiction.gold_location_distances"
[0m02:39:54.441464 [debug] [Thread-4 (]: On model.sc_interdiction.stg_shop_items: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "node_id": "model.sc_interdiction.stg_shop_items"} */
alter table "sc_interdiction"."raw_staging"."stg_shop_items" rename to "stg_shop_items__dbt_backup"
[0m02:39:54.442187 [debug] [Thread-3 (]: On model.sc_interdiction.stg_quantum_routes: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "node_id": "model.sc_interdiction.stg_quantum_routes"} */
alter table "sc_interdiction"."raw_staging"."stg_quantum_routes" rename to "stg_quantum_routes__dbt_backup"
[0m02:39:54.442768 [debug] [Thread-2 (]: On model.sc_interdiction.stg_locations: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "node_id": "model.sc_interdiction.stg_locations"} */
alter table "sc_interdiction"."raw_staging"."stg_locations" rename to "stg_locations__dbt_backup"
[0m02:39:54.443337 [debug] [Thread-1 (]: On model.sc_interdiction.gold_location_distances: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "node_id": "model.sc_interdiction.gold_location_distances"} */
alter table "sc_interdiction"."raw_gold"."gold_location_distances__dbt_tmp" rename to "gold_location_distances"
[0m02:39:54.446066 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:39:54.446805 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:39:54.447262 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:39:54.447858 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:39:54.480061 [debug] [Thread-2 (]: Using postgres connection "model.sc_interdiction.stg_locations"
[0m02:39:54.487589 [debug] [Thread-1 (]: On model.sc_interdiction.gold_location_distances: COMMIT
[0m02:39:54.503342 [debug] [Thread-1 (]: Using postgres connection "model.sc_interdiction.gold_location_distances"
[0m02:39:54.500371 [debug] [Thread-3 (]: Using postgres connection "model.sc_interdiction.stg_quantum_routes"
[0m02:39:54.507691 [debug] [Thread-1 (]: On model.sc_interdiction.gold_location_distances: COMMIT
[0m02:39:54.492506 [debug] [Thread-4 (]: Using postgres connection "model.sc_interdiction.stg_shop_items"
[0m02:39:54.502714 [debug] [Thread-2 (]: On model.sc_interdiction.stg_locations: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "node_id": "model.sc_interdiction.stg_locations"} */
alter table "sc_interdiction"."raw_staging"."stg_locations__dbt_tmp" rename to "stg_locations"
[0m02:39:54.511258 [debug] [Thread-3 (]: On model.sc_interdiction.stg_quantum_routes: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "node_id": "model.sc_interdiction.stg_quantum_routes"} */
alter table "sc_interdiction"."raw_staging"."stg_quantum_routes__dbt_tmp" rename to "stg_quantum_routes"
[0m02:39:54.513207 [debug] [Thread-4 (]: On model.sc_interdiction.stg_shop_items: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "node_id": "model.sc_interdiction.stg_shop_items"} */
alter table "sc_interdiction"."raw_staging"."stg_shop_items__dbt_tmp" rename to "stg_shop_items"
[0m02:39:54.514799 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:39:54.515438 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:39:54.521324 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:39:54.522066 [debug] [Thread-3 (]: On model.sc_interdiction.stg_quantum_routes: COMMIT
[0m02:39:54.522718 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:39:54.525548 [debug] [Thread-2 (]: On model.sc_interdiction.stg_locations: COMMIT
[0m02:39:54.542280 [debug] [Thread-1 (]: Applying DROP to: "sc_interdiction"."raw_gold"."gold_location_distances__dbt_backup"
[0m02:39:54.546800 [debug] [Thread-3 (]: Using postgres connection "model.sc_interdiction.stg_quantum_routes"
[0m02:39:54.552438 [debug] [Thread-4 (]: On model.sc_interdiction.stg_shop_items: COMMIT
[0m02:39:54.553210 [debug] [Thread-2 (]: Using postgres connection "model.sc_interdiction.stg_locations"
[0m02:39:54.560902 [debug] [Thread-1 (]: Using postgres connection "model.sc_interdiction.gold_location_distances"
[0m02:39:54.561686 [debug] [Thread-3 (]: On model.sc_interdiction.stg_quantum_routes: COMMIT
[0m02:39:54.562254 [debug] [Thread-4 (]: Using postgres connection "model.sc_interdiction.stg_shop_items"
[0m02:39:54.562782 [debug] [Thread-2 (]: On model.sc_interdiction.stg_locations: COMMIT
[0m02:39:54.563340 [debug] [Thread-1 (]: On model.sc_interdiction.gold_location_distances: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "node_id": "model.sc_interdiction.gold_location_distances"} */
drop view if exists "sc_interdiction"."raw_gold"."gold_location_distances__dbt_backup" cascade
[0m02:39:54.564005 [debug] [Thread-4 (]: On model.sc_interdiction.stg_shop_items: COMMIT
[0m02:39:54.565512 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m02:39:54.566054 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m02:39:54.566699 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m02:39:54.567146 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m02:39:54.571806 [debug] [Thread-3 (]: Applying DROP to: "sc_interdiction"."raw_staging"."stg_quantum_routes__dbt_backup"
[0m02:39:54.574376 [debug] [Thread-1 (]: Timing info for model.sc_interdiction.gold_location_distances (execute): 02:39:54.088273 => 02:39:54.574025
[0m02:39:54.578622 [debug] [Thread-2 (]: Applying DROP to: "sc_interdiction"."raw_staging"."stg_locations__dbt_backup"
[0m02:39:54.585322 [debug] [Thread-4 (]: Applying DROP to: "sc_interdiction"."raw_staging"."stg_shop_items__dbt_backup"
[0m02:39:54.586804 [debug] [Thread-3 (]: Using postgres connection "model.sc_interdiction.stg_quantum_routes"
[0m02:39:54.587546 [debug] [Thread-1 (]: On model.sc_interdiction.gold_location_distances: Close
[0m02:39:54.588966 [debug] [Thread-2 (]: Using postgres connection "model.sc_interdiction.stg_locations"
[0m02:39:54.590347 [debug] [Thread-4 (]: Using postgres connection "model.sc_interdiction.stg_shop_items"
[0m02:39:54.591015 [debug] [Thread-3 (]: On model.sc_interdiction.stg_quantum_routes: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "node_id": "model.sc_interdiction.stg_quantum_routes"} */
drop view if exists "sc_interdiction"."raw_staging"."stg_quantum_routes__dbt_backup" cascade
[0m02:39:54.591677 [debug] [Thread-2 (]: On model.sc_interdiction.stg_locations: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "node_id": "model.sc_interdiction.stg_locations"} */
drop view if exists "sc_interdiction"."raw_staging"."stg_locations__dbt_backup" cascade
[0m02:39:54.592792 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2345fa89-fcf3-4b27-a6b6-e0bb9e5312dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0db2b989a0>]}
[0m02:39:54.594875 [info ] [Thread-1 (]: 1 of 13 OK created sql view model raw_gold.gold_location_distances ............. [[32mCREATE VIEW[0m in 0.57s]
[0m02:39:54.596352 [debug] [Thread-1 (]: Finished running node model.sc_interdiction.gold_location_distances
[0m02:39:54.597012 [debug] [Thread-1 (]: Began running node model.sc_interdiction.stg_shops
[0m02:39:54.593331 [debug] [Thread-4 (]: On model.sc_interdiction.stg_shop_items: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "node_id": "model.sc_interdiction.stg_shop_items"} */
drop view if exists "sc_interdiction"."raw_staging"."stg_shop_items__dbt_backup" cascade
[0m02:39:54.597880 [info ] [Thread-1 (]: 5 of 13 START sql view model raw_staging.stg_shops ............................. [RUN]
[0m02:39:54.599397 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sc_interdiction.gold_location_distances, now model.sc_interdiction.stg_shops)
[0m02:39:54.600051 [debug] [Thread-1 (]: Began compiling node model.sc_interdiction.stg_shops
[0m02:39:54.610711 [debug] [Thread-1 (]: Writing injected SQL for node "model.sc_interdiction.stg_shops"
[0m02:39:54.612087 [debug] [Thread-1 (]: Timing info for model.sc_interdiction.stg_shops (compile): 02:39:54.605292 => 02:39:54.611691
[0m02:39:54.612701 [debug] [Thread-1 (]: Began executing node model.sc_interdiction.stg_shops
[0m02:39:54.621952 [debug] [Thread-1 (]: Writing runtime sql for node "model.sc_interdiction.stg_shops"
[0m02:39:54.628907 [debug] [Thread-1 (]: Using postgres connection "model.sc_interdiction.stg_shops"
[0m02:39:54.629727 [debug] [Thread-1 (]: On model.sc_interdiction.stg_shops: BEGIN
[0m02:39:54.630107 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:39:54.636916 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m02:39:54.639864 [debug] [Thread-1 (]: Using postgres connection "model.sc_interdiction.stg_shops"
[0m02:39:54.640371 [debug] [Thread-1 (]: On model.sc_interdiction.stg_shops: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "node_id": "model.sc_interdiction.stg_shops"} */

  create view "sc_interdiction"."raw_staging"."stg_shops__dbt_tmp"
    
    
  as (
    -- Staging model for raw shops

select
    shop_id,
    location_id,
    shop_name,
    created_at,
    updated_at
from raw.shops
  );
[0m02:39:54.644547 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.0 seconds
[0m02:39:54.645285 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m02:39:54.645966 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m02:39:54.646486 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m02:39:54.648742 [debug] [Thread-4 (]: Timing info for model.sc_interdiction.stg_shop_items (execute): 02:39:54.209542 => 02:39:54.648497
[0m02:39:54.655360 [debug] [Thread-1 (]: Using postgres connection "model.sc_interdiction.stg_shops"
[0m02:39:54.658086 [debug] [Thread-3 (]: Timing info for model.sc_interdiction.stg_quantum_routes (execute): 02:39:54.103321 => 02:39:54.657754
[0m02:39:54.660536 [debug] [Thread-2 (]: Timing info for model.sc_interdiction.stg_locations (execute): 02:39:54.161793 => 02:39:54.660218
[0m02:39:54.661325 [debug] [Thread-4 (]: On model.sc_interdiction.stg_shop_items: Close
[0m02:39:54.661885 [debug] [Thread-1 (]: On model.sc_interdiction.stg_shops: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "node_id": "model.sc_interdiction.stg_shops"} */
alter table "sc_interdiction"."raw_staging"."stg_shops" rename to "stg_shops__dbt_backup"
[0m02:39:54.662464 [debug] [Thread-3 (]: On model.sc_interdiction.stg_quantum_routes: Close
[0m02:39:54.663000 [debug] [Thread-2 (]: On model.sc_interdiction.stg_locations: Close
[0m02:39:54.664355 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2345fa89-fcf3-4b27-a6b6-e0bb9e5312dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0db2b25e70>]}
[0m02:39:54.665468 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2345fa89-fcf3-4b27-a6b6-e0bb9e5312dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0db2c482e0>]}
[0m02:39:54.666421 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2345fa89-fcf3-4b27-a6b6-e0bb9e5312dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0db2b23c10>]}
[0m02:39:54.667957 [info ] [Thread-4 (]: 4 of 13 OK created sql view model raw_staging.stg_shop_items ................... [[32mCREATE VIEW[0m in 0.62s]
[0m02:39:54.667025 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:39:54.668862 [info ] [Thread-3 (]: 3 of 13 OK created sql view model raw_staging.stg_quantum_routes ............... [[32mCREATE VIEW[0m in 0.64s]
[0m02:39:54.670679 [debug] [Thread-4 (]: Finished running node model.sc_interdiction.stg_shop_items
[0m02:39:54.669552 [info ] [Thread-2 (]: 2 of 13 OK created sql view model raw_staging.stg_locations .................... [[32mCREATE VIEW[0m in 0.64s]
[0m02:39:54.676646 [debug] [Thread-1 (]: Using postgres connection "model.sc_interdiction.stg_shops"
[0m02:39:54.678818 [debug] [Thread-3 (]: Finished running node model.sc_interdiction.stg_quantum_routes
[0m02:39:54.680510 [debug] [Thread-2 (]: Finished running node model.sc_interdiction.stg_locations
[0m02:39:54.682157 [debug] [Thread-1 (]: On model.sc_interdiction.stg_shops: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "node_id": "model.sc_interdiction.stg_shops"} */
alter table "sc_interdiction"."raw_staging"."stg_shops__dbt_tmp" rename to "stg_shops"
[0m02:39:54.685941 [debug] [Thread-4 (]: Began running node model.sc_interdiction.silver_locations
[0m02:39:54.686711 [info ] [Thread-4 (]: 6 of 13 START sql table model raw_silver.silver_locations ...................... [RUN]
[0m02:39:54.687621 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.sc_interdiction.stg_shop_items, now model.sc_interdiction.silver_locations)
[0m02:39:54.688038 [debug] [Thread-4 (]: Began compiling node model.sc_interdiction.silver_locations
[0m02:39:54.697521 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:39:54.698300 [debug] [Thread-4 (]: Writing injected SQL for node "model.sc_interdiction.silver_locations"
[0m02:39:54.704263 [debug] [Thread-1 (]: On model.sc_interdiction.stg_shops: COMMIT
[0m02:39:54.705225 [debug] [Thread-1 (]: Using postgres connection "model.sc_interdiction.stg_shops"
[0m02:39:54.705792 [debug] [Thread-1 (]: On model.sc_interdiction.stg_shops: COMMIT
[0m02:39:54.706648 [debug] [Thread-4 (]: Timing info for model.sc_interdiction.silver_locations (compile): 02:39:54.688307 => 02:39:54.706332
[0m02:39:54.707124 [debug] [Thread-4 (]: Began executing node model.sc_interdiction.silver_locations
[0m02:39:54.713178 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:39:54.728418 [debug] [Thread-1 (]: Applying DROP to: "sc_interdiction"."raw_staging"."stg_shops__dbt_backup"
[0m02:39:54.746410 [debug] [Thread-1 (]: Using postgres connection "model.sc_interdiction.stg_shops"
[0m02:39:54.747214 [debug] [Thread-1 (]: On model.sc_interdiction.stg_shops: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "node_id": "model.sc_interdiction.stg_shops"} */
drop view if exists "sc_interdiction"."raw_staging"."stg_shops__dbt_backup" cascade
[0m02:39:54.757305 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m02:39:54.765219 [debug] [Thread-1 (]: Timing info for model.sc_interdiction.stg_shops (execute): 02:39:54.613043 => 02:39:54.764911
[0m02:39:54.765829 [debug] [Thread-1 (]: On model.sc_interdiction.stg_shops: Close
[0m02:39:54.767121 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2345fa89-fcf3-4b27-a6b6-e0bb9e5312dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0db2af3af0>]}
[0m02:39:54.768196 [debug] [Thread-4 (]: Writing runtime sql for node "model.sc_interdiction.silver_locations"
[0m02:39:54.767936 [info ] [Thread-1 (]: 5 of 13 OK created sql view model raw_staging.stg_shops ........................ [[32mCREATE VIEW[0m in 0.17s]
[0m02:39:54.769371 [debug] [Thread-1 (]: Finished running node model.sc_interdiction.stg_shops
[0m02:39:54.770155 [debug] [Thread-4 (]: Using postgres connection "model.sc_interdiction.silver_locations"
[0m02:39:54.770867 [debug] [Thread-4 (]: On model.sc_interdiction.silver_locations: BEGIN
[0m02:39:54.771324 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m02:39:54.781625 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m02:39:54.782362 [debug] [Thread-4 (]: Using postgres connection "model.sc_interdiction.silver_locations"
[0m02:39:54.783014 [debug] [Thread-4 (]: On model.sc_interdiction.silver_locations: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "node_id": "model.sc_interdiction.silver_locations"} */

  
    

  create  table "sc_interdiction"."raw_silver"."silver_locations__dbt_tmp"
  
  
    as
  
  (
    -- Silver locations: validated with display names and corrected hierarchy
-- Uses recursive CTE to handle parent-child relationships
-- Lagrange points are re-parented to their associated planets (game data incorrectly parents to star)



with recursive location_tree as (
    -- Base case: root locations (no parent or parent doesn't exist in raw)
    select
        id,
        name,
        parent_id,
        location_type,
        nav_icon,
        affiliation,
        description,
        is_scannable,
        hide_in_starmap,
        obstruction_radius,
        arrival_radius,
        arrival_point_offset,
        adoption_radius,
        created_at,
        updated_at
    from "sc_interdiction"."raw_staging"."stg_locations"
    where parent_id is null
       or parent_id not in (select id from "sc_interdiction"."raw_staging"."stg_locations")

    union all

    -- Recursive case: children of already-processed locations
    select
        r.id,
        r.name,
        r.parent_id,
        r.location_type,
        r.nav_icon,
        r.affiliation,
        r.description,
        r.is_scannable,
        r.hide_in_starmap,
        r.obstruction_radius,
        r.arrival_radius,
        r.arrival_point_offset,
        r.adoption_radius,
        r.created_at,
        r.updated_at
    from "sc_interdiction"."raw_staging"."stg_locations" r
    inner join location_tree lt on r.parent_id = lt.id
),

-- Get planet IDs for Lagrange point re-parenting
lagrange_planet_ids as (
    select
        lp.loc_name,
        lp.planet_loc_name,
        lp.system_name,
        stg.id as planet_id
    from "sc_interdiction"."raw_silver"."lagrange_planets" lp
    inner join "sc_interdiction"."raw_staging"."stg_locations" stg on stg.name = lp.planet_loc_name
)

select
    lt.id,
    lt.name,
    -- Re-parent Lagrange points to their associated planet, otherwise use original parent
    coalesce(
        lpi.planet_id,
        case
            when lt.parent_id in (select id from location_tree) then lt.parent_id
            else null
        end
    ) as parent_id,
    lt.location_type,
    lt.nav_icon,
    lt.affiliation,
    lt.description,
    lt.is_scannable,
    lt.hide_in_starmap,
    lt.obstruction_radius,
    lt.arrival_radius,
    lt.arrival_point_offset,
    lt.adoption_radius,
    dn.display_name,
    lt.created_at,
    lt.updated_at
from location_tree lt
left join "sc_interdiction"."raw_silver"."display_names" dn on lt.name = dn.loc_name
left join lagrange_planet_ids lpi on lt.name = lpi.loc_name
  );
  
[0m02:39:56.400084 [debug] [Thread-4 (]: SQL status: SELECT 1915 in 2.0 seconds
[0m02:39:56.406414 [debug] [Thread-4 (]: Using postgres connection "model.sc_interdiction.silver_locations"
[0m02:39:56.407219 [debug] [Thread-4 (]: On model.sc_interdiction.silver_locations: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "node_id": "model.sc_interdiction.silver_locations"} */
alter table "sc_interdiction"."raw_silver"."silver_locations" rename to "silver_locations__dbt_backup"
[0m02:39:56.408420 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:39:56.417995 [debug] [Thread-4 (]: Using postgres connection "model.sc_interdiction.silver_locations"
[0m02:39:56.419415 [debug] [Thread-4 (]: On model.sc_interdiction.silver_locations: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "node_id": "model.sc_interdiction.silver_locations"} */
alter table "sc_interdiction"."raw_silver"."silver_locations__dbt_tmp" rename to "silver_locations"
[0m02:39:56.421266 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:39:56.459089 [debug] [Thread-4 (]: Using postgres connection "model.sc_interdiction.silver_locations"
[0m02:39:56.459725 [debug] [Thread-4 (]: On model.sc_interdiction.silver_locations: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "node_id": "model.sc_interdiction.silver_locations"} */

    create  index if not exists
  "dd93efa8dae32d67b309051e6fead78b"
  on "sc_interdiction"."raw_silver"."silver_locations" 
  (parent_id);
  
[0m02:39:56.472042 [debug] [Thread-4 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m02:39:56.475027 [debug] [Thread-4 (]: Using postgres connection "model.sc_interdiction.silver_locations"
[0m02:39:56.475689 [debug] [Thread-4 (]: On model.sc_interdiction.silver_locations: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "node_id": "model.sc_interdiction.silver_locations"} */

    create  index if not exists
  "2bb124dec278c1b86baa73717c1d5d1e"
  on "sc_interdiction"."raw_silver"."silver_locations" 
  (location_type);
  
[0m02:39:56.482409 [debug] [Thread-4 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m02:39:56.485675 [debug] [Thread-4 (]: Using postgres connection "model.sc_interdiction.silver_locations"
[0m02:39:56.486436 [debug] [Thread-4 (]: On model.sc_interdiction.silver_locations: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "node_id": "model.sc_interdiction.silver_locations"} */

    create  index if not exists
  "5061e3cdc42abdb6bbe1b07489ab98f8"
  on "sc_interdiction"."raw_silver"."silver_locations" 
  (affiliation);
  
[0m02:39:56.498861 [debug] [Thread-4 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m02:39:56.502081 [debug] [Thread-4 (]: Using postgres connection "model.sc_interdiction.silver_locations"
[0m02:39:56.502908 [debug] [Thread-4 (]: On model.sc_interdiction.silver_locations: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "node_id": "model.sc_interdiction.silver_locations"} */

    create  index if not exists
  "e2dfebbd4cb245d13b9e2b271f7b788d"
  on "sc_interdiction"."raw_silver"."silver_locations" 
  (display_name);
  
[0m02:39:56.510163 [debug] [Thread-4 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m02:39:56.516793 [debug] [Thread-4 (]: On model.sc_interdiction.silver_locations: COMMIT
[0m02:39:56.517552 [debug] [Thread-4 (]: Using postgres connection "model.sc_interdiction.silver_locations"
[0m02:39:56.518101 [debug] [Thread-4 (]: On model.sc_interdiction.silver_locations: COMMIT
[0m02:39:56.553750 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m02:39:56.558714 [debug] [Thread-4 (]: Applying DROP to: "sc_interdiction"."raw_silver"."silver_locations__dbt_backup"
[0m02:39:56.571172 [debug] [Thread-4 (]: Using postgres connection "model.sc_interdiction.silver_locations"
[0m02:39:56.571826 [debug] [Thread-4 (]: On model.sc_interdiction.silver_locations: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "node_id": "model.sc_interdiction.silver_locations"} */
drop table if exists "sc_interdiction"."raw_silver"."silver_locations__dbt_backup" cascade
[0m02:39:56.598638 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:39:56.601347 [debug] [Thread-4 (]: Timing info for model.sc_interdiction.silver_locations (execute): 02:39:54.707389 => 02:39:56.600995
[0m02:39:56.601994 [debug] [Thread-4 (]: On model.sc_interdiction.silver_locations: Close
[0m02:39:56.603076 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2345fa89-fcf3-4b27-a6b6-e0bb9e5312dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0db0185a50>]}
[0m02:39:56.603848 [info ] [Thread-4 (]: 6 of 13 OK created sql table model raw_silver.silver_locations ................. [[32mSELECT 1915[0m in 1.92s]
[0m02:39:56.609128 [debug] [Thread-4 (]: Finished running node model.sc_interdiction.silver_locations
[0m02:39:56.610986 [debug] [Thread-2 (]: Began running node model.sc_interdiction.gold_locations
[0m02:39:56.611588 [debug] [Thread-3 (]: Began running node model.sc_interdiction.silver_quantum_routes
[0m02:39:56.612254 [debug] [Thread-1 (]: Began running node model.sc_interdiction.silver_shops
[0m02:39:56.612888 [info ] [Thread-2 (]: 7 of 13 START sql view model raw_gold.gold_locations ........................... [RUN]
[0m02:39:56.613637 [info ] [Thread-3 (]: 8 of 13 START sql table model raw_silver.silver_quantum_routes ................. [RUN]
[0m02:39:56.614489 [info ] [Thread-1 (]: 9 of 13 START sql table model raw_silver.silver_shops .......................... [RUN]
[0m02:39:56.615531 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.sc_interdiction.stg_locations, now model.sc_interdiction.gold_locations)
[0m02:39:56.616363 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.sc_interdiction.stg_quantum_routes, now model.sc_interdiction.silver_quantum_routes)
[0m02:39:56.617193 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sc_interdiction.stg_shops, now model.sc_interdiction.silver_shops)
[0m02:39:56.617774 [debug] [Thread-2 (]: Began compiling node model.sc_interdiction.gold_locations
[0m02:39:56.618320 [debug] [Thread-3 (]: Began compiling node model.sc_interdiction.silver_quantum_routes
[0m02:39:56.618873 [debug] [Thread-1 (]: Began compiling node model.sc_interdiction.silver_shops
[0m02:39:56.624438 [debug] [Thread-2 (]: Writing injected SQL for node "model.sc_interdiction.gold_locations"
[0m02:39:56.631210 [debug] [Thread-3 (]: Writing injected SQL for node "model.sc_interdiction.silver_quantum_routes"
[0m02:39:56.637285 [debug] [Thread-1 (]: Writing injected SQL for node "model.sc_interdiction.silver_shops"
[0m02:39:56.639270 [debug] [Thread-2 (]: Timing info for model.sc_interdiction.gold_locations (compile): 02:39:56.619237 => 02:39:56.638877
[0m02:39:56.639894 [debug] [Thread-2 (]: Began executing node model.sc_interdiction.gold_locations
[0m02:39:56.652907 [debug] [Thread-2 (]: Writing runtime sql for node "model.sc_interdiction.gold_locations"
[0m02:39:56.654170 [debug] [Thread-1 (]: Timing info for model.sc_interdiction.silver_shops (compile): 02:39:56.631903 => 02:39:56.653790
[0m02:39:56.654977 [debug] [Thread-3 (]: Timing info for model.sc_interdiction.silver_quantum_routes (compile): 02:39:56.625103 => 02:39:56.654685
[0m02:39:56.655467 [debug] [Thread-1 (]: Began executing node model.sc_interdiction.silver_shops
[0m02:39:56.656065 [debug] [Thread-3 (]: Began executing node model.sc_interdiction.silver_quantum_routes
[0m02:39:56.669338 [debug] [Thread-2 (]: Using postgres connection "model.sc_interdiction.gold_locations"
[0m02:39:56.670008 [debug] [Thread-1 (]: Writing runtime sql for node "model.sc_interdiction.silver_shops"
[0m02:39:56.679200 [debug] [Thread-3 (]: Writing runtime sql for node "model.sc_interdiction.silver_quantum_routes"
[0m02:39:56.680113 [debug] [Thread-2 (]: On model.sc_interdiction.gold_locations: BEGIN
[0m02:39:56.681627 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:39:56.682987 [debug] [Thread-1 (]: Using postgres connection "model.sc_interdiction.silver_shops"
[0m02:39:56.683462 [debug] [Thread-1 (]: On model.sc_interdiction.silver_shops: BEGIN
[0m02:39:56.683890 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:39:56.684699 [debug] [Thread-3 (]: Using postgres connection "model.sc_interdiction.silver_quantum_routes"
[0m02:39:56.685238 [debug] [Thread-3 (]: On model.sc_interdiction.silver_quantum_routes: BEGIN
[0m02:39:56.685661 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m02:39:56.692279 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m02:39:56.692980 [debug] [Thread-1 (]: Using postgres connection "model.sc_interdiction.silver_shops"
[0m02:39:56.693630 [debug] [Thread-1 (]: On model.sc_interdiction.silver_shops: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "node_id": "model.sc_interdiction.silver_shops"} */

  
    

  create  table "sc_interdiction"."raw_silver"."silver_shops__dbt_tmp"
  
  
    as
  
  (
    -- Silver shops: validated with foreign key integrity



select
    s.shop_id,
    case
        when s.location_id in (select id from "sc_interdiction"."raw_silver"."silver_locations")
        then s.location_id
        else null
    end as location_id,
    s.shop_name,
    s.created_at,
    s.updated_at
from "sc_interdiction"."raw_staging"."stg_shops" s
  );
  
[0m02:39:56.694144 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m02:39:56.694796 [debug] [Thread-2 (]: Using postgres connection "model.sc_interdiction.gold_locations"
[0m02:39:56.695325 [debug] [Thread-2 (]: On model.sc_interdiction.gold_locations: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "node_id": "model.sc_interdiction.gold_locations"} */

  create view "sc_interdiction"."raw_gold"."gold_locations__dbt_tmp"
    
    
  as (
    -- Gold locations: denormalized view with parent names

select
    l.id,
    l.name,
    l.display_name,
    l.parent_id,
    p.name as parent_name,
    p.display_name as parent_display_name,
    l.location_type,
    l.nav_icon,
    l.affiliation,
    l.description,
    l.is_scannable,
    l.hide_in_starmap,
    l.obstruction_radius,
    l.arrival_radius,
    l.arrival_point_offset,
    l.adoption_radius
from "sc_interdiction"."raw_silver"."silver_locations" l
left join "sc_interdiction"."raw_silver"."silver_locations" p on l.parent_id = p.id
  );
[0m02:39:56.696695 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m02:39:56.697233 [debug] [Thread-3 (]: Using postgres connection "model.sc_interdiction.silver_quantum_routes"
[0m02:39:56.697748 [debug] [Thread-3 (]: On model.sc_interdiction.silver_quantum_routes: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "node_id": "model.sc_interdiction.silver_quantum_routes"} */

  
    

  create  table "sc_interdiction"."raw_silver"."silver_quantum_routes__dbt_tmp"
  
  
    as
  
  (
    -- Silver quantum routes: validated with foreign keys to locations



select
    r.id,
    r.from_location,
    r.to_location,
    r.distance,
    r.created_at,
    r.updated_at
from "sc_interdiction"."raw_staging"."stg_quantum_routes" r
where r.from_location in (select id from "sc_interdiction"."raw_silver"."silver_locations")
  and r.to_location in (select id from "sc_interdiction"."raw_silver"."silver_locations")
  );
  
[0m02:39:56.712735 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m02:39:56.718282 [debug] [Thread-2 (]: Using postgres connection "model.sc_interdiction.gold_locations"
[0m02:39:56.719121 [debug] [Thread-2 (]: On model.sc_interdiction.gold_locations: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "node_id": "model.sc_interdiction.gold_locations"} */
alter table "sc_interdiction"."raw_gold"."gold_locations__dbt_tmp" rename to "gold_locations"
[0m02:39:56.720593 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:39:56.728584 [debug] [Thread-2 (]: On model.sc_interdiction.gold_locations: COMMIT
[0m02:39:56.730250 [debug] [Thread-2 (]: Using postgres connection "model.sc_interdiction.gold_locations"
[0m02:39:56.730916 [debug] [Thread-2 (]: On model.sc_interdiction.gold_locations: COMMIT
[0m02:39:56.755788 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m02:39:56.760379 [debug] [Thread-2 (]: Applying DROP to: "sc_interdiction"."raw_gold"."gold_locations__dbt_backup"
[0m02:39:56.761121 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.0 seconds
[0m02:39:56.762574 [debug] [Thread-2 (]: Using postgres connection "model.sc_interdiction.gold_locations"
[0m02:39:56.763236 [debug] [Thread-1 (]: SQL status: SELECT 108 in 0.0 seconds
[0m02:39:56.768619 [debug] [Thread-3 (]: Using postgres connection "model.sc_interdiction.silver_quantum_routes"
[0m02:39:56.769454 [debug] [Thread-2 (]: On model.sc_interdiction.gold_locations: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "node_id": "model.sc_interdiction.gold_locations"} */
drop view if exists "sc_interdiction"."raw_gold"."gold_locations__dbt_backup" cascade
[0m02:39:56.774517 [debug] [Thread-1 (]: Using postgres connection "model.sc_interdiction.silver_shops"
[0m02:39:56.776143 [debug] [Thread-3 (]: On model.sc_interdiction.silver_quantum_routes: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "node_id": "model.sc_interdiction.silver_quantum_routes"} */
alter table "sc_interdiction"."raw_silver"."silver_quantum_routes" rename to "silver_quantum_routes__dbt_backup"
[0m02:39:56.776960 [debug] [Thread-1 (]: On model.sc_interdiction.silver_shops: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "node_id": "model.sc_interdiction.silver_shops"} */
alter table "sc_interdiction"."raw_silver"."silver_shops" rename to "silver_shops__dbt_backup"
[0m02:39:56.777563 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m02:39:56.780234 [debug] [Thread-2 (]: Timing info for model.sc_interdiction.gold_locations (execute): 02:39:56.640465 => 02:39:56.779922
[0m02:39:56.780972 [debug] [Thread-2 (]: On model.sc_interdiction.gold_locations: Close
[0m02:39:56.781561 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:39:56.782057 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:39:56.788282 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2345fa89-fcf3-4b27-a6b6-e0bb9e5312dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0db2a83b50>]}
[0m02:39:56.787284 [debug] [Thread-1 (]: Using postgres connection "model.sc_interdiction.silver_shops"
[0m02:39:56.794579 [debug] [Thread-3 (]: Using postgres connection "model.sc_interdiction.silver_quantum_routes"
[0m02:39:56.795756 [info ] [Thread-2 (]: 7 of 13 OK created sql view model raw_gold.gold_locations ...................... [[32mCREATE VIEW[0m in 0.17s]
[0m02:39:56.796496 [debug] [Thread-1 (]: On model.sc_interdiction.silver_shops: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "node_id": "model.sc_interdiction.silver_shops"} */
alter table "sc_interdiction"."raw_silver"."silver_shops__dbt_tmp" rename to "silver_shops"
[0m02:39:56.797066 [debug] [Thread-3 (]: On model.sc_interdiction.silver_quantum_routes: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "node_id": "model.sc_interdiction.silver_quantum_routes"} */
alter table "sc_interdiction"."raw_silver"."silver_quantum_routes__dbt_tmp" rename to "silver_quantum_routes"
[0m02:39:56.797850 [debug] [Thread-2 (]: Finished running node model.sc_interdiction.gold_locations
[0m02:39:56.799203 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:39:56.799703 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:39:56.806560 [debug] [Thread-3 (]: Using postgres connection "model.sc_interdiction.silver_quantum_routes"
[0m02:39:56.809847 [debug] [Thread-1 (]: Using postgres connection "model.sc_interdiction.silver_shops"
[0m02:39:56.810601 [debug] [Thread-3 (]: On model.sc_interdiction.silver_quantum_routes: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "node_id": "model.sc_interdiction.silver_quantum_routes"} */

    create  index if not exists
  "85c1db38650d0e25763fcbefb70f57b3"
  on "sc_interdiction"."raw_silver"."silver_quantum_routes" 
  (from_location);
  
[0m02:39:56.811527 [debug] [Thread-1 (]: On model.sc_interdiction.silver_shops: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "node_id": "model.sc_interdiction.silver_shops"} */

    create  index if not exists
  "1de7bfaee4dfd9f15a6c1ab262ed63d5"
  on "sc_interdiction"."raw_silver"."silver_shops" 
  (location_id);
  
[0m02:39:56.816986 [debug] [Thread-3 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m02:39:56.817671 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m02:39:56.820421 [debug] [Thread-3 (]: Using postgres connection "model.sc_interdiction.silver_quantum_routes"
[0m02:39:56.823551 [debug] [Thread-1 (]: On model.sc_interdiction.silver_shops: COMMIT
[0m02:39:56.824321 [debug] [Thread-3 (]: On model.sc_interdiction.silver_quantum_routes: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "node_id": "model.sc_interdiction.silver_quantum_routes"} */

    create  index if not exists
  "c4887fa6b9866814b2f4bb3c6778c881"
  on "sc_interdiction"."raw_silver"."silver_quantum_routes" 
  (to_location);
  
[0m02:39:56.824911 [debug] [Thread-1 (]: Using postgres connection "model.sc_interdiction.silver_shops"
[0m02:39:56.825642 [debug] [Thread-1 (]: On model.sc_interdiction.silver_shops: COMMIT
[0m02:39:56.828111 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:39:56.834929 [debug] [Thread-3 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m02:39:56.835936 [debug] [Thread-1 (]: Applying DROP to: "sc_interdiction"."raw_silver"."silver_shops__dbt_backup"
[0m02:39:56.839160 [debug] [Thread-3 (]: On model.sc_interdiction.silver_quantum_routes: COMMIT
[0m02:39:56.845800 [debug] [Thread-1 (]: Using postgres connection "model.sc_interdiction.silver_shops"
[0m02:39:56.846566 [debug] [Thread-3 (]: Using postgres connection "model.sc_interdiction.silver_quantum_routes"
[0m02:39:56.847128 [debug] [Thread-1 (]: On model.sc_interdiction.silver_shops: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "node_id": "model.sc_interdiction.silver_shops"} */
drop table if exists "sc_interdiction"."raw_silver"."silver_shops__dbt_backup" cascade
[0m02:39:56.847610 [debug] [Thread-3 (]: On model.sc_interdiction.silver_quantum_routes: COMMIT
[0m02:39:56.849997 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m02:39:56.854940 [debug] [Thread-3 (]: Applying DROP to: "sc_interdiction"."raw_silver"."silver_quantum_routes__dbt_backup"
[0m02:39:56.855797 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:39:56.857418 [debug] [Thread-3 (]: Using postgres connection "model.sc_interdiction.silver_quantum_routes"
[0m02:39:56.859707 [debug] [Thread-1 (]: Timing info for model.sc_interdiction.silver_shops (execute): 02:39:56.656527 => 02:39:56.859370
[0m02:39:56.860340 [debug] [Thread-3 (]: On model.sc_interdiction.silver_quantum_routes: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "node_id": "model.sc_interdiction.silver_quantum_routes"} */
drop table if exists "sc_interdiction"."raw_silver"."silver_quantum_routes__dbt_backup" cascade
[0m02:39:56.861729 [debug] [Thread-1 (]: On model.sc_interdiction.silver_shops: Close
[0m02:39:56.863416 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2345fa89-fcf3-4b27-a6b6-e0bb9e5312dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0db01eff70>]}
[0m02:39:56.864294 [info ] [Thread-1 (]: 9 of 13 OK created sql table model raw_silver.silver_shops ..................... [[32mSELECT 108[0m in 0.25s]
[0m02:39:56.865122 [debug] [Thread-1 (]: Finished running node model.sc_interdiction.silver_shops
[0m02:39:56.866215 [debug] [Thread-4 (]: Began running node model.sc_interdiction.gold_shops
[0m02:39:56.866720 [debug] [Thread-2 (]: Began running node model.sc_interdiction.silver_shop_items
[0m02:39:56.867410 [info ] [Thread-4 (]: 10 of 13 START sql view model raw_gold.gold_shops .............................. [RUN]
[0m02:39:56.868198 [info ] [Thread-2 (]: 11 of 13 START sql table model raw_silver.silver_shop_items .................... [RUN]
[0m02:39:56.869253 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.sc_interdiction.silver_locations, now model.sc_interdiction.gold_shops)
[0m02:39:56.869822 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:39:56.870839 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.sc_interdiction.gold_locations, now model.sc_interdiction.silver_shop_items)
[0m02:39:56.871493 [debug] [Thread-4 (]: Began compiling node model.sc_interdiction.gold_shops
[0m02:39:56.873632 [debug] [Thread-3 (]: Timing info for model.sc_interdiction.silver_quantum_routes (execute): 02:39:56.670453 => 02:39:56.873362
[0m02:39:56.874206 [debug] [Thread-2 (]: Began compiling node model.sc_interdiction.silver_shop_items
[0m02:39:56.879173 [debug] [Thread-4 (]: Writing injected SQL for node "model.sc_interdiction.gold_shops"
[0m02:39:56.880033 [debug] [Thread-3 (]: On model.sc_interdiction.silver_quantum_routes: Close
[0m02:39:56.887250 [debug] [Thread-2 (]: Writing injected SQL for node "model.sc_interdiction.silver_shop_items"
[0m02:39:56.889157 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2345fa89-fcf3-4b27-a6b6-e0bb9e5312dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0db0238190>]}
[0m02:39:56.890540 [info ] [Thread-3 (]: 8 of 13 OK created sql table model raw_silver.silver_quantum_routes ............ [[32mSELECT 0[0m in 0.27s]
[0m02:39:56.891608 [debug] [Thread-4 (]: Timing info for model.sc_interdiction.gold_shops (compile): 02:39:56.874512 => 02:39:56.891262
[0m02:39:56.892406 [debug] [Thread-3 (]: Finished running node model.sc_interdiction.silver_quantum_routes
[0m02:39:56.892992 [debug] [Thread-4 (]: Began executing node model.sc_interdiction.gold_shops
[0m02:39:56.894069 [debug] [Thread-2 (]: Timing info for model.sc_interdiction.silver_shop_items (compile): 02:39:56.880480 => 02:39:56.893827
[0m02:39:56.900233 [debug] [Thread-1 (]: Began running node model.sc_interdiction.gold_quantum_routes
[0m02:39:56.901753 [debug] [Thread-4 (]: Writing runtime sql for node "model.sc_interdiction.gold_shops"
[0m02:39:56.902686 [debug] [Thread-2 (]: Began executing node model.sc_interdiction.silver_shop_items
[0m02:39:56.903518 [info ] [Thread-1 (]: 12 of 13 START sql view model raw_gold.gold_quantum_routes ..................... [RUN]
[0m02:39:56.911082 [debug] [Thread-2 (]: Writing runtime sql for node "model.sc_interdiction.silver_shop_items"
[0m02:39:56.912277 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sc_interdiction.silver_shops, now model.sc_interdiction.gold_quantum_routes)
[0m02:39:56.912976 [debug] [Thread-4 (]: Using postgres connection "model.sc_interdiction.gold_shops"
[0m02:39:56.913734 [debug] [Thread-1 (]: Began compiling node model.sc_interdiction.gold_quantum_routes
[0m02:39:56.914328 [debug] [Thread-4 (]: On model.sc_interdiction.gold_shops: BEGIN
[0m02:39:56.914880 [debug] [Thread-2 (]: Using postgres connection "model.sc_interdiction.silver_shop_items"
[0m02:39:56.920396 [debug] [Thread-1 (]: Writing injected SQL for node "model.sc_interdiction.gold_quantum_routes"
[0m02:39:56.921220 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m02:39:56.921803 [debug] [Thread-2 (]: On model.sc_interdiction.silver_shop_items: BEGIN
[0m02:39:56.922729 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m02:39:56.923718 [debug] [Thread-1 (]: Timing info for model.sc_interdiction.gold_quantum_routes (compile): 02:39:56.915137 => 02:39:56.923385
[0m02:39:56.924234 [debug] [Thread-1 (]: Began executing node model.sc_interdiction.gold_quantum_routes
[0m02:39:56.932885 [debug] [Thread-1 (]: Writing runtime sql for node "model.sc_interdiction.gold_quantum_routes"
[0m02:39:56.934445 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m02:39:56.935129 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m02:39:56.935703 [debug] [Thread-1 (]: Using postgres connection "model.sc_interdiction.gold_quantum_routes"
[0m02:39:56.936282 [debug] [Thread-2 (]: Using postgres connection "model.sc_interdiction.silver_shop_items"
[0m02:39:56.936807 [debug] [Thread-4 (]: Using postgres connection "model.sc_interdiction.gold_shops"
[0m02:39:56.937388 [debug] [Thread-1 (]: On model.sc_interdiction.gold_quantum_routes: BEGIN
[0m02:39:56.937953 [debug] [Thread-2 (]: On model.sc_interdiction.silver_shop_items: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "node_id": "model.sc_interdiction.silver_shop_items"} */

  
    

  create  table "sc_interdiction"."raw_silver"."silver_shop_items__dbt_tmp"
  
  
    as
  
  (
    -- Silver shop items: validated with foreign key to shops



select
    si.id,
    si.shop_id,
    si.item_id,
    si.buy_price,
    si.sell_price,
    si.max_inventory,
    si.created_at,
    si.updated_at
from "sc_interdiction"."raw_staging"."stg_shop_items" si
where si.shop_id in (select shop_id from "sc_interdiction"."raw_silver"."silver_shops")
  );
  
[0m02:39:56.938569 [debug] [Thread-4 (]: On model.sc_interdiction.gold_shops: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "node_id": "model.sc_interdiction.gold_shops"} */

  create view "sc_interdiction"."raw_gold"."gold_shops__dbt_tmp"
    
    
  as (
    -- Gold shops: denormalized view with location info

select
    s.shop_id,
    s.location_id,
    l.name as location_name,
    l.display_name as location_display_name,
    l.location_type,
    s.shop_name
from "sc_interdiction"."raw_silver"."silver_shops" s
left join "sc_interdiction"."raw_silver"."silver_locations" l on s.location_id = l.id
  );
[0m02:39:56.939147 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:39:56.942871 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m02:39:56.947291 [debug] [Thread-4 (]: Using postgres connection "model.sc_interdiction.gold_shops"
[0m02:39:56.948038 [debug] [Thread-4 (]: On model.sc_interdiction.gold_shops: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "node_id": "model.sc_interdiction.gold_shops"} */
alter table "sc_interdiction"."raw_gold"."gold_shops__dbt_tmp" rename to "gold_shops"
[0m02:39:56.948492 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m02:39:56.949051 [debug] [Thread-1 (]: Using postgres connection "model.sc_interdiction.gold_quantum_routes"
[0m02:39:56.949497 [debug] [Thread-1 (]: On model.sc_interdiction.gold_quantum_routes: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "node_id": "model.sc_interdiction.gold_quantum_routes"} */

  create view "sc_interdiction"."raw_gold"."gold_quantum_routes__dbt_tmp"
    
    
  as (
    -- Gold quantum routes: denormalized view with location names

select
    r.id,
    r.from_location,
    f.name as from_name,
    f.display_name as from_display_name,
    f.location_type as from_type,
    r.to_location,
    t.name as to_name,
    t.display_name as to_display_name,
    t.location_type as to_type,
    r.distance
from "sc_interdiction"."raw_silver"."silver_quantum_routes" r
left join "sc_interdiction"."raw_silver"."silver_locations" f on r.from_location = f.id
left join "sc_interdiction"."raw_silver"."silver_locations" t on r.to_location = t.id
  );
[0m02:39:56.950466 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:39:56.953798 [debug] [Thread-4 (]: On model.sc_interdiction.gold_shops: COMMIT
[0m02:39:56.955881 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m02:39:56.956737 [debug] [Thread-4 (]: Using postgres connection "model.sc_interdiction.gold_shops"
[0m02:39:56.961537 [debug] [Thread-1 (]: Using postgres connection "model.sc_interdiction.gold_quantum_routes"
[0m02:39:56.962309 [debug] [Thread-4 (]: On model.sc_interdiction.gold_shops: COMMIT
[0m02:39:56.962877 [debug] [Thread-1 (]: On model.sc_interdiction.gold_quantum_routes: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "node_id": "model.sc_interdiction.gold_quantum_routes"} */
alter table "sc_interdiction"."raw_gold"."gold_quantum_routes__dbt_tmp" rename to "gold_quantum_routes"
[0m02:39:56.964342 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:39:56.967107 [debug] [Thread-1 (]: On model.sc_interdiction.gold_quantum_routes: COMMIT
[0m02:39:56.967866 [debug] [Thread-1 (]: Using postgres connection "model.sc_interdiction.gold_quantum_routes"
[0m02:39:56.968392 [debug] [Thread-1 (]: On model.sc_interdiction.gold_quantum_routes: COMMIT
[0m02:39:56.971739 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m02:39:56.976905 [debug] [Thread-4 (]: Applying DROP to: "sc_interdiction"."raw_gold"."gold_shops__dbt_backup"
[0m02:39:56.977704 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:39:56.979311 [debug] [Thread-4 (]: Using postgres connection "model.sc_interdiction.gold_shops"
[0m02:39:56.984020 [debug] [Thread-1 (]: Applying DROP to: "sc_interdiction"."raw_gold"."gold_quantum_routes__dbt_backup"
[0m02:39:56.985035 [debug] [Thread-4 (]: On model.sc_interdiction.gold_shops: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "node_id": "model.sc_interdiction.gold_shops"} */
drop view if exists "sc_interdiction"."raw_gold"."gold_shops__dbt_backup" cascade
[0m02:39:56.986394 [debug] [Thread-1 (]: Using postgres connection "model.sc_interdiction.gold_quantum_routes"
[0m02:39:56.987080 [debug] [Thread-1 (]: On model.sc_interdiction.gold_quantum_routes: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "node_id": "model.sc_interdiction.gold_quantum_routes"} */
drop view if exists "sc_interdiction"."raw_gold"."gold_quantum_routes__dbt_backup" cascade
[0m02:39:56.987532 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.0 seconds
[0m02:39:56.992423 [debug] [Thread-4 (]: Timing info for model.sc_interdiction.gold_shops (execute): 02:39:56.894572 => 02:39:56.990653
[0m02:39:56.993234 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m02:39:56.993828 [debug] [Thread-4 (]: On model.sc_interdiction.gold_shops: Close
[0m02:39:56.996277 [debug] [Thread-1 (]: Timing info for model.sc_interdiction.gold_quantum_routes (execute): 02:39:56.924518 => 02:39:56.995975
[0m02:39:56.997374 [debug] [Thread-1 (]: On model.sc_interdiction.gold_quantum_routes: Close
[0m02:39:56.998577 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2345fa89-fcf3-4b27-a6b6-e0bb9e5312dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0db2a913c0>]}
[0m02:39:57.000472 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2345fa89-fcf3-4b27-a6b6-e0bb9e5312dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0db2aae8f0>]}
[0m02:39:56.999531 [info ] [Thread-4 (]: 10 of 13 OK created sql view model raw_gold.gold_shops ......................... [[32mCREATE VIEW[0m in 0.13s]
[0m02:39:57.001595 [info ] [Thread-1 (]: 12 of 13 OK created sql view model raw_gold.gold_quantum_routes ................ [[32mCREATE VIEW[0m in 0.09s]
[0m02:39:57.002574 [debug] [Thread-4 (]: Finished running node model.sc_interdiction.gold_shops
[0m02:39:57.003350 [debug] [Thread-1 (]: Finished running node model.sc_interdiction.gold_quantum_routes
[0m02:39:57.031554 [debug] [Thread-2 (]: SQL status: SELECT 12148 in 0.0 seconds
[0m02:39:57.037689 [debug] [Thread-2 (]: Using postgres connection "model.sc_interdiction.silver_shop_items"
[0m02:39:57.038359 [debug] [Thread-2 (]: On model.sc_interdiction.silver_shop_items: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "node_id": "model.sc_interdiction.silver_shop_items"} */
alter table "sc_interdiction"."raw_silver"."silver_shop_items" rename to "silver_shop_items__dbt_backup"
[0m02:39:57.039510 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:39:57.051370 [debug] [Thread-2 (]: Using postgres connection "model.sc_interdiction.silver_shop_items"
[0m02:39:57.052098 [debug] [Thread-2 (]: On model.sc_interdiction.silver_shop_items: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "node_id": "model.sc_interdiction.silver_shop_items"} */
alter table "sc_interdiction"."raw_silver"."silver_shop_items__dbt_tmp" rename to "silver_shop_items"
[0m02:39:57.053303 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:39:57.055940 [debug] [Thread-2 (]: Using postgres connection "model.sc_interdiction.silver_shop_items"
[0m02:39:57.056450 [debug] [Thread-2 (]: On model.sc_interdiction.silver_shop_items: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "node_id": "model.sc_interdiction.silver_shop_items"} */

    create  index if not exists
  "0d75ead4d536c96c60308060da7e20c6"
  on "sc_interdiction"."raw_silver"."silver_shop_items" 
  (shop_id);
  
[0m02:39:57.103971 [debug] [Thread-2 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m02:39:57.107302 [debug] [Thread-2 (]: Using postgres connection "model.sc_interdiction.silver_shop_items"
[0m02:39:57.108037 [debug] [Thread-2 (]: On model.sc_interdiction.silver_shop_items: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "node_id": "model.sc_interdiction.silver_shop_items"} */

    create  index if not exists
  "355f7ec545f4061f6e5249a0c05084df"
  on "sc_interdiction"."raw_silver"."silver_shop_items" 
  (item_id);
  
[0m02:39:57.153893 [debug] [Thread-2 (]: SQL status: CREATE INDEX in 0.0 seconds
[0m02:39:57.157348 [debug] [Thread-2 (]: On model.sc_interdiction.silver_shop_items: COMMIT
[0m02:39:57.158034 [debug] [Thread-2 (]: Using postgres connection "model.sc_interdiction.silver_shop_items"
[0m02:39:57.158515 [debug] [Thread-2 (]: On model.sc_interdiction.silver_shop_items: COMMIT
[0m02:39:57.190773 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m02:39:57.195576 [debug] [Thread-2 (]: Applying DROP to: "sc_interdiction"."raw_silver"."silver_shop_items__dbt_backup"
[0m02:39:57.199230 [debug] [Thread-2 (]: Using postgres connection "model.sc_interdiction.silver_shop_items"
[0m02:39:57.199967 [debug] [Thread-2 (]: On model.sc_interdiction.silver_shop_items: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "node_id": "model.sc_interdiction.silver_shop_items"} */
drop table if exists "sc_interdiction"."raw_silver"."silver_shop_items__dbt_backup" cascade
[0m02:39:57.211416 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m02:39:57.213999 [debug] [Thread-2 (]: Timing info for model.sc_interdiction.silver_shop_items (execute): 02:39:56.904270 => 02:39:57.213618
[0m02:39:57.214512 [debug] [Thread-2 (]: On model.sc_interdiction.silver_shop_items: Close
[0m02:39:57.215663 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2345fa89-fcf3-4b27-a6b6-e0bb9e5312dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0db2c5a3e0>]}
[0m02:39:57.216555 [info ] [Thread-2 (]: 11 of 13 OK created sql table model raw_silver.silver_shop_items ............... [[32mSELECT 12148[0m in 0.35s]
[0m02:39:57.217392 [debug] [Thread-2 (]: Finished running node model.sc_interdiction.silver_shop_items
[0m02:39:57.218639 [debug] [Thread-3 (]: Began running node model.sc_interdiction.gold_shop_items
[0m02:39:57.219529 [info ] [Thread-3 (]: 13 of 13 START sql view model raw_gold.gold_shop_items ......................... [RUN]
[0m02:39:57.220537 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.sc_interdiction.silver_quantum_routes, now model.sc_interdiction.gold_shop_items)
[0m02:39:57.221113 [debug] [Thread-3 (]: Began compiling node model.sc_interdiction.gold_shop_items
[0m02:39:57.229413 [debug] [Thread-3 (]: Writing injected SQL for node "model.sc_interdiction.gold_shop_items"
[0m02:39:57.234928 [debug] [Thread-3 (]: Timing info for model.sc_interdiction.gold_shop_items (compile): 02:39:57.221387 => 02:39:57.232315
[0m02:39:57.235706 [debug] [Thread-3 (]: Began executing node model.sc_interdiction.gold_shop_items
[0m02:39:57.242865 [debug] [Thread-3 (]: Writing runtime sql for node "model.sc_interdiction.gold_shop_items"
[0m02:39:57.244072 [debug] [Thread-3 (]: Using postgres connection "model.sc_interdiction.gold_shop_items"
[0m02:39:57.244568 [debug] [Thread-3 (]: On model.sc_interdiction.gold_shop_items: BEGIN
[0m02:39:57.244978 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m02:39:57.254634 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m02:39:57.255362 [debug] [Thread-3 (]: Using postgres connection "model.sc_interdiction.gold_shop_items"
[0m02:39:57.255898 [debug] [Thread-3 (]: On model.sc_interdiction.gold_shop_items: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "node_id": "model.sc_interdiction.gold_shop_items"} */

  create view "sc_interdiction"."raw_gold"."gold_shop_items__dbt_tmp"
    
    
  as (
    -- Gold shop items: denormalized view with shop and location info

select
    si.id,
    si.shop_id,
    s.shop_name,
    s.location_id,
    l.name as location_name,
    l.display_name as location_display_name,
    si.item_id,
    si.buy_price,
    si.sell_price,
    si.max_inventory,
    case
        when si.buy_price > 0 and si.sell_price > 0
        then round(((si.sell_price - si.buy_price) / si.buy_price * 100)::numeric, 2)
        else 0
    end as profit_margin_pct
from "sc_interdiction"."raw_silver"."silver_shop_items" si
join "sc_interdiction"."raw_silver"."silver_shops" s on si.shop_id = s.shop_id
left join "sc_interdiction"."raw_silver"."silver_locations" l on s.location_id = l.id
  );
[0m02:39:57.263613 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m02:39:57.268550 [debug] [Thread-3 (]: Using postgres connection "model.sc_interdiction.gold_shop_items"
[0m02:39:57.269224 [debug] [Thread-3 (]: On model.sc_interdiction.gold_shop_items: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "node_id": "model.sc_interdiction.gold_shop_items"} */
alter table "sc_interdiction"."raw_gold"."gold_shop_items__dbt_tmp" rename to "gold_shop_items"
[0m02:39:57.270783 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:39:57.280406 [debug] [Thread-3 (]: On model.sc_interdiction.gold_shop_items: COMMIT
[0m02:39:57.281116 [debug] [Thread-3 (]: Using postgres connection "model.sc_interdiction.gold_shop_items"
[0m02:39:57.281585 [debug] [Thread-3 (]: On model.sc_interdiction.gold_shop_items: COMMIT
[0m02:39:57.283958 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m02:39:57.287786 [debug] [Thread-3 (]: Applying DROP to: "sc_interdiction"."raw_gold"."gold_shop_items__dbt_backup"
[0m02:39:57.289188 [debug] [Thread-3 (]: Using postgres connection "model.sc_interdiction.gold_shop_items"
[0m02:39:57.289713 [debug] [Thread-3 (]: On model.sc_interdiction.gold_shop_items: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "sc_interdiction", "target_name": "dev", "node_id": "model.sc_interdiction.gold_shop_items"} */
drop view if exists "sc_interdiction"."raw_gold"."gold_shop_items__dbt_backup" cascade
[0m02:39:57.290664 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m02:39:57.295514 [debug] [Thread-3 (]: Timing info for model.sc_interdiction.gold_shop_items (execute): 02:39:57.236041 => 02:39:57.295195
[0m02:39:57.296133 [debug] [Thread-3 (]: On model.sc_interdiction.gold_shop_items: Close
[0m02:39:57.297459 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2345fa89-fcf3-4b27-a6b6-e0bb9e5312dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0db2b53f40>]}
[0m02:39:57.298225 [info ] [Thread-3 (]: 13 of 13 OK created sql view model raw_gold.gold_shop_items .................... [[32mCREATE VIEW[0m in 0.08s]
[0m02:39:57.298957 [debug] [Thread-3 (]: Finished running node model.sc_interdiction.gold_shop_items
[0m02:39:57.301566 [debug] [MainThread]: Using postgres connection "master"
[0m02:39:57.302102 [debug] [MainThread]: On master: BEGIN
[0m02:39:57.302504 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:39:57.309775 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:39:57.310489 [debug] [MainThread]: On master: COMMIT
[0m02:39:57.310949 [debug] [MainThread]: Using postgres connection "master"
[0m02:39:57.311337 [debug] [MainThread]: On master: COMMIT
[0m02:39:57.311977 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:39:57.312338 [debug] [MainThread]: On master: Close
[0m02:39:57.313172 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:39:57.313503 [debug] [MainThread]: Connection 'model.sc_interdiction.gold_quantum_routes' was properly closed.
[0m02:39:57.313788 [debug] [MainThread]: Connection 'model.sc_interdiction.gold_shop_items' was properly closed.
[0m02:39:57.314093 [debug] [MainThread]: Connection 'model.sc_interdiction.silver_shop_items' was properly closed.
[0m02:39:57.314369 [debug] [MainThread]: Connection 'model.sc_interdiction.gold_shops' was properly closed.
[0m02:39:57.314783 [info ] [MainThread]: 
[0m02:39:57.315132 [info ] [MainThread]: Finished running 9 view models, 4 table models in 0 hours 0 minutes and 3.51 seconds (3.51s).
[0m02:39:57.318830 [debug] [MainThread]: Command end result
[0m02:39:57.345746 [info ] [MainThread]: 
[0m02:39:57.346377 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:39:57.346912 [info ] [MainThread]: 
[0m02:39:57.347382 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=0 SKIP=0 TOTAL=13
[0m02:39:57.348633 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.2250676, "process_user_time": 6.025982, "process_kernel_time": 0.68726, "process_mem_max_rss": "114748", "process_out_blocks": "2992", "process_in_blocks": "0"}
[0m02:39:57.349344 [debug] [MainThread]: Command `dbt run` succeeded at 02:39:57.349184 after 4.23 seconds
[0m02:39:57.349802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0db6af6e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0db2c5a3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0db2c482e0>]}
[0m02:39:57.350369 [debug] [MainThread]: Flushing usage events
